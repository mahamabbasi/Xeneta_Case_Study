[0m11:19:12.565417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c3b20>]}


============================== 11:19:12.574992 | a8064664-e21a-4305-a588-a81547f46cb5 ==============================
[0m11:19:12.574992 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:19:12.576751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select my_first_dbt_model.sql', 'send_anonymous_usage_stats': 'True'}
[0m11:19:13.018743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c3a00>]}
[0m11:19:13.204353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d8ca0>]}
[0m11:19:13.207565 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:19:13.253998 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:19:13.256870 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:19:13.258468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d8e20>]}
[0m11:19:15.645608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.xeneta.staging
- models.xeneta.final
[0m11:19:15.654934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c79120>]}
[0m11:19:15.683007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7a410>]}
[0m11:19:15.684109 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:19:15.685284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086971c0>]}
[0m11:19:15.689033 [info ] [MainThread]: 
[0m11:19:15.704880 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:19:15.707960 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:19:15.770685 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:19:15.771668 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:19:15.772434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:15.804826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:15.808224 [debug] [ThreadPool]: On list_dev: Close
[0m11:19:15.812261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:19:15.813850 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:19:15.825896 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:15.826645 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:19:15.827261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:15.837905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:15.840088 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:15.840718 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:19:15.841539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:15.842124 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:15.842754 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:19:15.855138 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:15.856970 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:19:15.857909 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:15.858812 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:19:15.859872 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:15.860730 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:19:15.866718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m11:19:15.934180 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:19:15.935505 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:19:15.944551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:15.984414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:15.985966 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:19:15.987021 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:19:16.369413 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:16.373236 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:19:16.380907 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:19:16.382239 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:19:16.393028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ceece0>]}
[0m11:19:16.398198 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:16.399517 [debug] [MainThread]: On master: BEGIN
[0m11:19:16.401526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:16.425426 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:16.426647 [debug] [MainThread]: On master: COMMIT
[0m11:19:16.431050 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:16.432581 [debug] [MainThread]: On master: COMMIT
[0m11:19:16.435440 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:16.437353 [debug] [MainThread]: On master: Close
[0m11:19:16.442962 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:16.447479 [info ] [MainThread]: 
[0m11:19:16.457361 [debug] [Thread-1 (]: Began running node model.xeneta.my_first_dbt_model
[0m11:19:16.459119 [info ] [Thread-1 (]: 1 of 1 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:19:16.474959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.xeneta.my_first_dbt_model)
[0m11:19:16.476418 [debug] [Thread-1 (]: Began compiling node model.xeneta.my_first_dbt_model
[0m11:19:16.525125 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.my_first_dbt_model"
[0m11:19:16.532259 [debug] [Thread-1 (]: Timing info for model.xeneta.my_first_dbt_model (compile): 11:19:16.485860 => 11:19:16.529781
[0m11:19:16.534475 [debug] [Thread-1 (]: Began executing node model.xeneta.my_first_dbt_model
[0m11:19:16.708825 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.my_first_dbt_model"
[0m11:19:16.715131 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.my_first_dbt_model"
[0m11:19:16.716734 [debug] [Thread-1 (]: On model.xeneta.my_first_dbt_model: BEGIN
[0m11:19:16.718496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:16.738465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:16.739850 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.my_first_dbt_model"
[0m11:19:16.742936 [debug] [Thread-1 (]: On model.xeneta.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:19:16.769223 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:16.817183 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.my_first_dbt_model"
[0m11:19:16.819957 [debug] [Thread-1 (]: On model.xeneta.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:19:16.824654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:16.951101 [debug] [Thread-1 (]: On model.xeneta.my_first_dbt_model: COMMIT
[0m11:19:16.952598 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.my_first_dbt_model"
[0m11:19:16.953994 [debug] [Thread-1 (]: On model.xeneta.my_first_dbt_model: COMMIT
[0m11:19:16.959710 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:16.976185 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.my_first_dbt_model"
[0m11:19:16.978277 [debug] [Thread-1 (]: On model.xeneta.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:19:16.980706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:16.985370 [debug] [Thread-1 (]: Timing info for model.xeneta.my_first_dbt_model (execute): 11:19:16.535633 => 11:19:16.984737
[0m11:19:16.986559 [debug] [Thread-1 (]: On model.xeneta.my_first_dbt_model: Close
[0m11:19:16.995583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8064664-e21a-4305-a588-a81547f46cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c7bca0>]}
[0m11:19:16.997332 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.53s]
[0m11:19:16.999179 [debug] [Thread-1 (]: Finished running node model.xeneta.my_first_dbt_model
[0m11:19:17.002382 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:17.017487 [debug] [MainThread]: On master: BEGIN
[0m11:19:17.022546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:17.054250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:17.057185 [debug] [MainThread]: On master: COMMIT
[0m11:19:17.058611 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:17.060090 [debug] [MainThread]: On master: COMMIT
[0m11:19:17.066457 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:17.067978 [debug] [MainThread]: On master: Close
[0m11:19:17.076507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:17.077537 [debug] [MainThread]: Connection 'model.xeneta.my_first_dbt_model' was properly closed.
[0m11:19:17.079690 [info ] [MainThread]: 
[0m11:19:17.080938 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m11:19:17.083127 [debug] [MainThread]: Command end result
[0m11:19:17.132065 [info ] [MainThread]: 
[0m11:19:17.133825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:17.135120 [info ] [MainThread]: 
[0m11:19:17.136368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:19:17.155218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6890125, "process_user_time": 5.843178, "process_kernel_time": 0.382653, "process_mem_max_rss": "125595648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:19:17.157646 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:17.157105 after 4.70 seconds
[0m11:19:17.169482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b250>]}
[0m11:19:17.171952 [debug] [MainThread]: Flushing usage events
[0m11:23:24.550882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af66d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af66860>]}


============================== 11:23:24.556990 | c797a02b-8c92-42a8-8dcd-72a571ab1ce9 ==============================
[0m11:23:24.556990 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:23:24.558042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:24.790523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c797a02b-8c92-42a8-8dcd-72a571ab1ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af66b90>]}
[0m11:23:24.864224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c797a02b-8c92-42a8-8dcd-72a571ab1ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeeb820>]}
[0m11:23:24.865260 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:23:24.895548 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:23:24.956363 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 8 files added, 0 files changed.
[0m11:23:24.957138 [debug] [MainThread]: Partial parsing: added file: xeneta://models/staging/stg_charges.sql
[0m11:23:24.957770 [debug] [MainThread]: Partial parsing: added file: xeneta://models/staging/schema.yml
[0m11:23:24.958256 [debug] [MainThread]: Partial parsing: added file: xeneta://models/staging/stg_ports.sql
[0m11:23:24.958738 [debug] [MainThread]: Partial parsing: added file: xeneta://models/final/prices.sql
[0m11:23:24.959210 [debug] [MainThread]: Partial parsing: added file: xeneta://models/final/aggregations.sql
[0m11:23:24.959687 [debug] [MainThread]: Partial parsing: added file: xeneta://models/staging/stg_datapoints.sql
[0m11:23:24.960333 [debug] [MainThread]: Partial parsing: added file: xeneta://models/staging/stg_regions.sql
[0m11:23:24.960847 [debug] [MainThread]: Partial parsing: added file: xeneta://models/staging/stg_exchange_rate.sql
[0m11:23:24.961416 [debug] [MainThread]: Partial parsing: deleted file: xeneta://models/example/my_first_dbt_model.sql
[0m11:23:24.961850 [debug] [MainThread]: Partial parsing: deleted file: xeneta://models/example/my_second_dbt_model.sql
[0m11:23:25.248995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c797a02b-8c92-42a8-8dcd-72a571ab1ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf00d0>]}
[0m11:23:25.265127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c797a02b-8c92-42a8-8dcd-72a571ab1ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c46d0>]}
[0m11:23:25.265891 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:23:25.266508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c797a02b-8c92-42a8-8dcd-72a571ab1ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4cd090>]}
[0m11:23:25.268786 [info ] [MainThread]: 
[0m11:23:25.270122 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:25.271758 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:25.299062 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:25.300252 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:23:25.300916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:25.314177 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.316611 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:25.319951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m11:23:25.321088 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m11:23:25.333006 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:25.333689 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:23:25.334203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:25.342796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.344687 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:25.345197 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m11:23:25.345848 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.346367 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:25.346850 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m11:23:25.347546 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.348778 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:25.349296 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:25.349771 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:25.351565 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.352370 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m11:23:25.359503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m11:23:25.368386 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:25.369021 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:23:25.369507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:25.377486 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.378166 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:25.378671 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:23:25.419790 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.421417 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:23:25.422217 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:23:25.422632 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:23:25.426149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:23:25.429149 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:25.429986 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:23:25.430793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:25.441701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.442367 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:25.442885 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:23:25.483898 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:25.485473 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:23:25.485973 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:23:25.486338 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:23:25.489660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c797a02b-8c92-42a8-8dcd-72a571ab1ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec37d30>]}
[0m11:23:25.490358 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:25.490789 [debug] [MainThread]: On master: BEGIN
[0m11:23:25.491186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:25.498468 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:25.499125 [debug] [MainThread]: On master: COMMIT
[0m11:23:25.499561 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:25.500014 [debug] [MainThread]: On master: COMMIT
[0m11:23:25.500604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:25.501098 [debug] [MainThread]: On master: Close
[0m11:23:25.503497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:25.504129 [info ] [MainThread]: 
[0m11:23:25.506969 [debug] [Thread-1 (]: Began running node model.xeneta.stg_ports
[0m11:23:25.507810 [info ] [Thread-1 (]: 1 of 1 START sql table model main_staging.stg_ports ............................ [RUN]
[0m11:23:25.508882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_ports)
[0m11:23:25.509504 [debug] [Thread-1 (]: Began compiling node model.xeneta.stg_ports
[0m11:23:25.532897 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.stg_ports"
[0m11:23:25.534614 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_ports (compile): 11:23:25.510769 => 11:23:25.534128
[0m11:23:25.535325 [debug] [Thread-1 (]: Began executing node model.xeneta.stg_ports
[0m11:23:25.689725 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m11:23:25.690490 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
DESCRIBE (select * from (
        

with stg_ports as (

    select
        Cast(PID as integer ) as PID,
        Cast(Code as char(5) ) as Code,
        Cast(Slug as varchar ) as Slug,
        Cast(Name as varchar )as Name,
        Cast(Country as varchar ) as Country,
        Cast(Country_Code as char(2) ) as Country_Code,
        ROW_NUMBER() OVER (PARTITION BY PID ORDER BY PID) AS row_num
    from raw.ports
    
)

select
PID,
Code,
Slug,
Name,
Country,
Country_Code
from stg_ports
where row_num = 1
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:23:25.691073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:25.701057 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:25.713630 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m11:23:25.714345 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
DESCRIBE (select * from (
        select
    
      cast(null as integer) as PID, 
      cast(null as char(5)) as Code, 
      cast(null as varchar) as Slug, 
      cast(null as varchar) as Name, 
      cast(null as varchar) as Country, 
      cast(null as char(2)) as Country_Code
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:23:25.715543 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:25.762924 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.stg_ports"
[0m11:23:25.764388 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m11:23:25.765100 [debug] [Thread-1 (]: On model.xeneta.stg_ports: BEGIN
[0m11:23:25.766275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:25.767416 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m11:23:25.768669 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */

  
    
    
      
    

    create  table
      "dev"."main_staging"."stg_ports__dbt_tmp"
  
  (
    PID integer not null,
    Code char(5),
    Slug varchar,
    Name varchar,
    Country varchar,
    Country_Code char(2),
    
    primary key (PID)
    )
 ;
    insert into "dev"."main_staging"."stg_ports__dbt_tmp" 
  (
    
      
      PID ,
    
      
      Code ,
    
      
      Slug ,
    
      
      Name ,
    
      
      Country ,
    
      
      Country_Code 
    
  )
 (
      
    select PID, Code, Slug, Name, Country, Country_Code
    from (
        

with stg_ports as (

    select
        Cast(PID as integer ) as PID,
        Cast(Code as char(5) ) as Code,
        Cast(Slug as varchar ) as Slug,
        Cast(Name as varchar )as Name,
        Cast(Country as varchar ) as Country,
        Cast(Country_Code as char(2) ) as Country_Code,
        ROW_NUMBER() OVER (PARTITION BY PID ORDER BY PID) AS row_num
    from raw.ports
    
)

select
PID,
Code,
Slug,
Name,
Country,
Country_Code
from stg_ports
where row_num = 1
    ) as model_subq
    );
  
  
[0m11:23:25.783835 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:25.794965 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m11:23:25.795800 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
alter table "dev"."main_staging"."stg_ports__dbt_tmp" rename to "stg_ports"
[0m11:23:25.796905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:25.825382 [debug] [Thread-1 (]: On model.xeneta.stg_ports: COMMIT
[0m11:23:25.826078 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m11:23:25.826606 [debug] [Thread-1 (]: On model.xeneta.stg_ports: COMMIT
[0m11:23:25.828120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:25.835674 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m11:23:25.836506 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
drop table if exists "dev"."main_staging"."stg_ports__dbt_backup" cascade
[0m11:23:25.837401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:25.840139 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_ports (execute): 11:23:25.535749 => 11:23:25.839362
[0m11:23:25.840860 [debug] [Thread-1 (]: On model.xeneta.stg_ports: Close
[0m11:23:25.850861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c797a02b-8c92-42a8-8dcd-72a571ab1ce9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec57fd0>]}
[0m11:23:25.851905 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_staging.stg_ports ....................... [[32mOK[0m in 0.34s]
[0m11:23:25.853013 [debug] [Thread-1 (]: Finished running node model.xeneta.stg_ports
[0m11:23:25.855043 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:25.855645 [debug] [MainThread]: On master: BEGIN
[0m11:23:25.856138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:25.868717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:25.869687 [debug] [MainThread]: On master: COMMIT
[0m11:23:25.871212 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:25.872135 [debug] [MainThread]: On master: COMMIT
[0m11:23:25.873647 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:25.874548 [debug] [MainThread]: On master: Close
[0m11:23:25.877318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:25.877970 [debug] [MainThread]: Connection 'model.xeneta.stg_ports' was properly closed.
[0m11:23:25.878618 [info ] [MainThread]: 
[0m11:23:25.881755 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m11:23:25.884394 [debug] [MainThread]: Command end result
[0m11:23:25.906467 [info ] [MainThread]: 
[0m11:23:25.907415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:25.908140 [info ] [MainThread]: 
[0m11:23:25.909046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:25.911458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4482818, "process_user_time": 4.829604, "process_kernel_time": 0.389318, "process_mem_max_rss": "128868352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:25.912491 [debug] [MainThread]: Command `cli run` succeeded at 11:23:25.912252 after 1.45 seconds
[0m11:23:25.916918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec57fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afdbe80>]}
[0m11:23:25.920237 [debug] [MainThread]: Flushing usage events
[0m11:23:26.466106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afdbe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee8d60>]}


============================== 11:23:26.467980 | 1e2ed736-3cba-409e-9465-5e620f0ffbed ==============================
[0m11:23:26.467980 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:23:26.469900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:26.539853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e2ed736-3cba-409e-9465-5e620f0ffbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee9120>]}
[0m11:23:26.543222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e2ed736-3cba-409e-9465-5e620f0ffbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af64bb0>]}
[0m11:23:26.544317 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:23:26.576907 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:23:26.671876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:26.672533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:26.681156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e2ed736-3cba-409e-9465-5e620f0ffbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edc40d0>]}
[0m11:23:26.696834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e2ed736-3cba-409e-9465-5e620f0ffbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf2320>]}
[0m11:23:26.697663 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:23:26.698345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2ed736-3cba-409e-9465-5e620f0ffbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf19c0>]}
[0m11:23:26.699662 [info ] [MainThread]: 
[0m11:23:26.700887 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:26.702343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:26.708512 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:26.709827 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:23:26.710594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:26.724286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.727193 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:26.733665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m11:23:26.736038 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m11:23:26.740742 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:26.741482 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:23:26.742074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:26.761384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.778334 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:26.779466 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m11:23:26.780868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.781947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:26.782946 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m11:23:26.784331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.787088 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:26.788213 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:26.789233 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:26.790737 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.791857 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m11:23:26.800512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m11:23:26.808027 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:26.808750 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:23:26.809323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:26.818382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.819083 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:26.819671 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:23:26.858584 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.865935 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:23:26.866725 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:23:26.867183 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:23:26.870820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:23:26.874252 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:26.874776 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:23:26.875223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:26.882553 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.883180 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:26.883657 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:23:26.921410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:26.922972 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:23:26.923475 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:23:26.923838 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:23:26.927703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e2ed736-3cba-409e-9465-5e620f0ffbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edc5180>]}
[0m11:23:26.928590 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:26.929085 [debug] [MainThread]: On master: BEGIN
[0m11:23:26.929514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:26.936561 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:26.937201 [debug] [MainThread]: On master: COMMIT
[0m11:23:26.937779 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:26.938571 [debug] [MainThread]: On master: COMMIT
[0m11:23:26.939860 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:26.940427 [debug] [MainThread]: On master: Close
[0m11:23:26.942824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:26.943492 [info ] [MainThread]: 
[0m11:23:26.945056 [debug] [Thread-5 (]: Began running node model.xeneta.stg_regions
[0m11:23:26.945817 [info ] [Thread-5 (]: 1 of 1 START sql table model main_staging.stg_regions .......................... [RUN]
[0m11:23:26.946968 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_regions)
[0m11:23:26.947604 [debug] [Thread-5 (]: Began compiling node model.xeneta.stg_regions
[0m11:23:26.954090 [debug] [Thread-5 (]: Writing injected SQL for node "model.xeneta.stg_regions"
[0m11:23:26.955927 [debug] [Thread-5 (]: Timing info for model.xeneta.stg_regions (compile): 11:23:26.947976 => 11:23:26.955398
[0m11:23:26.956955 [debug] [Thread-5 (]: Began executing node model.xeneta.stg_regions
[0m11:23:26.969972 [debug] [Thread-5 (]: Writing runtime sql for node "model.xeneta.stg_regions"
[0m11:23:26.971506 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m11:23:26.972396 [debug] [Thread-5 (]: On model.xeneta.stg_regions: BEGIN
[0m11:23:26.973094 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m11:23:26.984625 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:23:26.985804 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m11:23:26.986621 [debug] [Thread-5 (]: On model.xeneta.stg_regions: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_regions"} */

  
    
    

    create  table
      "dev"."main_staging"."stg_regions__dbt_tmp"
  
    as (
      

with stg_regions as (

    select
        
        Cast(Slug as varchar(80) ) as Slug,
        Cast(Name as varchar(80) ) as Name,
        Cast(Parent as varchar(80) ) as Parent,
        
    from raw.regions
    
)

select *
from stg_regions
    );
  
  
[0m11:23:26.988938 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:23:26.994675 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m11:23:26.995472 [debug] [Thread-5 (]: On model.xeneta.stg_regions: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_regions"} */
alter table "dev"."main_staging"."stg_regions__dbt_tmp" rename to "stg_regions"
[0m11:23:26.997213 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:23:27.002642 [debug] [Thread-5 (]: On model.xeneta.stg_regions: COMMIT
[0m11:23:27.003823 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m11:23:27.004976 [debug] [Thread-5 (]: On model.xeneta.stg_regions: COMMIT
[0m11:23:27.007018 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:23:27.011732 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m11:23:27.012464 [debug] [Thread-5 (]: On model.xeneta.stg_regions: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_regions"} */
drop table if exists "dev"."main_staging"."stg_regions__dbt_backup" cascade
[0m11:23:27.013477 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:23:27.016313 [debug] [Thread-5 (]: Timing info for model.xeneta.stg_regions (execute): 11:23:26.957712 => 11:23:27.015821
[0m11:23:27.017160 [debug] [Thread-5 (]: On model.xeneta.stg_regions: Close
[0m11:23:27.026153 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e2ed736-3cba-409e-9465-5e620f0ffbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee04a90>]}
[0m11:23:27.027359 [info ] [Thread-5 (]: 1 of 1 OK created sql table model main_staging.stg_regions ..................... [[32mOK[0m in 0.08s]
[0m11:23:27.028748 [debug] [Thread-5 (]: Finished running node model.xeneta.stg_regions
[0m11:23:27.031045 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:27.031703 [debug] [MainThread]: On master: BEGIN
[0m11:23:27.032255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:27.045422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:27.046160 [debug] [MainThread]: On master: COMMIT
[0m11:23:27.047071 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:27.048818 [debug] [MainThread]: On master: COMMIT
[0m11:23:27.050655 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:27.051470 [debug] [MainThread]: On master: Close
[0m11:23:27.054266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:27.055234 [debug] [MainThread]: Connection 'model.xeneta.stg_regions' was properly closed.
[0m11:23:27.056130 [info ] [MainThread]: 
[0m11:23:27.057252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m11:23:27.058896 [debug] [MainThread]: Command end result
[0m11:23:27.077374 [info ] [MainThread]: 
[0m11:23:27.078316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:27.079699 [info ] [MainThread]: 
[0m11:23:27.080877 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:27.082168 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6210707, "process_user_time": 5.327176, "process_kernel_time": 0.45895, "process_mem_max_rss": "133570560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:27.083944 [debug] [MainThread]: Command `cli run` succeeded at 11:23:27.082896 after 0.62 seconds
[0m11:23:27.088858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af64bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee07700>]}
[0m11:23:27.089895 [debug] [MainThread]: Flushing usage events
[0m11:23:27.575251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3605b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec17040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec158a0>]}


============================== 11:23:27.576224 | bed5f6f7-0655-4ab5-b203-1205d529e55c ==============================
[0m11:23:27.576224 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:23:27.577270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:27.616527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed5f6f7-0655-4ab5-b203-1205d529e55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec17be0>]}
[0m11:23:27.620096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed5f6f7-0655-4ab5-b203-1205d529e55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec15270>]}
[0m11:23:27.620998 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:23:27.640622 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:23:27.707637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:27.708284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:27.716615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed5f6f7-0655-4ab5-b203-1205d529e55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee941f0>]}
[0m11:23:27.730871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed5f6f7-0655-4ab5-b203-1205d529e55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edddf00>]}
[0m11:23:27.731739 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:23:27.732513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed5f6f7-0655-4ab5-b203-1205d529e55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edddf90>]}
[0m11:23:27.733908 [info ] [MainThread]: 
[0m11:23:27.735200 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:27.737496 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:27.743302 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:27.747895 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:23:27.752273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:27.768587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.771702 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:27.775897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m11:23:27.777152 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m11:23:27.783502 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:27.784407 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:23:27.785215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:27.795788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.798308 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:27.799209 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m11:23:27.800207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.800849 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:27.801453 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m11:23:27.802273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.803764 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:27.804361 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:27.804970 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:27.805764 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.806497 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m11:23:27.811482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m11:23:27.816553 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:27.817286 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:23:27.817837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:27.826730 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.827475 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:27.828069 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:23:27.865826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.873701 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:23:27.874385 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:23:27.874801 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:23:27.878469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:23:27.881599 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:27.882830 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:23:27.883289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:27.891240 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.891895 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:27.892411 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:23:27.930192 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:27.931786 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:23:27.932285 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:23:27.932648 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:23:27.935785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed5f6f7-0655-4ab5-b203-1205d529e55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee95c00>]}
[0m11:23:27.936456 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:27.936878 [debug] [MainThread]: On master: BEGIN
[0m11:23:27.937269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:27.944058 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:27.944663 [debug] [MainThread]: On master: COMMIT
[0m11:23:27.945094 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:27.945505 [debug] [MainThread]: On master: COMMIT
[0m11:23:27.946131 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:27.946559 [debug] [MainThread]: On master: Close
[0m11:23:27.948781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:27.949496 [info ] [MainThread]: 
[0m11:23:27.951234 [debug] [Thread-9 (]: Began running node model.xeneta.stg_exchange_rate
[0m11:23:27.953092 [info ] [Thread-9 (]: 1 of 1 START sql table model main_staging.stg_exchange_rate .................... [RUN]
[0m11:23:27.955424 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_exchange_rate)
[0m11:23:27.956817 [debug] [Thread-9 (]: Began compiling node model.xeneta.stg_exchange_rate
[0m11:23:27.964875 [debug] [Thread-9 (]: Writing injected SQL for node "model.xeneta.stg_exchange_rate"
[0m11:23:27.968160 [debug] [Thread-9 (]: Timing info for model.xeneta.stg_exchange_rate (compile): 11:23:27.957360 => 11:23:27.967533
[0m11:23:27.968964 [debug] [Thread-9 (]: Began executing node model.xeneta.stg_exchange_rate
[0m11:23:27.975580 [debug] [Thread-9 (]: Writing runtime sql for node "model.xeneta.stg_exchange_rate"
[0m11:23:27.976791 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m11:23:27.977479 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: BEGIN
[0m11:23:27.978303 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m11:23:27.989607 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:23:27.990602 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m11:23:27.991386 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_exchange_rate"} */

  
    
    

    create  table
      "dev"."main_staging"."stg_exchange_rate__dbt_tmp"
  
    as (
      

with stg_exchange_rate as (

    select
        Cast(Day as DATE ) as Day,
        Cast(Currency as Char(3) ) as Currency,
        Cast(Rate as decimal(18,10) ) as Rate,
        -- ROW_NUMBER() OVER (PARTITION BY PID ORDER BY PID) AS row_num
    from raw.exchange_rate
    
)

select *
from stg_exchange_rate
    );
  
  
[0m11:23:28.020209 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:23:28.024741 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m11:23:28.025361 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_exchange_rate"} */
alter table "dev"."main_staging"."stg_exchange_rate__dbt_tmp" rename to "stg_exchange_rate"
[0m11:23:28.026296 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:23:28.028902 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: COMMIT
[0m11:23:28.029483 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m11:23:28.030084 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: COMMIT
[0m11:23:28.040508 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:23:28.045184 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m11:23:28.045852 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_exchange_rate"} */
drop table if exists "dev"."main_staging"."stg_exchange_rate__dbt_backup" cascade
[0m11:23:28.046794 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:23:28.048925 [debug] [Thread-9 (]: Timing info for model.xeneta.stg_exchange_rate (execute): 11:23:27.969397 => 11:23:28.048602
[0m11:23:28.049509 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: Close
[0m11:23:28.074938 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed5f6f7-0655-4ab5-b203-1205d529e55c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee0fdc0>]}
[0m11:23:28.076001 [info ] [Thread-9 (]: 1 of 1 OK created sql table model main_staging.stg_exchange_rate ............... [[32mOK[0m in 0.12s]
[0m11:23:28.077012 [debug] [Thread-9 (]: Finished running node model.xeneta.stg_exchange_rate
[0m11:23:28.079019 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:28.079603 [debug] [MainThread]: On master: BEGIN
[0m11:23:28.080177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:28.093294 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:28.094175 [debug] [MainThread]: On master: COMMIT
[0m11:23:28.095192 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:28.095822 [debug] [MainThread]: On master: COMMIT
[0m11:23:28.096737 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:28.097715 [debug] [MainThread]: On master: Close
[0m11:23:28.101887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:28.102563 [debug] [MainThread]: Connection 'model.xeneta.stg_exchange_rate' was properly closed.
[0m11:23:28.103162 [info ] [MainThread]: 
[0m11:23:28.104064 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:23:28.105662 [debug] [MainThread]: Command end result
[0m11:23:28.128323 [info ] [MainThread]: 
[0m11:23:28.129472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:28.131230 [info ] [MainThread]: 
[0m11:23:28.134527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:28.135987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5645486, "process_user_time": 5.819156, "process_kernel_time": 0.523828, "process_mem_max_rss": "139542528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:28.137494 [debug] [MainThread]: Command `cli run` succeeded at 11:23:28.136903 after 0.57 seconds
[0m11:23:28.138662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3605b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee917e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee925f0>]}
[0m11:23:28.139406 [debug] [MainThread]: Flushing usage events
[0m11:23:28.613062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b303550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b303c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b302e00>]}


============================== 11:23:28.614092 | 5c79e5d0-70a8-4b25-8144-82f29c84201d ==============================
[0m11:23:28.614092 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:23:28.615148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:28.657091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c79e5d0-70a8-4b25-8144-82f29c84201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b302f50>]}
[0m11:23:28.659438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c79e5d0-70a8-4b25-8144-82f29c84201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b302e90>]}
[0m11:23:28.660364 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:23:28.674693 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:23:28.740143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:28.740759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:28.748966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c79e5d0-70a8-4b25-8144-82f29c84201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef64190>]}
[0m11:23:28.761889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c79e5d0-70a8-4b25-8144-82f29c84201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeab220>]}
[0m11:23:28.762688 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:23:28.763649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c79e5d0-70a8-4b25-8144-82f29c84201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeab190>]}
[0m11:23:28.765299 [info ] [MainThread]: 
[0m11:23:28.767219 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:28.770097 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:28.784944 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:28.785965 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:23:28.786660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:28.797306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.803231 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:28.807503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m11:23:28.808850 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m11:23:28.812479 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:28.813217 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:23:28.814113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:28.825038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.827163 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:28.827769 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m11:23:28.828479 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.829035 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:28.829585 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m11:23:28.830487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.831918 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:28.832477 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:28.833004 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:28.833731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.834286 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m11:23:28.839275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m11:23:28.843001 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:28.843861 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:23:28.844430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:28.852609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.853240 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:28.853774 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:23:28.889304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.896382 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:23:28.897257 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:23:28.897680 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:23:28.901255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:23:28.906114 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:28.906681 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:23:28.907134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:28.914489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.915113 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:28.915584 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:23:28.952108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:28.953682 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:23:28.954186 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:23:28.954551 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:23:28.957692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c79e5d0-70a8-4b25-8144-82f29c84201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef68dc0>]}
[0m11:23:28.958355 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:28.958777 [debug] [MainThread]: On master: BEGIN
[0m11:23:28.959167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:28.966987 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:28.967604 [debug] [MainThread]: On master: COMMIT
[0m11:23:28.968066 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:28.968492 [debug] [MainThread]: On master: COMMIT
[0m11:23:28.969072 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:28.969524 [debug] [MainThread]: On master: Close
[0m11:23:28.972182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:28.972916 [info ] [MainThread]: 
[0m11:23:28.974473 [debug] [Thread-13 ]: Began running node model.xeneta.stg_datapoints
[0m11:23:28.975387 [info ] [Thread-13 ]: 1 of 1 START sql incremental model main_staging.stg_datapoints ................. [RUN]
[0m11:23:28.976565 [debug] [Thread-13 ]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_datapoints)
[0m11:23:28.977250 [debug] [Thread-13 ]: Began compiling node model.xeneta.stg_datapoints
[0m11:23:28.984533 [debug] [Thread-13 ]: Writing injected SQL for node "model.xeneta.stg_datapoints"
[0m11:23:28.986105 [debug] [Thread-13 ]: Timing info for model.xeneta.stg_datapoints (compile): 11:23:28.977626 => 11:23:28.985527
[0m11:23:28.986983 [debug] [Thread-13 ]: Began executing node model.xeneta.stg_datapoints
[0m11:23:29.067171 [debug] [Thread-13 ]: Writing runtime sql for node "model.xeneta.stg_datapoints"
[0m11:23:29.068379 [debug] [Thread-13 ]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:23:29.068990 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: BEGIN
[0m11:23:29.069542 [debug] [Thread-13 ]: Opening a new connection, currently in state closed
[0m11:23:29.077314 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
[0m11:23:29.077997 [debug] [Thread-13 ]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:23:29.078577 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

  
    
    

    create  table
      "dev"."main_staging"."stg_datapoints"
  
    as (
      

with stg_datapoints as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Created as timestamp ) as Created,
        Cast(Origin_PID as integer ) as Origin_PID,
        Cast(Destination_PID as integer )as Destination_PID,
        Cast(Valid_From as date ) as Valid_From,
        Cast(Valid_To as date ) as Valid_To,
        Cast(Company_ID as integer ) as Company_ID,
        Cast(Supplier_ID as integer ) as Supplier_ID,
        Cast(Equipment_ID as integer ) as Equipment_ID,
        row_number() over (partition by d_id order by created )as row_num
    from raw.datapoints

    
)

select *
from stg_datapoints
where row_num = 1
    );
  
  
  
[0m11:23:29.107404 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
[0m11:23:29.110045 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: COMMIT
[0m11:23:29.110637 [debug] [Thread-13 ]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:23:29.111147 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: COMMIT
[0m11:23:29.118630 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
[0m11:23:29.120327 [debug] [Thread-13 ]: Timing info for model.xeneta.stg_datapoints (execute): 11:23:28.987426 => 11:23:29.120011
[0m11:23:29.120892 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: Close
[0m11:23:29.134970 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c79e5d0-70a8-4b25-8144-82f29c84201d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef52080>]}
[0m11:23:29.136069 [info ] [Thread-13 ]: 1 of 1 OK created sql incremental model main_staging.stg_datapoints ............ [[32mOK[0m in 0.16s]
[0m11:23:29.137114 [debug] [Thread-13 ]: Finished running node model.xeneta.stg_datapoints
[0m11:23:29.139093 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:29.139698 [debug] [MainThread]: On master: BEGIN
[0m11:23:29.140209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:29.154002 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:29.155406 [debug] [MainThread]: On master: COMMIT
[0m11:23:29.156583 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:29.157682 [debug] [MainThread]: On master: COMMIT
[0m11:23:29.158844 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:29.159619 [debug] [MainThread]: On master: Close
[0m11:23:29.162754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:29.166001 [debug] [MainThread]: Connection 'model.xeneta.stg_datapoints' was properly closed.
[0m11:23:29.166811 [info ] [MainThread]: 
[0m11:23:29.167868 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:23:29.169115 [debug] [MainThread]: Command end result
[0m11:23:29.186308 [info ] [MainThread]: 
[0m11:23:29.187138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:29.187810 [info ] [MainThread]: 
[0m11:23:29.188490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:29.189352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5799615, "process_user_time": 6.368912, "process_kernel_time": 0.597482, "process_mem_max_rss": "151650304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:29.190262 [debug] [MainThread]: Command `cli run` succeeded at 11:23:29.190028 after 0.58 seconds
[0m11:23:29.190892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b47d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b302f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeaab00>]}
[0m11:23:29.192303 [debug] [MainThread]: Flushing usage events
[0m11:23:29.680386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee0fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ede9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b47d120>]}


============================== 11:23:29.681339 | 625e1638-8c3b-4159-8461-b50b56e9b7b7 ==============================
[0m11:23:29.681339 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:23:29.682373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:29.717901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '625e1638-8c3b-4159-8461-b50b56e9b7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee04a90>]}
[0m11:23:29.720525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '625e1638-8c3b-4159-8461-b50b56e9b7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3017e0>]}
[0m11:23:29.721648 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:23:29.738118 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:23:29.803153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:29.803761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:29.812228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '625e1638-8c3b-4159-8461-b50b56e9b7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11106d720>]}
[0m11:23:29.908709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '625e1638-8c3b-4159-8461-b50b56e9b7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef78100>]}
[0m11:23:29.909707 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:23:29.910578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625e1638-8c3b-4159-8461-b50b56e9b7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef789a0>]}
[0m11:23:29.912177 [info ] [MainThread]: 
[0m11:23:29.913795 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:29.915800 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:29.923075 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:29.925286 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:23:29.926452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:29.943179 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:29.945428 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:29.951032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m11:23:29.952498 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m11:23:29.957725 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:29.958533 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:23:29.959424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:29.969791 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:29.972035 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:29.972793 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m11:23:29.973536 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:29.974225 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:29.974819 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m11:23:29.975593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:29.976993 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:29.977574 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:23:29.978115 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:23:29.979037 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:29.979770 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m11:23:29.984676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m11:23:29.988721 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:29.989408 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:23:29.989949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:30.001340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:30.002337 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:30.003256 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:23:30.048375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:30.059307 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:23:30.060069 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:23:30.060533 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:23:30.064702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:23:30.069374 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:30.069990 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:23:30.070485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:30.078104 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:30.078717 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:30.079216 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:23:30.118009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:30.119583 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:23:30.120082 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:23:30.120448 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:23:30.123862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625e1638-8c3b-4159-8461-b50b56e9b7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee82950>]}
[0m11:23:30.125410 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:30.125933 [debug] [MainThread]: On master: BEGIN
[0m11:23:30.126366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:30.133421 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:30.134004 [debug] [MainThread]: On master: COMMIT
[0m11:23:30.134480 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:30.134918 [debug] [MainThread]: On master: COMMIT
[0m11:23:30.135549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:30.136010 [debug] [MainThread]: On master: Close
[0m11:23:30.138358 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:30.139023 [info ] [MainThread]: 
[0m11:23:30.140598 [debug] [Thread-17 ]: Began running node model.xeneta.stg_charges
[0m11:23:30.141348 [info ] [Thread-17 ]: 1 of 1 START sql incremental model main_staging.stg_charges .................... [RUN]
[0m11:23:30.142391 [debug] [Thread-17 ]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_charges)
[0m11:23:30.142990 [debug] [Thread-17 ]: Began compiling node model.xeneta.stg_charges
[0m11:23:30.150323 [debug] [Thread-17 ]: Writing injected SQL for node "model.xeneta.stg_charges"
[0m11:23:30.152290 [debug] [Thread-17 ]: Timing info for model.xeneta.stg_charges (compile): 11:23:30.143343 => 11:23:30.151530
[0m11:23:30.153431 [debug] [Thread-17 ]: Began executing node model.xeneta.stg_charges
[0m11:23:30.167738 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:23:30.168568 [debug] [Thread-17 ]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */
DESCRIBE (select * from (
        

with stg_charges as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Currency as char(3) ) as Currency,
        Cast(Charge_Value as integer ) as Charge_Value,
        row_number() over (partition by d_id, currency order by Charge_Value )as row_num
    from raw.charges
    
    
)

select *
from stg_charges
where row_num = 1
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:23:30.169239 [debug] [Thread-17 ]: Opening a new connection, currently in state closed
[0m11:23:30.180060 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m11:23:30.184154 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:23:30.184973 [debug] [Thread-17 ]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */
DESCRIBE (select * from (
        select
    
      cast(null as integer) as D_ID, 
      cast(null as char(3)) as Currency, 
      cast(null as integer) as Charge_Value, 
      cast(null as BIGINT) as row_num
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:23:30.186261 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m11:23:30.193437 [debug] [Thread-17 ]: Writing runtime sql for node "model.xeneta.stg_charges"
[0m11:23:30.194991 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:23:30.195787 [debug] [Thread-17 ]: On model.xeneta.stg_charges: BEGIN
[0m11:23:30.197748 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m11:23:30.198536 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:23:30.199238 [debug] [Thread-17 ]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */

  
    
    
      
    

    create  table
      "dev"."main_staging"."stg_charges"
  
  (
    D_ID integer not null,
    Currency char(3),
    Charge_Value integer,
    row_num BIGINT
    
    )
 ;
    insert into "dev"."main_staging"."stg_charges" 
  (
    
      
      D_ID ,
    
      
      Currency ,
    
      
      Charge_Value ,
    
      
      row_num 
    
  )
 (
      
    select D_ID, Currency, Charge_Value, row_num
    from (
        

with stg_charges as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Currency as char(3) ) as Currency,
        Cast(Charge_Value as integer ) as Charge_Value,
        row_number() over (partition by d_id, currency order by Charge_Value )as row_num
    from raw.charges
    
    
)

select *
from stg_charges
where row_num = 1
    ) as model_subq
    );
  
  
  
[0m11:23:30.253980 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m11:23:30.256500 [debug] [Thread-17 ]: On model.xeneta.stg_charges: COMMIT
[0m11:23:30.257038 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:23:30.257516 [debug] [Thread-17 ]: On model.xeneta.stg_charges: COMMIT
[0m11:23:30.263287 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m11:23:30.265157 [debug] [Thread-17 ]: Timing info for model.xeneta.stg_charges (execute): 11:23:30.154647 => 11:23:30.264832
[0m11:23:30.265787 [debug] [Thread-17 ]: On model.xeneta.stg_charges: Close
[0m11:23:30.280074 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625e1638-8c3b-4159-8461-b50b56e9b7b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec612d0>]}
[0m11:23:30.281044 [info ] [Thread-17 ]: 1 of 1 OK created sql incremental model main_staging.stg_charges ............... [[32mOK[0m in 0.14s]
[0m11:23:30.281985 [debug] [Thread-17 ]: Finished running node model.xeneta.stg_charges
[0m11:23:30.283897 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:30.284467 [debug] [MainThread]: On master: BEGIN
[0m11:23:30.284947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:30.300730 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:30.301875 [debug] [MainThread]: On master: COMMIT
[0m11:23:30.302651 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:30.303235 [debug] [MainThread]: On master: COMMIT
[0m11:23:30.304035 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:30.304678 [debug] [MainThread]: On master: Close
[0m11:23:30.307593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:30.308251 [debug] [MainThread]: Connection 'model.xeneta.stg_charges' was properly closed.
[0m11:23:30.308862 [info ] [MainThread]: 
[0m11:23:30.309616 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:23:30.310840 [debug] [MainThread]: Command end result
[0m11:23:30.329832 [info ] [MainThread]: 
[0m11:23:30.332653 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:30.334046 [info ] [MainThread]: 
[0m11:23:30.340591 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:30.342563 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6654878, "process_user_time": 7.051344, "process_kernel_time": 0.675625, "process_mem_max_rss": "166313984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:30.343743 [debug] [MainThread]: Command `cli run` succeeded at 11:23:30.343487 after 0.67 seconds
[0m11:23:30.344417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef64100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec60640>]}
[0m11:23:30.345146 [debug] [MainThread]: Flushing usage events
[0m11:23:30.823215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae00c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec62d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec60400>]}


============================== 11:23:30.824428 | 38a788ad-0f6f-4677-a5ef-3c39a978a4cf ==============================
[0m11:23:30.824428 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:23:30.825265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:30.854156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38a788ad-0f6f-4677-a5ef-3c39a978a4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec61db0>]}
[0m11:23:30.857208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38a788ad-0f6f-4677-a5ef-3c39a978a4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec60ac0>]}
[0m11:23:30.858287 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:23:30.871741 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:23:30.933844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:23:30.934467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:23:30.942805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38a788ad-0f6f-4677-a5ef-3c39a978a4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c58d0>]}
[0m11:23:30.956525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38a788ad-0f6f-4677-a5ef-3c39a978a4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee93640>]}
[0m11:23:30.957425 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:23:30.958085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38a788ad-0f6f-4677-a5ef-3c39a978a4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee92500>]}
[0m11:23:30.959384 [info ] [MainThread]: 
[0m11:23:30.960565 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:30.961975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:30.968566 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:30.969999 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:23:30.971447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:30.985201 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:30.987521 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:30.991129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m11:23:30.992418 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m11:23:31.000304 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:23:31.001234 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:23:31.001935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:31.012041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.014949 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:23:31.016162 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m11:23:31.017046 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.017623 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:23:31.018186 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m11:23:31.018948 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.020389 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:23:31.020986 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:23:31.021538 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:23:31.023373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.024442 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m11:23:31.032812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m11:23:31.036974 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:31.037613 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:23:31.038151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:31.047311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.047996 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:23:31.048557 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:23:31.084380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.091253 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:23:31.091827 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:23:31.092219 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:23:31.095832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:23:31.100686 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:31.101287 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:23:31.101734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:31.109088 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.109715 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:23:31.110189 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:23:31.145979 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:31.147628 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:23:31.148136 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:23:31.148502 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:23:31.152045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38a788ad-0f6f-4677-a5ef-3c39a978a4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4ce8f0>]}
[0m11:23:31.152964 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:31.153492 [debug] [MainThread]: On master: BEGIN
[0m11:23:31.153910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:31.161172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:31.161798 [debug] [MainThread]: On master: COMMIT
[0m11:23:31.162316 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:31.162746 [debug] [MainThread]: On master: COMMIT
[0m11:23:31.163373 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:31.163838 [debug] [MainThread]: On master: Close
[0m11:23:31.166027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:31.166638 [info ] [MainThread]: 
[0m11:23:31.168198 [debug] [Thread-21 ]: Began running node model.xeneta.aggregations
[0m11:23:31.168945 [info ] [Thread-21 ]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m11:23:31.171655 [debug] [Thread-21 ]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m11:23:31.173055 [debug] [Thread-21 ]: Began compiling node model.xeneta.aggregations
[0m11:23:31.182956 [debug] [Thread-21 ]: Writing injected SQL for node "model.xeneta.aggregations"
[0m11:23:31.185828 [debug] [Thread-21 ]: Timing info for model.xeneta.aggregations (compile): 11:23:31.173670 => 11:23:31.185122
[0m11:23:31.186784 [debug] [Thread-21 ]: Began executing node model.xeneta.aggregations
[0m11:23:31.193314 [debug] [Thread-21 ]: Writing runtime sql for node "model.xeneta.aggregations"
[0m11:23:31.194667 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m11:23:31.195359 [debug] [Thread-21 ]: On model.xeneta.aggregations: BEGIN
[0m11:23:31.196289 [debug] [Thread-21 ]: Opening a new connection, currently in state closed
[0m11:23:31.208463 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m11:23:31.209251 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m11:23:31.210020 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m11:23:32.187712 [debug] [Thread-21 ]: SQL status: OK in 1.0 seconds
[0m11:23:32.191896 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m11:23:32.192483 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m11:23:32.193425 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m11:23:32.195906 [debug] [Thread-21 ]: On model.xeneta.aggregations: COMMIT
[0m11:23:32.196495 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m11:23:32.196990 [debug] [Thread-21 ]: On model.xeneta.aggregations: COMMIT
[0m11:23:32.349532 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m11:23:32.359343 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m11:23:32.360462 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m11:23:32.361781 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m11:23:32.365369 [debug] [Thread-21 ]: Timing info for model.xeneta.aggregations (execute): 11:23:31.187236 => 11:23:32.364837
[0m11:23:32.366387 [debug] [Thread-21 ]: On model.xeneta.aggregations: Close
[0m11:23:32.377479 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38a788ad-0f6f-4677-a5ef-3c39a978a4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec7ce20>]}
[0m11:23:32.378853 [info ] [Thread-21 ]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 1.21s]
[0m11:23:32.380380 [debug] [Thread-21 ]: Finished running node model.xeneta.aggregations
[0m11:23:32.383057 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:32.383860 [debug] [MainThread]: On master: BEGIN
[0m11:23:32.384642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:32.402405 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:32.403105 [debug] [MainThread]: On master: COMMIT
[0m11:23:32.403900 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:32.404445 [debug] [MainThread]: On master: COMMIT
[0m11:23:32.405187 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:32.405742 [debug] [MainThread]: On master: Close
[0m11:23:32.408778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:32.409751 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m11:23:32.410802 [info ] [MainThread]: 
[0m11:23:32.411930 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m11:23:32.413841 [debug] [MainThread]: Command end result
[0m11:23:32.429505 [info ] [MainThread]: 
[0m11:23:32.430882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:32.432355 [info ] [MainThread]: 
[0m11:23:32.433358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:32.435547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.615131, "process_user_time": 9.981356, "process_kernel_time": 1.133148, "process_mem_max_rss": "360124416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:23:32.439547 [debug] [MainThread]: Command `cli run` succeeded at 11:23:32.438840 after 1.62 seconds
[0m11:23:32.440626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae00c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec61570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec60ac0>]}
[0m11:23:32.441941 [debug] [MainThread]: Flushing usage events
[0m11:35:42.271951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103407a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fde7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fde290>]}


============================== 11:35:42.284721 | b5903e57-c2bf-4885-90d5-d6c399705f59 ==============================
[0m11:35:42.284721 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:35:42.286109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:35:42.605358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5903e57-c2bf-4885-90d5-d6c399705f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb3280>]}
[0m11:35:42.693679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5903e57-c2bf-4885-90d5-d6c399705f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d633a0>]}
[0m11:35:42.695829 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:35:42.734849 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:35:42.868744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:42.869444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:42.880377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5903e57-c2bf-4885-90d5-d6c399705f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c8280>]}
[0m11:35:42.902439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5903e57-c2bf-4885-90d5-d6c399705f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e5c00>]}
[0m11:35:42.903601 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:35:42.904386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5903e57-c2bf-4885-90d5-d6c399705f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e6980>]}
[0m11:35:42.907374 [info ] [MainThread]: 
[0m11:35:42.908858 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:35:42.912178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:35:43.017869 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:35:43.018671 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:35:43.020318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:43.074324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.077458 [debug] [ThreadPool]: On list_dev: Close
[0m11:35:43.081455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m11:35:43.083008 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m11:35:43.094486 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:43.095210 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:35:43.095781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:43.108493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.110695 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:43.111294 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m11:35:43.112024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.112576 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:43.113136 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m11:35:43.116464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.118232 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:35:43.119037 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:43.119602 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:35:43.120507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.121151 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m11:35:43.126151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_final)
[0m11:35:43.136642 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:35:43.137390 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:35:43.137943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:43.147103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.147769 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:35:43.148321 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:35:43.233946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.245789 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:35:43.249053 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:35:43.249947 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:35:43.254781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m11:35:43.258498 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:35:43.259670 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:35:43.260232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:43.270336 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.271060 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:35:43.271646 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:35:43.307409 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:43.314908 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:35:43.315547 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:35:43.315955 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:35:43.320752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5903e57-c2bf-4885-90d5-d6c399705f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105412cb0>]}
[0m11:35:43.321485 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:43.321950 [debug] [MainThread]: On master: BEGIN
[0m11:35:43.322383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:43.330590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:43.331250 [debug] [MainThread]: On master: COMMIT
[0m11:35:43.331716 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:43.332222 [debug] [MainThread]: On master: COMMIT
[0m11:35:43.332887 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:43.333383 [debug] [MainThread]: On master: Close
[0m11:35:43.335935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:43.336621 [info ] [MainThread]: 
[0m11:35:43.341078 [debug] [Thread-1 (]: Began running node model.xeneta.stg_datapoints
[0m11:35:43.342796 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main_staging.stg_datapoints ................. [RUN]
[0m11:35:43.344626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.stg_datapoints)
[0m11:35:43.345452 [debug] [Thread-1 (]: Began compiling node model.xeneta.stg_datapoints
[0m11:35:43.369226 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.stg_datapoints"
[0m11:35:43.372783 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_datapoints (compile): 11:35:43.345890 => 11:35:43.371475
[0m11:35:43.373944 [debug] [Thread-1 (]: Began executing node model.xeneta.stg_datapoints
[0m11:35:43.461208 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:35:43.461881 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

    
  
    
    

    create temporary table
      "stg_datapoints__dbt_tmp20240701113543427327"
  
    as (
      

with stg_datapoints as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Created as timestamp ) as Created,
        Cast(Origin_PID as integer ) as Origin_PID,
        Cast(Destination_PID as integer )as Destination_PID,
        Cast(Valid_From as date ) as Valid_From,
        Cast(Valid_To as date ) as Valid_To,
        Cast(Company_ID as integer ) as Company_ID,
        Cast(Supplier_ID as integer ) as Supplier_ID,
        Cast(Equipment_ID as integer ) as Equipment_ID,
        row_number() over (partition by d_id order by created )as row_num
    from raw.datapoints

    
)

select *
from stg_datapoints
where row_num = 1
    );
  
  
  
[0m11:35:43.462422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:43.494978 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:43.513675 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:35:43.515225 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: BEGIN
[0m11:35:43.516955 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:43.518270 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:35:43.519119 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_datapoints__dbt_tmp20240701113543427327'
      
      
      order by ordinal_position

  
[0m11:35:43.572860 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:43.580988 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:35:43.581688 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_datapoints'
      
      and table_schema = 'main_staging'
      
      
      and table_catalog = 'dev'
      
      order by ordinal_position

  
[0m11:35:43.598472 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:43.608442 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:35:43.609108 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_datapoints'
      
      and table_schema = 'main_staging'
      
      
      and table_catalog = 'dev'
      
      order by ordinal_position

  
[0m11:35:43.628212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:43.649553 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.stg_datapoints"
[0m11:35:43.652525 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:35:43.653449 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

        
            delete from "dev"."main_staging"."stg_datapoints"
            where (
                D_ID) in (
                select (D_ID)
                from "stg_datapoints__dbt_tmp20240701113543427327"
            );

        
    

    insert into "dev"."main_staging"."stg_datapoints" ("D_ID", "Created", "Origin_PID", "Destination_PID", "Valid_From", "Valid_To", "Company_ID", "Supplier_ID", "Equipment_ID", "row_num")
    (
        select "D_ID", "Created", "Origin_PID", "Destination_PID", "Valid_From", "Valid_To", "Company_ID", "Supplier_ID", "Equipment_ID", "row_num"
        from "stg_datapoints__dbt_tmp20240701113543427327"
    )
  
[0m11:35:43.676625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:43.701737 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: COMMIT
[0m11:35:43.702512 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m11:35:43.703104 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: COMMIT
[0m11:35:43.711773 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:43.713778 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_datapoints (execute): 11:35:43.374425 => 11:35:43.713349
[0m11:35:43.714467 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: Close
[0m11:35:43.737795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5903e57-c2bf-4885-90d5-d6c399705f59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545f400>]}
[0m11:35:43.739455 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main_staging.stg_datapoints ............ [[32mOK[0m in 0.39s]
[0m11:35:43.741145 [debug] [Thread-1 (]: Finished running node model.xeneta.stg_datapoints
[0m11:35:43.744395 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:43.745138 [debug] [MainThread]: On master: BEGIN
[0m11:35:43.745714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:43.756523 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:43.757253 [debug] [MainThread]: On master: COMMIT
[0m11:35:43.757825 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:43.758381 [debug] [MainThread]: On master: COMMIT
[0m11:35:43.759113 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:43.759701 [debug] [MainThread]: On master: Close
[0m11:35:43.762374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:43.762970 [debug] [MainThread]: Connection 'model.xeneta.stg_datapoints' was properly closed.
[0m11:35:43.763577 [info ] [MainThread]: 
[0m11:35:43.764380 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m11:35:43.765598 [debug] [MainThread]: Command end result
[0m11:35:43.783911 [info ] [MainThread]: 
[0m11:35:43.785189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:43.791575 [info ] [MainThread]: 
[0m11:35:43.797400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:35:43.801141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6400138, "process_user_time": 4.000582, "process_kernel_time": 0.362002, "process_mem_max_rss": "128184320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:35:43.808739 [debug] [MainThread]: Command `cli run` succeeded at 11:35:43.807959 after 1.65 seconds
[0m11:35:43.811198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103407a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053cad70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c8220>]}
[0m11:35:43.812465 [debug] [MainThread]: Flushing usage events
[0m11:35:44.397909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f949d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c9120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054314b0>]}


============================== 11:35:44.399502 | 1060d211-4aea-46f5-a708-6dfd3c6b3867 ==============================
[0m11:35:44.399502 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:35:44.401579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:35:44.461934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1060d211-4aea-46f5-a708-6dfd3c6b3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f37e20>]}
[0m11:35:44.465613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1060d211-4aea-46f5-a708-6dfd3c6b3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054314b0>]}
[0m11:35:44.467388 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:35:44.483675 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:35:44.564406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:44.565071 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:44.574456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1060d211-4aea-46f5-a708-6dfd3c6b3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c516c0>]}
[0m11:35:44.668730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1060d211-4aea-46f5-a708-6dfd3c6b3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546aa40>]}
[0m11:35:44.669722 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:35:44.670632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1060d211-4aea-46f5-a708-6dfd3c6b3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105469720>]}
[0m11:35:44.672231 [info ] [MainThread]: 
[0m11:35:44.673816 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:35:44.675879 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:35:44.684562 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:35:44.689878 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:35:44.691590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:44.709255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.711934 [debug] [ThreadPool]: On list_dev: Close
[0m11:35:44.717472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m11:35:44.719839 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m11:35:44.724272 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:44.725005 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:35:44.725585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:44.735598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.737974 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:44.738606 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m11:35:44.739340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.739898 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:44.740456 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m11:35:44.741309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.742724 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:35:44.743309 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m11:35:44.743860 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m11:35:44.744616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.745191 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m11:35:44.749931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_final)
[0m11:35:44.753885 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:35:44.754526 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:35:44.755044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:44.763735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.764408 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:35:44.764970 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:35:44.803412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.810606 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:35:44.811246 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:35:44.811667 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:35:44.815269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m11:35:44.818925 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:35:44.819510 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:35:44.819975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:44.827786 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.828420 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:35:44.828917 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:35:44.862393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:44.869467 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:35:44.870058 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:35:44.870431 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:35:44.874998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1060d211-4aea-46f5-a708-6dfd3c6b3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545dd80>]}
[0m11:35:44.875677 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:44.876136 [debug] [MainThread]: On master: BEGIN
[0m11:35:44.876552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:44.885041 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:44.885697 [debug] [MainThread]: On master: COMMIT
[0m11:35:44.886179 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:44.886633 [debug] [MainThread]: On master: COMMIT
[0m11:35:44.887214 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:44.887697 [debug] [MainThread]: On master: Close
[0m11:35:44.890305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:44.891224 [info ] [MainThread]: 
[0m11:35:44.892862 [debug] [Thread-5 (]: Began running node model.xeneta.stg_charges
[0m11:35:44.893647 [info ] [Thread-5 (]: 1 of 1 START sql incremental model main_staging.stg_charges .................... [RUN]
[0m11:35:44.894705 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.stg_charges)
[0m11:35:44.895354 [debug] [Thread-5 (]: Began compiling node model.xeneta.stg_charges
[0m11:35:44.901785 [debug] [Thread-5 (]: Writing injected SQL for node "model.xeneta.stg_charges"
[0m11:35:44.906923 [debug] [Thread-5 (]: Timing info for model.xeneta.stg_charges (compile): 11:35:44.896492 => 11:35:44.906141
[0m11:35:44.908197 [debug] [Thread-5 (]: Began executing node model.xeneta.stg_charges
[0m11:35:44.945882 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:44.946714 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */
DESCRIBE (select * from (
        

with stg_charges as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Currency as char(3) ) as Currency,
        Cast(Charge_Value as integer ) as Charge_Value,
        row_number() over (partition by d_id, currency order by Charge_Value )as row_num
    from raw.charges
    
    
)

select *
from stg_charges
where row_num = 1
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:35:44.947385 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m11:35:44.959518 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:44.973922 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:44.974641 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */
DESCRIBE (select * from (
        select
    
      cast(null as integer) as D_ID, 
      cast(null as char(3)) as Currency, 
      cast(null as integer) as Charge_Value, 
      cast(null as BIGINT) as row_num
    ) as __dbt_sbq
    where false
    limit 0
)
[0m11:35:44.975773 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:44.985142 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:44.985907 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */

    
  
    
    
      
    

    create temporary table
      "stg_charges__dbt_tmp20240701113544914851"
  
    as (
      

with stg_charges as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Currency as char(3) ) as Currency,
        Cast(Charge_Value as integer ) as Charge_Value,
        row_number() over (partition by d_id, currency order by Charge_Value )as row_num
    from raw.charges
    
    
)

select *
from stg_charges
where row_num = 1
    );
  
  
  
[0m11:35:44.994685 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:44.999220 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:44.999864 [debug] [Thread-5 (]: On model.xeneta.stg_charges: BEGIN
[0m11:35:45.000709 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:45.001307 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:45.001880 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_charges__dbt_tmp20240701113544914851'
      
      
      order by ordinal_position

  
[0m11:35:45.057504 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:45.061744 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:45.062356 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_charges'
      
      and table_schema = 'main_staging'
      
      
      and table_catalog = 'dev'
      
      order by ordinal_position

  
[0m11:35:45.077639 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:45.088209 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:45.088854 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_charges__dbt_tmp20240701113544914851'
      
      
      order by ordinal_position

  
[0m11:35:45.105790 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:45.109972 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:45.110580 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_charges'
      
      and table_schema = 'main_staging'
      
      
      and table_catalog = 'dev'
      
      order by ordinal_position

  
[0m11:35:45.126252 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:45.136655 [debug] [Thread-5 (]: 
    In "dev"."main_staging"."stg_charges":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:35:45.138711 [debug] [Thread-5 (]: Writing runtime sql for node "model.xeneta.stg_charges"
[0m11:35:45.139633 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:45.140201 [debug] [Thread-5 (]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */


    insert into "dev"."main_staging"."stg_charges" ("D_ID", "Currency", "Charge_Value", "row_num")
    (
        select "D_ID", "Currency", "Charge_Value", "row_num"
        from "stg_charges__dbt_tmp20240701113544914851"
    )
  
[0m11:35:45.142397 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:45.145119 [debug] [Thread-5 (]: On model.xeneta.stg_charges: COMMIT
[0m11:35:45.145692 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_charges"
[0m11:35:45.146174 [debug] [Thread-5 (]: On model.xeneta.stg_charges: COMMIT
[0m11:35:45.150424 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m11:35:45.152267 [debug] [Thread-5 (]: Timing info for model.xeneta.stg_charges (execute): 11:35:44.908971 => 11:35:45.151919
[0m11:35:45.152880 [debug] [Thread-5 (]: On model.xeneta.stg_charges: Close
[0m11:35:45.169643 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1060d211-4aea-46f5-a708-6dfd3c6b3867', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a0f10>]}
[0m11:35:45.170841 [info ] [Thread-5 (]: 1 of 1 OK created sql incremental model main_staging.stg_charges ............... [[32mOK[0m in 0.28s]
[0m11:35:45.171940 [debug] [Thread-5 (]: Finished running node model.xeneta.stg_charges
[0m11:35:45.174000 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:45.174618 [debug] [MainThread]: On master: BEGIN
[0m11:35:45.175144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:45.189596 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:45.190905 [debug] [MainThread]: On master: COMMIT
[0m11:35:45.192041 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:45.192835 [debug] [MainThread]: On master: COMMIT
[0m11:35:45.193743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:45.194885 [debug] [MainThread]: On master: Close
[0m11:35:45.198035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:45.198769 [debug] [MainThread]: Connection 'model.xeneta.stg_charges' was properly closed.
[0m11:35:45.199524 [info ] [MainThread]: 
[0m11:35:45.200549 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m11:35:45.201816 [debug] [MainThread]: Command end result
[0m11:35:45.222320 [info ] [MainThread]: 
[0m11:35:45.224720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:45.226768 [info ] [MainThread]: 
[0m11:35:45.230017 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:35:45.231612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.83991414, "process_user_time": 4.789998, "process_kernel_time": 0.456826, "process_mem_max_rss": "133398528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:35:45.232997 [debug] [MainThread]: Command `cli run` succeeded at 11:35:45.232753 after 0.84 seconds
[0m11:35:45.233664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f949d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ea800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105480400>]}
[0m11:35:45.234360 [debug] [MainThread]: Flushing usage events
[0m11:35:45.709736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10340fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ddff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105405120>]}


============================== 11:35:45.710697 | 4d8def44-bd49-4f69-b63e-ad593e3f0559 ==============================
[0m11:35:45.710697 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:35:45.711730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:35:45.738178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d8def44-bd49-4f69-b63e-ad593e3f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d633a0>]}
[0m11:35:45.741667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d8def44-bd49-4f69-b63e-ad593e3f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054067d0>]}
[0m11:35:45.742779 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:35:45.759251 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:35:45.820795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:45.821387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:45.829143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d8def44-bd49-4f69-b63e-ad593e3f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c58cd0>]}
[0m11:35:45.841295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d8def44-bd49-4f69-b63e-ad593e3f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105432740>]}
[0m11:35:45.842052 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 394 macros, 0 groups, 0 semantic models
[0m11:35:45.842704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8def44-bd49-4f69-b63e-ad593e3f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105433460>]}
[0m11:35:45.843879 [info ] [MainThread]: 
[0m11:35:45.845020 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:35:45.846301 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:35:45.851165 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:35:45.854433 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:35:45.856414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:45.873744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.876388 [debug] [ThreadPool]: On list_dev: Close
[0m11:35:45.880249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m11:35:45.881483 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m11:35:45.887345 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:35:45.888434 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:35:45.889463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:45.900094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.903720 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:35:45.904447 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m11:35:45.905693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.906429 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:35:45.907045 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m11:35:45.908050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.909767 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:35:45.910381 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:35:45.911038 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:35:45.911829 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.912438 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m11:35:45.917315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m11:35:45.922488 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:35:45.923187 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:35:45.923731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:45.932559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.933212 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:35:45.933759 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:35:45.969862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.977707 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:35:45.978361 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:35:45.978766 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:35:45.982486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m11:35:45.985988 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:35:45.986520 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:35:45.986959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:45.994539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:45.995158 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:35:45.995633 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:35:46.032298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:46.039323 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:35:46.039917 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:35:46.040317 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:35:46.045063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d8def44-bd49-4f69-b63e-ad593e3f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c4f5b0>]}
[0m11:35:46.045769 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:46.046231 [debug] [MainThread]: On master: BEGIN
[0m11:35:46.046658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:46.055207 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:46.055804 [debug] [MainThread]: On master: COMMIT
[0m11:35:46.056279 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:46.056731 [debug] [MainThread]: On master: COMMIT
[0m11:35:46.057305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:46.057767 [debug] [MainThread]: On master: Close
[0m11:35:46.060078 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:46.060722 [info ] [MainThread]: 
[0m11:35:46.062187 [debug] [Thread-9 (]: Began running node model.xeneta.aggregations
[0m11:35:46.062918 [info ] [Thread-9 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m11:35:46.063928 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m11:35:46.064525 [debug] [Thread-9 (]: Began compiling node model.xeneta.aggregations
[0m11:35:46.074255 [debug] [Thread-9 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m11:35:46.076248 [debug] [Thread-9 (]: Timing info for model.xeneta.aggregations (compile): 11:35:46.064889 => 11:35:46.075476
[0m11:35:46.077907 [debug] [Thread-9 (]: Began executing node model.xeneta.aggregations
[0m11:35:46.102443 [debug] [Thread-9 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m11:35:46.104627 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:35:46.105489 [debug] [Thread-9 (]: On model.xeneta.aggregations: BEGIN
[0m11:35:46.106146 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m11:35:46.116364 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:35:46.117123 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:35:46.117943 [debug] [Thread-9 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m11:35:47.574049 [debug] [Thread-9 (]: SQL status: OK in 1.0 seconds
[0m11:35:47.584301 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:35:47.585052 [debug] [Thread-9 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m11:35:47.588414 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:35:47.593363 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:35:47.594032 [debug] [Thread-9 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m11:35:47.594980 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:35:47.611193 [debug] [Thread-9 (]: On model.xeneta.aggregations: COMMIT
[0m11:35:47.612329 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:35:47.613374 [debug] [Thread-9 (]: On model.xeneta.aggregations: COMMIT
[0m11:35:47.699235 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:35:47.711914 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:35:47.712937 [debug] [Thread-9 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m11:35:47.715105 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m11:35:47.718399 [debug] [Thread-9 (]: Timing info for model.xeneta.aggregations (execute): 11:35:46.078630 => 11:35:47.717838
[0m11:35:47.719206 [debug] [Thread-9 (]: On model.xeneta.aggregations: Close
[0m11:35:47.728343 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d8def44-bd49-4f69-b63e-ad593e3f0559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c6fe50>]}
[0m11:35:47.729399 [info ] [Thread-9 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 1.66s]
[0m11:35:47.730409 [debug] [Thread-9 (]: Finished running node model.xeneta.aggregations
[0m11:35:47.732334 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:47.732906 [debug] [MainThread]: On master: BEGIN
[0m11:35:47.733437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:47.746118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:47.747138 [debug] [MainThread]: On master: COMMIT
[0m11:35:47.748491 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:47.749944 [debug] [MainThread]: On master: COMMIT
[0m11:35:47.751584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:47.752818 [debug] [MainThread]: On master: Close
[0m11:35:47.757784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:47.758463 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m11:35:47.759073 [info ] [MainThread]: 
[0m11:35:47.759877 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m11:35:47.761084 [debug] [MainThread]: Command end result
[0m11:35:47.782640 [info ] [MainThread]: 
[0m11:35:47.783544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:47.784237 [info ] [MainThread]: 
[0m11:35:47.785163 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:35:47.788007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0805874, "process_user_time": 7.998506, "process_kernel_time": 0.955589, "process_mem_max_rss": "379248640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:35:47.790572 [debug] [MainThread]: Command `cli run` succeeded at 11:35:47.790103 after 2.08 seconds
[0m11:35:47.791352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10340fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f37f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8b730>]}
[0m11:35:47.792105 [debug] [MainThread]: Flushing usage events
[0m11:55:33.411914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f33c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f33970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f33b50>]}


============================== 11:55:33.422213 | a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df ==============================
[0m11:55:33.422213 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:55:33.423635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'profiles_dir': '/Users/haidersultan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:34.057046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f33a30>]}
[0m11:55:34.217416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111149de0>]}
[0m11:55:34.219975 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:55:34.259787 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:55:34.395830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m11:55:34.396699 [debug] [MainThread]: Partial parsing: added file: xeneta://macros/generate_count.sql
[0m11:55:34.397254 [debug] [MainThread]: Partial parsing: added file: xeneta://macros/generate_schema_name.sql
[0m11:55:34.397858 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/final/aggregations.sql
[0m11:55:34.401618 [info ] [MainThread]: Unable to do partial parsing because change detected to override macro. Starting full parse.
[0m11:55:35.678880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f1b40>]}
[0m11:55:35.701034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f2560>]}
[0m11:55:35.701884 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 395 macros, 0 groups, 0 semantic models
[0m11:55:35.702642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f32b0>]}
[0m11:55:35.705356 [info ] [MainThread]: 
[0m11:55:35.706728 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:55:35.709065 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:55:35.738447 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:55:35.739745 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:55:35.740507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:35.778270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.782810 [debug] [ThreadPool]: On list_dev: Close
[0m11:55:35.788703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m11:55:35.789981 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m11:55:35.800814 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:55:35.801600 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:55:35.802181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:35.812172 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.814207 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:55:35.814769 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m11:55:35.815435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.815951 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:55:35.816476 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m11:55:35.818119 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.819715 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:55:35.820286 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:55:35.820812 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:55:35.821555 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.822105 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m11:55:35.826622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m11:55:35.836288 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:55:35.836997 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:55:35.837523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:35.845635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.846286 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:55:35.846827 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:55:35.914057 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.923050 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:55:35.926160 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:55:35.927048 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:55:35.931133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:55:35.936435 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:55:35.937056 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:55:35.937563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:35.945746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.946419 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:55:35.946941 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:55:35.982098 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:35.989620 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:55:35.990269 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:55:35.990702 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:55:35.994291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d7d00>]}
[0m11:55:35.994999 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:35.995460 [debug] [MainThread]: On master: BEGIN
[0m11:55:35.995886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:36.003176 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:36.003795 [debug] [MainThread]: On master: COMMIT
[0m11:55:36.004268 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:36.004704 [debug] [MainThread]: On master: COMMIT
[0m11:55:36.005288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:36.005755 [debug] [MainThread]: On master: Close
[0m11:55:36.008013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:36.008704 [info ] [MainThread]: 
[0m11:55:36.013918 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m11:55:36.015632 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m11:55:36.017208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m11:55:36.018316 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m11:55:36.043596 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m11:55:36.046425 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 11:55:36.018784 => 11:55:36.045861
[0m11:55:36.047252 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m11:55:36.107310 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 11:55:36.047792 => 11:55:36.106745
[0m11:55:36.127693 [debug] [Thread-1 (]: Compilation Error in model aggregations (models/final/aggregations.sql)
  'generate_count' is undefined
  
  > in macro run_hooks (macros/materializations/hooks.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model aggregations (models/final/aggregations.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:36.128687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1e5efdd-5f7c-47d4-a86c-b9dd83d9d2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f2e60>]}
[0m11:55:36.129769 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_final.aggregations .................. [[31mERROR[0m in 0.11s]
[0m11:55:36.130991 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m11:55:36.134039 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:36.134803 [debug] [MainThread]: On master: BEGIN
[0m11:55:36.135404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:36.147400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:36.148431 [debug] [MainThread]: On master: COMMIT
[0m11:55:36.149716 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:36.151261 [debug] [MainThread]: On master: COMMIT
[0m11:55:36.155945 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:36.157090 [debug] [MainThread]: On master: Close
[0m11:55:36.159933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:36.160569 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m11:55:36.161301 [info ] [MainThread]: 
[0m11:55:36.162162 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:55:36.164128 [debug] [MainThread]: Command end result
[0m11:55:36.181831 [info ] [MainThread]: 
[0m11:55:36.183449 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:36.185334 [info ] [MainThread]: 
[0m11:55:36.187020 [error] [MainThread]:   Compilation Error in model aggregations (models/final/aggregations.sql)
  'generate_count' is undefined
  
  > in macro run_hooks (macros/materializations/hooks.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model aggregations (models/final/aggregations.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:36.192437 [info ] [MainThread]: 
[0m11:55:36.194753 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:36.201721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.899934, "process_user_time": 5.467761, "process_kernel_time": 0.776828, "process_mem_max_rss": "124289024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:36.205283 [debug] [MainThread]: Command `dbt run` failed at 11:55:36.204576 after 2.90 seconds
[0m11:55:36.207698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f33c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f3df0>]}
[0m11:55:36.209630 [debug] [MainThread]: Flushing usage events
[0m11:58:02.885789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110135660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c638e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c63ac0>]}


============================== 11:58:02.892474 | 511d2a7f-cc43-45b7-a8b7-bae8a7a7f000 ==============================
[0m11:58:02.892474 [info ] [MainThread]: Running with dbt=1.7.17
[0m11:58:02.893629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select aggregations.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:58:03.169043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '511d2a7f-cc43-45b7-a8b7-bae8a7a7f000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c639a0>]}
[0m11:58:03.242843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '511d2a7f-cc43-45b7-a8b7-bae8a7a7f000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce9a50>]}
[0m11:58:03.243885 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m11:58:03.278748 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m11:58:03.341628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:03.342518 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m11:58:03.361313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '511d2a7f-cc43-45b7-a8b7-bae8a7a7f000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11209bd60>]}
[0m11:58:03.379242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '511d2a7f-cc43-45b7-a8b7-bae8a7a7f000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f91b40>]}
[0m11:58:03.380044 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m11:58:03.380688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '511d2a7f-cc43-45b7-a8b7-bae8a7a7f000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f928c0>]}
[0m11:58:03.383889 [info ] [MainThread]: 
[0m11:58:03.385278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:58:03.387606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:58:03.408501 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:58:03.410318 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:58:03.413004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:03.431866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.434849 [debug] [ThreadPool]: On list_dev: Close
[0m11:58:03.443893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m11:58:03.445837 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m11:58:03.460147 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:58:03.461639 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:58:03.462834 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:03.473969 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.476471 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:58:03.477134 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m11:58:03.477882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.478445 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:58:03.479008 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m11:58:03.479818 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.481275 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:58:03.481871 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m11:58:03.482427 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m11:58:03.483242 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.483875 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m11:58:03.488980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m11:58:03.498551 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:58:03.499285 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m11:58:03.500095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:03.509646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.510349 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m11:58:03.510920 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m11:58:03.546952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.554409 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m11:58:03.555322 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m11:58:03.555751 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m11:58:03.559172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m11:58:03.563375 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:58:03.563895 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m11:58:03.564330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:58:03.571778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.572391 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m11:58:03.572858 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m11:58:03.603733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:58:03.610696 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m11:58:03.611273 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m11:58:03.611647 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m11:58:03.615061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '511d2a7f-cc43-45b7-a8b7-bae8a7a7f000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d67a0>]}
[0m11:58:03.615712 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:03.616129 [debug] [MainThread]: On master: BEGIN
[0m11:58:03.616538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:58:03.623398 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:03.623998 [debug] [MainThread]: On master: COMMIT
[0m11:58:03.624540 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:03.625019 [debug] [MainThread]: On master: COMMIT
[0m11:58:03.625633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:03.626092 [debug] [MainThread]: On master: Close
[0m11:58:03.628232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:03.628972 [info ] [MainThread]: 
[0m11:58:03.632150 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m11:58:03.632926 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m11:58:03.634727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m11:58:03.635993 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m11:58:03.655291 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m11:58:03.656673 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 11:58:03.636557 => 11:58:03.656236
[0m11:58:03.657334 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m11:58:03.705855 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:58:03.706553 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m11:58:03.707073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:58:03.714424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:03.715077 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:58:03.715618 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
  from main_final.aggregations              
  WHERE dq_ok ='True'
  group by 1,2,3,4,5
  order by count desc
      
[0m11:58:03.771462 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:03.787105 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m11:58:03.788606 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:58:03.789403 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m11:58:05.264951 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m11:58:05.274758 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:58:05.275478 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m11:58:05.286105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:05.293814 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:58:05.295098 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m11:58:05.296836 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:05.328512 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m11:58:05.329223 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:58:05.329758 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m11:58:05.423302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:05.430173 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m11:58:05.430792 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m11:58:05.436703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:58:05.442351 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 11:58:03.657742 => 11:58:05.441659
[0m11:58:05.443644 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m11:58:05.468324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '511d2a7f-cc43-45b7-a8b7-bae8a7a7f000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213b850>]}
[0m11:58:05.469942 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 1.83s]
[0m11:58:05.471765 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m11:58:05.474192 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:05.474984 [debug] [MainThread]: On master: BEGIN
[0m11:58:05.475816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:58:05.496873 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:05.499002 [debug] [MainThread]: On master: COMMIT
[0m11:58:05.501211 [debug] [MainThread]: Using duckdb connection "master"
[0m11:58:05.502839 [debug] [MainThread]: On master: COMMIT
[0m11:58:05.503913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:58:05.504891 [debug] [MainThread]: On master: Close
[0m11:58:05.508960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:05.510364 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m11:58:05.511501 [info ] [MainThread]: 
[0m11:58:05.512592 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m11:58:05.514100 [debug] [MainThread]: Command end result
[0m11:58:05.533282 [info ] [MainThread]: 
[0m11:58:05.537508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:05.538943 [info ] [MainThread]: 
[0m11:58:05.541010 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:58:05.549117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.753885, "process_user_time": 6.265437, "process_kernel_time": 0.813078, "process_mem_max_rss": "374755328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:58:05.553184 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:05.552719 after 2.76 seconds
[0m11:58:05.554608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110135660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112098250>]}
[0m11:58:05.556761 [debug] [MainThread]: Flushing usage events
[0m12:04:40.896849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8c5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b7af0>]}


============================== 12:04:40.907504 | d5bc55bf-95e2-4c9d-8fb1-86ac913c31d5 ==============================
[0m12:04:40.907504 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:04:40.909067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select aggregations.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:04:41.693532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5bc55bf-95e2-4c9d-8fb1-86ac913c31d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b79d0>]}
[0m12:04:41.788903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5bc55bf-95e2-4c9d-8fb1-86ac913c31d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11053d6f0>]}
[0m12:04:41.791052 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:04:41.832297 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:04:41.951436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:41.952235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:41.967564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5bc55bf-95e2-4c9d-8fb1-86ac913c31d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c83d0>]}
[0m12:04:41.997177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5bc55bf-95e2-4c9d-8fb1-86ac913c31d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f5c90>]}
[0m12:04:41.998014 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:04:41.998763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5bc55bf-95e2-4c9d-8fb1-86ac913c31d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f6a10>]}
[0m12:04:42.001712 [info ] [MainThread]: 
[0m12:04:42.003253 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:04:42.014390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:04:42.050928 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:04:42.051719 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:04:42.052443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:42.139329 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.143683 [debug] [ThreadPool]: On list_dev: Close
[0m12:04:42.149210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:04:42.151202 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:04:42.165097 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:04:42.165893 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:04:42.166487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:42.176853 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.179238 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:04:42.179827 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:04:42.180549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.181086 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:04:42.181632 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:04:42.186595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.188419 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:04:42.189063 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:04:42.189634 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:04:42.190470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.191076 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:04:42.195839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:04:42.205877 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:04:42.206627 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:04:42.207184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:42.215631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.216317 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:04:42.216895 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:04:42.298876 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.309619 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:04:42.312737 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:04:42.313634 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:04:42.317857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:04:42.322945 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:04:42.323617 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:04:42.324153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:42.333464 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.334154 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:04:42.334689 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:04:42.378297 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:42.379987 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:04:42.380561 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:04:42.380982 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:04:42.384530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5bc55bf-95e2-4c9d-8fb1-86ac913c31d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110912830>]}
[0m12:04:42.385306 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:42.385784 [debug] [MainThread]: On master: BEGIN
[0m12:04:42.386244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:42.393400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:42.394024 [debug] [MainThread]: On master: COMMIT
[0m12:04:42.394496 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:42.394930 [debug] [MainThread]: On master: COMMIT
[0m12:04:42.395510 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:42.395974 [debug] [MainThread]: On master: Close
[0m12:04:42.398184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:04:42.398901 [info ] [MainThread]: 
[0m12:04:42.403819 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:04:42.405780 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:04:42.407755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:04:42.408595 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:04:42.436093 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:04:42.439778 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:04:42.409056 => 12:04:42.439118
[0m12:04:42.440711 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:04:42.506628 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:04:42.507804 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:04:42.508447 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:04:42.509022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:42.517647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:42.518344 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:04:42.519137 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:04:44.013626 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m12:04:44.022868 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:04:44.023595 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:04:44.028903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.065000 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:04:44.065743 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:04:44.066307 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:04:44.157590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.165573 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:04:44.166278 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:04:44.168590 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.171226 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:04:42.441234 => 12:04:44.170861
[0m12:04:44.171900 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:04:44.185051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5bc55bf-95e2-4c9d-8fb1-86ac913c31d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109824d0>]}
[0m12:04:44.187151 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 1.78s]
[0m12:04:44.188737 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:04:44.191766 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:44.192473 [debug] [MainThread]: On master: BEGIN
[0m12:04:44.193038 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:44.203677 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:44.204411 [debug] [MainThread]: On master: COMMIT
[0m12:04:44.204990 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:44.205539 [debug] [MainThread]: On master: COMMIT
[0m12:04:44.206237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:44.206819 [debug] [MainThread]: On master: Close
[0m12:04:44.209344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:44.209925 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:04:44.210520 [info ] [MainThread]: 
[0m12:04:44.211314 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m12:04:44.212527 [debug] [MainThread]: Command end result
[0m12:04:44.236065 [info ] [MainThread]: 
[0m12:04:44.237488 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:44.239104 [info ] [MainThread]: 
[0m12:04:44.240578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:04:44.245382 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.4608798, "process_user_time": 7.340122, "process_kernel_time": 1.280079, "process_mem_max_rss": "371081216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:04:44.246984 [debug] [MainThread]: Command `dbt run` succeeded at 12:04:44.246691 after 3.46 seconds
[0m12:04:44.248638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8c5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109667d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110965570>]}
[0m12:04:44.252057 [debug] [MainThread]: Flushing usage events
[0m12:07:05.704672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8adc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3db8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3dba90>]}


============================== 12:07:05.710907 | 706462e9-fc05-456e-bd3c-f6c2191f8bc0 ==============================
[0m12:07:05.710907 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:07:05.712019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_datapoints.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:07:05.984375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '706462e9-fc05-456e-bd3c-f6c2191f8bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3db970>]}
[0m12:07:06.061925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '706462e9-fc05-456e-bd3c-f6c2191f8bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4638e0>]}
[0m12:07:06.063047 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:07:06.094629 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:07:06.171223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:06.172161 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/staging/stg_datapoints.sql
[0m12:07:06.365332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '706462e9-fc05-456e-bd3c-f6c2191f8bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9297e0>]}
[0m12:07:06.383240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '706462e9-fc05-456e-bd3c-f6c2191f8bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c709b40>]}
[0m12:07:06.384194 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:07:06.385065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '706462e9-fc05-456e-bd3c-f6c2191f8bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70a950>]}
[0m12:07:06.389382 [info ] [MainThread]: 
[0m12:07:06.391789 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:07:06.394367 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:07:06.423415 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:07:06.424207 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:07:06.424875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:06.446178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:06.446873 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:07:06.447482 [info ] [MainThread]: 
[0m12:07:06.448444 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:07:06.449395 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:07:06.451679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8263507, "process_user_time": 3.54764, "process_kernel_time": 0.423464, "process_mem_max_rss": "114360320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:07:06.452815 [debug] [MainThread]: Command `dbt run` failed at 12:07:06.452567 after 0.83 seconds
[0m12:07:06.453537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8adc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c96bd30>]}
[0m12:07:06.454880 [debug] [MainThread]: Flushing usage events
[0m12:07:17.676931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d165c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec238b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec23a90>]}


============================== 12:07:17.682991 | fb4d0492-b102-4872-8b9f-9916faa14553 ==============================
[0m12:07:17.682991 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:07:17.684071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_datapoints.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:07:17.974117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb4d0492-b102-4872-8b9f-9916faa14553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec23970>]}
[0m12:07:18.049418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb4d0492-b102-4872-8b9f-9916faa14553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca38e0>]}
[0m12:07:18.050512 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:07:18.081431 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:07:18.144212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:18.144778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:18.153230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb4d0492-b102-4872-8b9f-9916faa14553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f024370>]}
[0m12:07:18.168219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb4d0492-b102-4872-8b9f-9916faa14553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef41b70>]}
[0m12:07:18.168953 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:07:18.169650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb4d0492-b102-4872-8b9f-9916faa14553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef428f0>]}
[0m12:07:18.172137 [info ] [MainThread]: 
[0m12:07:18.173989 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:07:18.177349 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:07:18.204471 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:07:18.205287 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:07:18.205958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:18.219865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.222518 [debug] [ThreadPool]: On list_dev: Close
[0m12:07:18.226967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m12:07:18.228534 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m12:07:18.240214 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:18.240867 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:07:18.241375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:18.250183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.252073 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:18.252593 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m12:07:18.253213 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.253703 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:18.254619 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m12:07:18.255821 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.257159 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:07:18.257688 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:18.258175 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:07:18.258949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.259536 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m12:07:18.264042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_final)
[0m12:07:18.272407 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:07:18.273028 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:07:18.273508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:18.281542 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.282167 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:07:18.282666 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:07:18.317859 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.325119 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:07:18.326006 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:07:18.326443 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:07:18.329888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:07:18.333290 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:07:18.333824 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:07:18.334285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:18.341927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.342541 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:07:18.343012 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:07:18.373950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:18.381348 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:07:18.381991 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:07:18.382369 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:07:18.386315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb4d0492-b102-4872-8b9f-9916faa14553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0667d0>]}
[0m12:07:18.386989 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:18.387405 [debug] [MainThread]: On master: BEGIN
[0m12:07:18.387794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:18.394472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:18.395484 [debug] [MainThread]: On master: COMMIT
[0m12:07:18.396455 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:18.396930 [debug] [MainThread]: On master: COMMIT
[0m12:07:18.397565 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:18.398046 [debug] [MainThread]: On master: Close
[0m12:07:18.400341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:18.401163 [info ] [MainThread]: 
[0m12:07:18.404137 [debug] [Thread-1 (]: Began running node model.xeneta.stg_datapoints
[0m12:07:18.404980 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main_staging.stg_datapoints ................. [RUN]
[0m12:07:18.407053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.stg_datapoints)
[0m12:07:18.407972 [debug] [Thread-1 (]: Began compiling node model.xeneta.stg_datapoints
[0m12:07:18.425194 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.stg_datapoints"
[0m12:07:18.427918 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_datapoints (compile): 12:07:18.408445 => 12:07:18.427224
[0m12:07:18.429067 [debug] [Thread-1 (]: Began executing node model.xeneta.stg_datapoints
[0m12:07:18.508179 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.stg_datapoints"
[0m12:07:18.509156 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:18.509675 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: BEGIN
[0m12:07:18.510131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:18.517364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:18.518212 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:18.518797 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

  
    
    

    create  table
      "dev"."main_staging"."stg_datapoints"
  
    as (
      

with stg_datapoints as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Created as timestamp ) as Created,
        Cast(Origin_PID as integer ) as Origin_PID,
        Cast(Destination_PID as integer )as Destination_PID,
        Cast(Valid_From as date ) as Valid_From,
        Cast(Valid_To as date ) as Valid_To,
        Cast(Company_ID as integer ) as Company_ID,
        Cast(Supplier_ID as integer ) as Supplier_ID,
        Cast(Equipment_ID as integer ) as Equipment_ID,
        row_number() over (partition by d_id order by created )as row_num
    from raw.datapoints

    
)

select *
from stg_datapoints
where row_num = 1
    );
  
  
  
[0m12:07:18.536221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:18.562498 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: COMMIT
[0m12:07:18.563205 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:18.563734 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: COMMIT
[0m12:07:18.566517 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:18.568354 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_datapoints (execute): 12:07:18.429564 => 12:07:18.568015
[0m12:07:18.568946 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: Close
[0m12:07:18.578711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb4d0492-b102-4872-8b9f-9916faa14553', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f066b90>]}
[0m12:07:18.579814 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main_staging.stg_datapoints ............ [[32mOK[0m in 0.17s]
[0m12:07:18.580832 [debug] [Thread-1 (]: Finished running node model.xeneta.stg_datapoints
[0m12:07:18.582688 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:18.583259 [debug] [MainThread]: On master: BEGIN
[0m12:07:18.583753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:18.593754 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:18.594648 [debug] [MainThread]: On master: COMMIT
[0m12:07:18.595474 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:18.596332 [debug] [MainThread]: On master: COMMIT
[0m12:07:18.597493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:18.599937 [debug] [MainThread]: On master: Close
[0m12:07:18.604646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:18.605335 [debug] [MainThread]: Connection 'model.xeneta.stg_datapoints' was properly closed.
[0m12:07:18.605943 [info ] [MainThread]: 
[0m12:07:18.606637 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:07:18.607836 [debug] [MainThread]: Command end result
[0m12:07:18.626296 [info ] [MainThread]: 
[0m12:07:18.628130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:18.629500 [info ] [MainThread]: 
[0m12:07:18.631113 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:07:18.636969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0418099, "process_user_time": 3.491249, "process_kernel_time": 0.283939, "process_mem_max_rss": "125603840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:07:18.638182 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:18.637935 after 1.04 seconds
[0m12:07:18.638934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d165c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f066a40>]}
[0m12:07:18.639643 [debug] [MainThread]: Flushing usage events
[0m12:07:57.553026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd7af0>]}


============================== 12:07:57.559032 | 67a61875-afda-4187-8a74-68747c254bd5 ==============================
[0m12:07:57.559032 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:07:57.560139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_datapoints.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:07:58.038843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67a61875-afda-4187-8a74-68747c254bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd79d0>]}
[0m12:07:58.128601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67a61875-afda-4187-8a74-68747c254bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11205d6f0>]}
[0m12:07:58.129770 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:07:58.171050 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:07:58.235588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:58.236188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:58.244798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67a61875-afda-4187-8a74-68747c254bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123ec3d0>]}
[0m12:07:58.260138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67a61875-afda-4187-8a74-68747c254bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112305c90>]}
[0m12:07:58.260914 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:07:58.261623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a61875-afda-4187-8a74-68747c254bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112306a10>]}
[0m12:07:58.264342 [info ] [MainThread]: 
[0m12:07:58.265832 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:07:58.267443 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:07:58.294050 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:07:58.295216 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:07:58.295916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:58.311902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.315139 [debug] [ThreadPool]: On list_dev: Close
[0m12:07:58.319270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m12:07:58.320806 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m12:07:58.332979 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:58.333682 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:07:58.334239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:58.343243 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.345192 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:58.345773 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m12:07:58.346499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.347013 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:58.347513 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m12:07:58.348416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.349741 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:07:58.350275 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:07:58.350768 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:07:58.351437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.351949 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m12:07:58.356245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m12:07:58.364481 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:07:58.365159 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:07:58.365653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:58.373077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.373684 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:07:58.374180 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:07:58.410694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.418445 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:07:58.419382 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:07:58.419821 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:07:58.423328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:07:58.427602 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:07:58.428126 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:07:58.428562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:58.436094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.436735 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:07:58.437227 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:07:58.468419 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:07:58.475785 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:07:58.476368 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:07:58.476741 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:07:58.480080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67a61875-afda-4187-8a74-68747c254bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112432830>]}
[0m12:07:58.480737 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:58.481155 [debug] [MainThread]: On master: BEGIN
[0m12:07:58.481609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:58.489696 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:58.490335 [debug] [MainThread]: On master: COMMIT
[0m12:07:58.490783 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:58.491215 [debug] [MainThread]: On master: COMMIT
[0m12:07:58.491797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:58.492257 [debug] [MainThread]: On master: Close
[0m12:07:58.494572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:07:58.495189 [info ] [MainThread]: 
[0m12:07:58.498130 [debug] [Thread-1 (]: Began running node model.xeneta.stg_datapoints
[0m12:07:58.498958 [info ] [Thread-1 (]: 1 of 1 START sql incremental model main_staging.stg_datapoints ................. [RUN]
[0m12:07:58.500965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_datapoints)
[0m12:07:58.502125 [debug] [Thread-1 (]: Began compiling node model.xeneta.stg_datapoints
[0m12:07:58.523629 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.stg_datapoints"
[0m12:07:58.525250 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_datapoints (compile): 12:07:58.502615 => 12:07:58.524702
[0m12:07:58.526201 [debug] [Thread-1 (]: Began executing node model.xeneta.stg_datapoints
[0m12:07:58.611382 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:58.612003 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

    
  
    
    

    create temporary table
      "stg_datapoints__dbt_tmp20240701120758579581"
  
    as (
      

with stg_datapoints as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Created as timestamp ) as Created,
        Cast(Origin_PID as integer ) as Origin_PID,
        Cast(Destination_PID as integer )as Destination_PID,
        Cast(Valid_From as date ) as Valid_From,
        Cast(Valid_To as date ) as Valid_To,
        Cast(Company_ID as integer ) as Company_ID,
        Cast(Supplier_ID as integer ) as Supplier_ID,
        Cast(Equipment_ID as integer ) as Equipment_ID,
        row_number() over (partition by d_id order by created )as row_num
    from raw.datapoints

    
)

select *
from stg_datapoints
where row_num = 1
    );
  
  
  
[0m12:07:58.612499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:58.627184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:58.638371 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:58.639057 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: BEGIN
[0m12:07:58.639790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:58.640311 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:58.640845 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_datapoints__dbt_tmp20240701120758579581'
      
      
      order by ordinal_position

  
[0m12:07:58.689596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:58.697949 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:58.698694 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_datapoints'
      
      and table_schema = 'main_staging'
      
      
      and table_catalog = 'dev'
      
      order by ordinal_position

  
[0m12:07:58.717316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:58.727509 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:58.728181 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'stg_datapoints'
      
      and table_schema = 'main_staging'
      
      
      and table_catalog = 'dev'
      
      order by ordinal_position

  
[0m12:07:58.745293 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:58.755874 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.stg_datapoints"
[0m12:07:58.756909 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:58.757580 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */
insert into "dev"."main_staging"."stg_datapoints" ("D_ID", "Created", "Origin_PID", "Destination_PID", "Valid_From", "Valid_To", "Company_ID", "Supplier_ID", "Equipment_ID", "row_num")
    (
        select "D_ID", "Created", "Origin_PID", "Destination_PID", "Valid_From", "Valid_To", "Company_ID", "Supplier_ID", "Equipment_ID", "row_num"
        from "stg_datapoints__dbt_tmp20240701120758579581"
    )


  
[0m12:07:58.763120 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:58.784311 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: COMMIT
[0m12:07:58.785014 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:07:58.785550 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: COMMIT
[0m12:07:58.789952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:07:58.791603 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_datapoints (execute): 12:07:58.526765 => 12:07:58.791270
[0m12:07:58.792193 [debug] [Thread-1 (]: On model.xeneta.stg_datapoints: Close
[0m12:07:58.803360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67a61875-afda-4187-8a74-68747c254bd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11245d900>]}
[0m12:07:58.804432 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model main_staging.stg_datapoints ............ [[32mOK[0m in 0.30s]
[0m12:07:58.805471 [debug] [Thread-1 (]: Finished running node model.xeneta.stg_datapoints
[0m12:07:58.807439 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:58.808034 [debug] [MainThread]: On master: BEGIN
[0m12:07:58.808546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:58.821243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:58.822273 [debug] [MainThread]: On master: COMMIT
[0m12:07:58.823274 [debug] [MainThread]: Using duckdb connection "master"
[0m12:07:58.824621 [debug] [MainThread]: On master: COMMIT
[0m12:07:58.825927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:07:58.827151 [debug] [MainThread]: On master: Close
[0m12:07:58.829884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:58.830503 [debug] [MainThread]: Connection 'model.xeneta.stg_datapoints' was properly closed.
[0m12:07:58.831112 [info ] [MainThread]: 
[0m12:07:58.834501 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m12:07:58.836216 [debug] [MainThread]: Command end result
[0m12:07:58.854521 [info ] [MainThread]: 
[0m12:07:58.856002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:58.857201 [info ] [MainThread]: 
[0m12:07:58.858321 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:07:58.862371 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3882353, "process_user_time": 3.667821, "process_kernel_time": 0.288485, "process_mem_max_rss": "127684608", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:07:58.863622 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:58.863370 after 1.39 seconds
[0m12:07:58.864363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112432830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd79d0>]}
[0m12:07:58.865343 [debug] [MainThread]: Flushing usage events
[0m12:16:20.635279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab3a60>]}


============================== 12:16:20.646267 | 33728d4e-7c27-4f2a-a8cc-c651026bb640 ==============================
[0m12:16:20.646267 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:16:20.647590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select aggregations.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:16:21.233323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33728d4e-7c27-4f2a-a8cc-c651026bb640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab3940>]}
[0m12:16:21.392678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33728d4e-7c27-4f2a-a8cc-c651026bb640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc8b20>]}
[0m12:16:21.395046 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:16:21.441088 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:16:21.574925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:16:21.582371 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:16:21.583960 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/staging/stg_datapoints.sql
[0m12:16:21.789090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33728d4e-7c27-4f2a-a8cc-c651026bb640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107009630>]}
[0m12:16:21.808169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33728d4e-7c27-4f2a-a8cc-c651026bb640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df1b40>]}
[0m12:16:21.809067 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:16:21.810351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33728d4e-7c27-4f2a-a8cc-c651026bb640', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df2950>]}
[0m12:16:21.813488 [info ] [MainThread]: 
[0m12:16:21.815651 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:16:21.818299 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:16:21.841895 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:16:21.842992 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:16:21.843619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:21.865695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:21.866383 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:16:21.868263 [info ] [MainThread]: 
[0m12:16:21.870265 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m12:16:21.872760 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:16:21.878033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3506395, "process_user_time": 4.056961, "process_kernel_time": 0.735491, "process_mem_max_rss": "115273728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:21.879567 [debug] [MainThread]: Command `dbt run` failed at 12:16:21.879092 after 1.35 seconds
[0m12:16:21.880443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb5de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107053c70>]}
[0m12:16:21.881182 [debug] [MainThread]: Flushing usage events
[0m12:16:33.057843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11103d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c338e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c33ac0>]}


============================== 12:16:33.066637 | 8dd1d09d-e269-42bb-b896-31b45dabf5f2 ==============================
[0m12:16:33.066637 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:16:33.067926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:33.521048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dd1d09d-e269-42bb-b896-31b45dabf5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c339a0>]}
[0m12:16:33.594589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dd1d09d-e269-42bb-b896-31b45dabf5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cb9a50>]}
[0m12:16:33.597385 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:16:33.628982 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:16:33.755835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:33.756562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:33.767299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dd1d09d-e269-42bb-b896-31b45dabf5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130443a0>]}
[0m12:16:33.792251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dd1d09d-e269-42bb-b896-31b45dabf5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f61c60>]}
[0m12:16:33.793315 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:16:33.794157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd1d09d-e269-42bb-b896-31b45dabf5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f629e0>]}
[0m12:16:33.797924 [info ] [MainThread]: 
[0m12:16:33.800636 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:16:33.802873 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:16:33.831741 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:16:33.832528 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:16:33.833192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:34.012705 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.017221 [debug] [ThreadPool]: On list_dev: Close
[0m12:16:34.023985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:16:34.026321 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:16:34.039642 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:16:34.040427 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:16:34.041027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:34.052675 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.054942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:16:34.055555 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:16:34.056383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.056959 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:16:34.057518 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:16:34.060429 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.062337 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:16:34.063046 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:16:34.063689 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:16:34.064610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.065230 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:16:34.070658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:16:34.080108 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:16:34.080805 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:16:34.081400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:34.090774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.091480 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:16:34.092038 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:16:34.161774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.172333 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:16:34.175373 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:16:34.176220 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:16:34.180415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:16:34.185347 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:16:34.185956 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:16:34.186458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:34.194723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.195394 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:16:34.195906 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:16:34.228956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:16:34.235420 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:16:34.235989 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:16:34.236374 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:16:34.240050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dd1d09d-e269-42bb-b896-31b45dabf5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11308e800>]}
[0m12:16:34.240737 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:34.241180 [debug] [MainThread]: On master: BEGIN
[0m12:16:34.241588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:34.248426 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:16:34.249036 [debug] [MainThread]: On master: COMMIT
[0m12:16:34.249482 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:34.249902 [debug] [MainThread]: On master: COMMIT
[0m12:16:34.250460 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:16:34.250903 [debug] [MainThread]: On master: Close
[0m12:16:34.253291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:34.253904 [info ] [MainThread]: 
[0m12:16:34.258587 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:16:34.259493 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:16:34.261979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:16:34.262793 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:16:34.281132 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:16:34.285078 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:16:34.263271 => 12:16:34.284231
[0m12:16:34.286307 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:16:34.356506 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:16:34.357264 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:16:34.357858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:34.365919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:16:34.366602 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:16:34.367202 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create table prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from main_final.aggregations              
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:16:34.413637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:16:34.427907 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:16:34.431386 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:16:34.432441 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:16:34.629520 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:16:34.639537 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:16:34.640518 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m12:16:34.646037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:16:34.653174 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:16:34.653951 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:16:34.655034 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:16:34.686425 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:16:34.687158 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:16:34.687713 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:16:34.710478 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:16:34.718819 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:16:34.719541 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:16:34.722403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:16:34.725427 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:16:34.286930 => 12:16:34.724987
[0m12:16:34.726154 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:16:34.764938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8dd1d09d-e269-42bb-b896-31b45dabf5f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc9c60>]}
[0m12:16:34.766282 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.50s]
[0m12:16:34.767444 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:16:34.770975 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:34.771860 [debug] [MainThread]: On master: BEGIN
[0m12:16:34.773486 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:34.789418 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:16:34.790149 [debug] [MainThread]: On master: COMMIT
[0m12:16:34.790723 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:34.791277 [debug] [MainThread]: On master: COMMIT
[0m12:16:34.791963 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:16:34.792544 [debug] [MainThread]: On master: Close
[0m12:16:34.795106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:34.795692 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:16:34.796454 [info ] [MainThread]: 
[0m12:16:34.797669 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m12:16:34.799154 [debug] [MainThread]: Command end result
[0m12:16:34.826777 [info ] [MainThread]: 
[0m12:16:34.828874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:34.830758 [info ] [MainThread]: 
[0m12:16:34.835320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:16:34.841605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8798321, "process_user_time": 4.281015, "process_kernel_time": 0.470148, "process_mem_max_rss": "178806784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:34.843914 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:34.842984 after 1.88 seconds
[0m12:16:34.845060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11103d660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cb9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e0f40>]}
[0m12:16:34.845988 [debug] [MainThread]: Flushing usage events
[0m12:18:37.089350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed7b20>]}


============================== 12:18:37.095570 | ef3fde83-8c60-45bc-9606-62dbdc17b1c8 ==============================
[0m12:18:37.095570 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:18:37.096527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'profiles_dir': '/Users/haidersultan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select aggregations.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:18:37.375253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef3fde83-8c60-45bc-9606-62dbdc17b1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed7a00>]}
[0m12:18:37.447838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef3fde83-8c60-45bc-9606-62dbdc17b1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0f0ca0>]}
[0m12:18:37.448886 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:18:37.483878 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:18:37.541867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:37.542890 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:18:37.559962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef3fde83-8c60-45bc-9606-62dbdc17b1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30fdc0>]}
[0m12:18:37.577657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef3fde83-8c60-45bc-9606-62dbdc17b1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a205cf0>]}
[0m12:18:37.578430 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:18:37.579150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef3fde83-8c60-45bc-9606-62dbdc17b1c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a206a70>]}
[0m12:18:37.581905 [info ] [MainThread]: 
[0m12:18:37.583157 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:18:37.584729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:18:37.615981 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:18:37.616746 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:18:37.617346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:37.632123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:37.632758 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:18:37.633326 [info ] [MainThread]: 
[0m12:18:37.633994 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m12:18:37.634880 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:18:37.638402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6263933, "process_user_time": 3.011526, "process_kernel_time": 0.244068, "process_mem_max_rss": "111841280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:37.641602 [debug] [MainThread]: Command `dbt run` failed at 12:18:37.641261 after 0.63 seconds
[0m12:18:37.642492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a206a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34aa40>]}
[0m12:18:37.643493 [debug] [MainThread]: Flushing usage events
[0m12:18:51.141250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b3af0>]}


============================== 12:18:51.147746 | 9efbf9f5-c450-469e-a5ba-d3909c625b8f ==============================
[0m12:18:51.147746 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:18:51.148754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:18:51.425665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9efbf9f5-c450-469e-a5ba-d3909c625b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b39d0>]}
[0m12:18:51.500735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9efbf9f5-c450-469e-a5ba-d3909c625b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141396f0>]}
[0m12:18:51.501798 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:18:51.536800 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:18:51.595896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:51.596502 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:51.605092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9efbf9f5-c450-469e-a5ba-d3909c625b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144c03d0>]}
[0m12:18:51.621571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9efbf9f5-c450-469e-a5ba-d3909c625b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143f1c90>]}
[0m12:18:51.622376 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:18:51.623247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9efbf9f5-c450-469e-a5ba-d3909c625b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143f2a10>]}
[0m12:18:51.626932 [info ] [MainThread]: 
[0m12:18:51.629796 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:18:51.632276 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:18:51.661085 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:18:51.661845 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:18:51.662447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:51.676733 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.679188 [debug] [ThreadPool]: On list_dev: Close
[0m12:18:51.683774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:18:51.685056 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:18:51.695944 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:18:51.696587 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:18:51.697088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:51.706296 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.708242 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:18:51.708777 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:18:51.709425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.709915 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:18:51.710405 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:18:51.711113 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.712307 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:18:51.712915 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:18:51.713402 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:18:51.714079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.714586 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:18:51.719015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m12:18:51.727832 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:18:51.728516 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:18:51.729159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:51.737183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.737800 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:18:51.738437 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:18:51.785019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.787042 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:18:51.787994 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:18:51.788469 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:18:51.792112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:18:51.795157 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:18:51.796020 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:18:51.798203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:51.806648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.807294 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:18:51.807821 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:18:51.845616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:18:51.853404 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:18:51.854033 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:18:51.854465 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:18:51.859121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9efbf9f5-c450-469e-a5ba-d3909c625b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114506830>]}
[0m12:18:51.859820 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:51.860285 [debug] [MainThread]: On master: BEGIN
[0m12:18:51.860716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:51.867970 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:18:51.868636 [debug] [MainThread]: On master: COMMIT
[0m12:18:51.869199 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:51.869681 [debug] [MainThread]: On master: COMMIT
[0m12:18:51.870278 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:18:51.870770 [debug] [MainThread]: On master: Close
[0m12:18:51.873173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:18:51.873851 [info ] [MainThread]: 
[0m12:18:51.876680 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:18:51.877531 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:18:51.878629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m12:18:51.879305 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:18:51.900282 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:18:51.901841 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:18:51.880208 => 12:18:51.901232
[0m12:18:51.902660 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:18:51.967212 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:18:51.968333 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:18:51.968919 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:18:51.969466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:51.976850 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:18:51.977541 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:18:51.978183 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:18:52.149499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:18:52.160491 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:18:52.161353 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:18:52.162455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:18:52.189117 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:18:52.189835 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:18:52.190373 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:18:52.208433 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:18:52.216934 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:18:52.217707 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:18:52.218671 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:18:52.221024 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:18:51.905445 => 12:18:52.220668
[0m12:18:52.221677 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:18:52.246585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9efbf9f5-c450-469e-a5ba-d3909c625b8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142c9900>]}
[0m12:18:52.247763 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.37s]
[0m12:18:52.249003 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:18:52.251118 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:52.251730 [debug] [MainThread]: On master: BEGIN
[0m12:18:52.252267 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:52.261598 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:18:52.262260 [debug] [MainThread]: On master: COMMIT
[0m12:18:52.262787 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:52.263299 [debug] [MainThread]: On master: COMMIT
[0m12:18:52.263928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:18:52.264493 [debug] [MainThread]: On master: Close
[0m12:18:52.267045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:52.267598 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:18:52.268154 [info ] [MainThread]: 
[0m12:18:52.268977 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m12:18:52.270680 [debug] [MainThread]: Command end result
[0m12:18:52.288379 [info ] [MainThread]: 
[0m12:18:52.293063 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:52.296154 [info ] [MainThread]: 
[0m12:18:52.298350 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:18:52.302318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2404841, "process_user_time": 3.823734, "process_kernel_time": 0.351226, "process_mem_max_rss": "171646976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:52.306600 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:52.304084 after 1.24 seconds
[0m12:18:52.307634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b5660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114562d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114561330>]}
[0m12:18:52.309237 [debug] [MainThread]: Flushing usage events
[0m12:21:30.851512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbdde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b3a60>]}


============================== 12:21:30.857931 | 7f964ed9-ccdd-48a2-8b37-4b515defc720 ==============================
[0m12:21:30.857931 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:21:30.858923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'profiles_dir': '/Users/haidersultan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:21:31.143440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f964ed9-ccdd-48a2-8b37-4b515defc720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b3940>]}
[0m12:21:31.217365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f964ed9-ccdd-48a2-8b37-4b515defc720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc8b20>]}
[0m12:21:31.218412 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:21:31.251459 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:21:31.311309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:31.312306 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:21:31.328976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f964ed9-ccdd-48a2-8b37-4b515defc720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de4610>]}
[0m12:21:31.344728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f964ed9-ccdd-48a2-8b37-4b515defc720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce1c90>]}
[0m12:21:31.345458 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:21:31.346064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f964ed9-ccdd-48a2-8b37-4b515defc720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce2a10>]}
[0m12:21:31.348581 [info ] [MainThread]: 
[0m12:21:31.350199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:21:31.353784 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:21:31.386319 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:21:31.387250 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:21:31.387970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:31.405647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:31.406597 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:21:31.407277 [info ] [MainThread]: 
[0m12:21:31.408171 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:21:31.409176 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:21:31.411536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6379568, "process_user_time": 3.044159, "process_kernel_time": 0.266254, "process_mem_max_rss": "112173056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:21:31.413030 [debug] [MainThread]: Command `dbt run` failed at 12:21:31.412730 after 0.64 seconds
[0m12:21:31.413956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dbdde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e26980>]}
[0m12:21:31.415692 [debug] [MainThread]: Flushing usage events
[0m12:21:47.009007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ff8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ffac0>]}


============================== 12:21:47.015174 | 8ce667f1-52e2-4455-866e-1a347e32125e ==============================
[0m12:21:47.015174 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:21:47.016264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:47.309392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ce667f1-52e2-4455-866e-1a347e32125e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ff9a0>]}
[0m12:21:47.385299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ce667f1-52e2-4455-866e-1a347e32125e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a85a50>]}
[0m12:21:47.386366 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:21:47.418445 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:21:47.478503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:47.479091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:47.487770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ce667f1-52e2-4455-866e-1a347e32125e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e143a0>]}
[0m12:21:47.502637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ce667f1-52e2-4455-866e-1a347e32125e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2dc60>]}
[0m12:21:47.503370 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:21:47.504031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ce667f1-52e2-4455-866e-1a347e32125e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2e9e0>]}
[0m12:21:47.506651 [info ] [MainThread]: 
[0m12:21:47.508116 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:21:47.509743 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:21:47.538651 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:21:47.539582 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:21:47.540391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:47.556480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.559210 [debug] [ThreadPool]: On list_dev: Close
[0m12:21:47.563026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:21:47.564242 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:21:47.576016 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:21:47.576699 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:21:47.577212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:47.586354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.588255 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:21:47.588775 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:21:47.589767 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.590757 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:21:47.591316 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:21:47.592308 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.593705 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:21:47.594248 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:21:47.594747 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:21:47.595435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.595963 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:21:47.600203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:21:47.608235 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:21:47.608850 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:21:47.609323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:47.617031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.617646 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:21:47.618152 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:21:47.651990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.658466 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:21:47.659340 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:21:47.659784 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:21:47.663104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:21:47.667268 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:21:47.667743 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:21:47.668148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:47.675453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.676057 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:21:47.676535 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:21:47.713317 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:21:47.715003 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:21:47.715641 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:21:47.716099 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:21:47.719347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ce667f1-52e2-4455-866e-1a347e32125e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e5a800>]}
[0m12:21:47.720040 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:47.720464 [debug] [MainThread]: On master: BEGIN
[0m12:21:47.720861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:47.727720 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:47.730010 [debug] [MainThread]: On master: COMMIT
[0m12:21:47.730924 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:47.731504 [debug] [MainThread]: On master: COMMIT
[0m12:21:47.732205 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:47.732713 [debug] [MainThread]: On master: Close
[0m12:21:47.735022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:47.735922 [info ] [MainThread]: 
[0m12:21:47.738722 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:21:47.739523 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:21:47.741259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:21:47.742356 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:21:47.761332 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:21:47.762679 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:21:47.742857 => 12:21:47.762244
[0m12:21:47.763334 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:21:47.821295 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:21:47.822338 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:21:47.822956 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:21:47.823442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:47.830857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:47.831492 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:21:47.832087 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:21:48.013644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:48.026252 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:21:48.027155 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:21:48.028552 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:48.055577 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:21:48.056308 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:21:48.056825 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:21:48.071999 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:48.079774 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:21:48.080468 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:21:48.081364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:21:48.083611 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:21:47.763737 => 12:21:48.083274
[0m12:21:48.084226 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:21:48.118471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ce667f1-52e2-4455-866e-1a347e32125e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ead750>]}
[0m12:21:48.119585 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.38s]
[0m12:21:48.120672 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:21:48.122764 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:48.123387 [debug] [MainThread]: On master: BEGIN
[0m12:21:48.123904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:48.134813 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:48.135753 [debug] [MainThread]: On master: COMMIT
[0m12:21:48.136881 [debug] [MainThread]: Using duckdb connection "master"
[0m12:21:48.137849 [debug] [MainThread]: On master: COMMIT
[0m12:21:48.141798 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:21:48.143218 [debug] [MainThread]: On master: Close
[0m12:21:48.146134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:48.146761 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:21:48.147362 [info ] [MainThread]: 
[0m12:21:48.148050 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m12:21:48.149437 [debug] [MainThread]: Command end result
[0m12:21:48.168007 [info ] [MainThread]: 
[0m12:21:48.169371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:48.170591 [info ] [MainThread]: 
[0m12:21:48.172445 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:21:48.178313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2451136, "process_user_time": 3.861784, "process_kernel_time": 0.362495, "process_mem_max_rss": "171462656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:21:48.179551 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:48.179299 after 1.25 seconds
[0m12:21:48.180302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ed8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ead1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec8a30>]}
[0m12:21:48.181009 [debug] [MainThread]: Flushing usage events
[0m12:22:23.514781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105733880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105733a60>]}


============================== 12:22:23.520443 | fb9b53f3-e593-46f4-94e0-161d81816ecc ==============================
[0m12:22:23.520443 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:22:23.521423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:22:23.798095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb9b53f3-e593-46f4-94e0-161d81816ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105733940>]}
[0m12:22:23.874999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb9b53f3-e593-46f4-94e0-161d81816ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105948b20>]}
[0m12:22:23.876050 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:22:23.903579 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:22:23.969481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:23.970415 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:22:23.988164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb9b53f3-e593-46f4-94e0-161d81816ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b60610>]}
[0m12:22:24.003863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb9b53f3-e593-46f4-94e0-161d81816ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a61c90>]}
[0m12:22:24.004622 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:22:24.005249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9b53f3-e593-46f4-94e0-161d81816ecc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a62a10>]}
[0m12:22:24.007925 [info ] [MainThread]: 
[0m12:22:24.009329 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:22:24.010954 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:22:24.038299 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:22:24.038996 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:22:24.039564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:24.054236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:24.054869 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:22:24.055428 [info ] [MainThread]: 
[0m12:22:24.056509 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m12:22:24.057527 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:22:24.059604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6214758, "process_user_time": 3.110551, "process_kernel_time": 0.250485, "process_mem_max_rss": "111575040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:22:24.060669 [debug] [MainThread]: Command `dbt run` failed at 12:22:24.060439 after 0.62 seconds
[0m12:22:24.061352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a62950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba2980>]}
[0m12:22:24.062920 [debug] [MainThread]: Flushing usage events
[0m12:22:34.410061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec24e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110827940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110827b20>]}


============================== 12:22:34.416367 | b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa ==============================
[0m12:22:34.416367 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:22:34.417457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:22:34.695108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110827a00>]}
[0m12:22:34.771529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a40ca0>]}
[0m12:22:34.772750 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:22:34.804526 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:22:34.866924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:34.867519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:34.876081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c34400>]}
[0m12:22:34.891174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b49c00>]}
[0m12:22:34.891921 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:22:34.892599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b4a980>]}
[0m12:22:34.895142 [info ] [MainThread]: 
[0m12:22:34.896495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:22:34.899053 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:22:34.926895 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:22:34.928106 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:22:34.928858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:34.942763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:34.945128 [debug] [ThreadPool]: On list_dev: Close
[0m12:22:34.948621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:22:34.949849 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:22:34.961455 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:22:34.962113 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:22:34.962619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:34.971640 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:34.973593 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:22:34.974131 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:22:34.974774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:34.975256 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:22:34.975738 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:22:34.976437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:34.977675 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:22:34.979204 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:22:34.979874 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:22:34.980628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:34.981171 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:22:34.985748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:22:34.994151 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:22:34.994762 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:22:34.995242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:35.003410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:35.004004 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:22:35.004492 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:22:35.038669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:35.046120 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:22:35.047014 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:22:35.047444 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:22:35.050951 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:22:35.055304 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:22:35.055831 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:22:35.056268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:35.065035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:35.065677 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:22:35.066166 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:22:35.098973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:22:35.105976 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:22:35.106538 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:22:35.106976 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:22:35.110617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7e860>]}
[0m12:22:35.111321 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:35.111775 [debug] [MainThread]: On master: BEGIN
[0m12:22:35.112184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:35.120175 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:22:35.120868 [debug] [MainThread]: On master: COMMIT
[0m12:22:35.121322 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:35.121755 [debug] [MainThread]: On master: COMMIT
[0m12:22:35.122357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:22:35.122821 [debug] [MainThread]: On master: Close
[0m12:22:35.125262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:22:35.126064 [info ] [MainThread]: 
[0m12:22:35.129507 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:22:35.130431 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:22:35.132436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:22:35.133262 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:22:35.154422 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:22:35.156101 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:22:35.133696 => 12:22:35.155433
[0m12:22:35.157389 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:22:35.206317 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:22:35.207139 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:22:35.207720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:35.215457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:22:35.216105 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:22:35.216649 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create table prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:22:35.222802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:22:35.236286 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:22:35.237450 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:22:35.238121 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      

with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:22:35.425491 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:22:35.436035 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:22:35.436833 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m12:22:35.437973 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:22:35.444351 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:22:35.445089 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:22:35.446096 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:22:35.474337 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:22:35.475015 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:22:35.475536 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:22:35.490652 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:22:35.498685 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:22:35.499417 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:22:35.501054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:22:35.503650 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:22:35.158884 => 12:22:35.503294
[0m12:22:35.504295 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:22:35.531076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b3cab9-2ca1-40f6-aa63-d6d7d4f593aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cdd960>]}
[0m12:22:35.532189 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.40s]
[0m12:22:35.533223 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:22:35.535256 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:35.535847 [debug] [MainThread]: On master: BEGIN
[0m12:22:35.536341 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:35.547093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:22:35.547783 [debug] [MainThread]: On master: COMMIT
[0m12:22:35.548317 [debug] [MainThread]: Using duckdb connection "master"
[0m12:22:35.548825 [debug] [MainThread]: On master: COMMIT
[0m12:22:35.549491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:22:35.550041 [debug] [MainThread]: On master: Close
[0m12:22:35.552553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:35.553105 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:22:35.553661 [info ] [MainThread]: 
[0m12:22:35.554331 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m12:22:35.555451 [debug] [MainThread]: Command end result
[0m12:22:35.577141 [info ] [MainThread]: 
[0m12:22:35.578611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:35.580068 [info ] [MainThread]: 
[0m12:22:35.581720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:22:35.585279 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2554582, "process_user_time": 3.986899, "process_kernel_time": 0.362128, "process_mem_max_rss": "175558656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:22:35.586436 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:35.586188 after 1.26 seconds
[0m12:22:35.587479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec24e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a41150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2a620>]}
[0m12:22:35.588363 [debug] [MainThread]: Flushing usage events
[0m12:24:30.853645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baf910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bafaf0>]}


============================== 12:24:30.860014 | 0e7e5d6d-ab00-4a6f-82fe-3ecbcc46002f ==============================
[0m12:24:30.860014 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:24:30.861076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'debug': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:24:31.140596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e7e5d6d-ab00-4a6f-82fe-3ecbcc46002f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105baf9d0>]}
[0m12:24:31.221711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e7e5d6d-ab00-4a6f-82fe-3ecbcc46002f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c356f0>]}
[0m12:24:31.222767 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:24:31.255455 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:24:31.316563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:31.317497 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/final/aggregations.sql
[0m12:24:31.466444 [error] [MainThread]: Encountered an error:
Compilation Error in model aggregations (models/final/aggregations.sql)
  expected token ',', got 'post_hook'
    line 4
      post_hook= "Create table post_count as (SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count from {{this}} WHERE dq_ok ='True' group by 1,2,3,4,5 order by count desc)"
[0m12:24:31.468806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6942377, "process_user_time": 3.151591, "process_kernel_time": 0.261523, "process_mem_max_rss": "110907392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:31.469823 [debug] [MainThread]: Command `dbt run` failed at 12:24:31.469604 after 0.70 seconds
[0m12:24:31.470493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fbd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106020ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106020cd0>]}
[0m12:24:31.471134 [debug] [MainThread]: Flushing usage events
[0m12:24:52.390799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b35de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109733850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109733a30>]}


============================== 12:24:52.397101 | 97b7a446-6afc-47ee-b819-cfbb32ad9fa7 ==============================
[0m12:24:52.397101 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:24:52.398140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:52.694889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97b7a446-6afc-47ee-b819-cfbb32ad9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109733910>]}
[0m12:24:52.769323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97b7a446-6afc-47ee-b819-cfbb32ad9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097c9de0>]}
[0m12:24:52.770372 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:24:52.803271 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:24:52.862689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:52.863562 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/final/aggregations.sql
[0m12:24:53.046629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97b7a446-6afc-47ee-b819-cfbb32ad9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c940d0>]}
[0m12:24:53.063918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97b7a446-6afc-47ee-b819-cfbb32ad9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfa980>]}
[0m12:24:53.064663 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:24:53.065355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b7a446-6afc-47ee-b819-cfbb32ad9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf8970>]}
[0m12:24:53.067887 [info ] [MainThread]: 
[0m12:24:53.069311 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:24:53.070901 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:24:53.100929 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:24:53.101678 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:24:53.102271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:53.116931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:53.117597 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:24:53.118188 [info ] [MainThread]: 
[0m12:24:53.118892 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m12:24:53.119816 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:24:53.121909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8075897, "process_user_time": 3.206533, "process_kernel_time": 0.273649, "process_mem_max_rss": "114831360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:24:53.123024 [debug] [MainThread]: Command `dbt run` failed at 12:24:53.122787 after 0.81 seconds
[0m12:24:53.123718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b35de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfb6d0>]}
[0m12:24:53.129839 [debug] [MainThread]: Flushing usage events
[0m12:25:02.890165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f1c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1fa90>]}


============================== 12:25:02.896240 | 6516f76c-04ea-4c7e-ba82-15d47ccc023a ==============================
[0m12:25:02.896240 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:25:02.897549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:03.183523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6516f76c-04ea-4c7e-ba82-15d47ccc023a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1f970>]}
[0m12:25:03.257936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6516f76c-04ea-4c7e-ba82-15d47ccc023a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da78e0>]}
[0m12:25:03.259128 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:25:03.289820 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:25:03.350226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:03.350839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:03.359211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6516f76c-04ea-4c7e-ba82-15d47ccc023a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091303d0>]}
[0m12:25:03.373994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6516f76c-04ea-4c7e-ba82-15d47ccc023a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904dbd0>]}
[0m12:25:03.374722 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:25:03.375332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6516f76c-04ea-4c7e-ba82-15d47ccc023a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904e950>]}
[0m12:25:03.377852 [info ] [MainThread]: 
[0m12:25:03.379214 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:25:03.383607 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:25:03.411693 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:25:03.413175 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:25:03.414003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:03.427787 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.430303 [debug] [ThreadPool]: On list_dev: Close
[0m12:25:03.434506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:25:03.435999 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:25:03.447190 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:25:03.447866 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:25:03.448382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:03.457505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.459737 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:25:03.460693 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:25:03.461406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.461893 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:25:03.462412 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:25:03.463130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.464452 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:25:03.464969 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:25:03.465454 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:25:03.466110 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.466621 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:25:03.470749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:25:03.478709 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:25:03.479316 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:25:03.479779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:03.487774 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.488371 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:25:03.488853 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:25:03.522835 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.530597 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:25:03.531466 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:25:03.531898 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:25:03.535469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:25:03.539476 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:25:03.539955 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:25:03.540364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:03.547721 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.548327 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:25:03.548782 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:25:03.579029 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:25:03.585949 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:25:03.586517 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:25:03.586892 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:25:03.590287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6516f76c-04ea-4c7e-ba82-15d47ccc023a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109176830>]}
[0m12:25:03.590917 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:03.591323 [debug] [MainThread]: On master: BEGIN
[0m12:25:03.591697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:03.598400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:25:03.599470 [debug] [MainThread]: On master: COMMIT
[0m12:25:03.600311 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:03.600777 [debug] [MainThread]: On master: COMMIT
[0m12:25:03.601405 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:25:03.601856 [debug] [MainThread]: On master: Close
[0m12:25:03.603961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:03.604627 [info ] [MainThread]: 
[0m12:25:03.607483 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:25:03.608242 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:25:03.609931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:25:03.610929 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:25:03.629188 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:25:03.630854 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:25:03.611420 => 12:25:03.630366
[0m12:25:03.631536 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:25:03.679343 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:25:03.680112 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:25:03.680655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:03.688163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:25:03.688814 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:25:03.689368 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create table prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:25:03.700244 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:25:03.631928 => 12:25:03.699646
[0m12:25:03.701105 [debug] [Thread-1 (]: On model.xeneta.aggregations: ROLLBACK
[0m12:25:03.721578 [debug] [Thread-1 (]: Failed to rollback 'model.xeneta.aggregations'
[0m12:25:03.722414 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:25:03.726300 [debug] [Thread-1 (]: Runtime Error in model aggregations (models/final/aggregations.sql)
  Catalog Error: Table with name "prior_count" already exists!
[0m12:25:03.727216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6516f76c-04ea-4c7e-ba82-15d47ccc023a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a1720>]}
[0m12:25:03.728281 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_final.aggregations .................. [[31mERROR[0m in 0.12s]
[0m12:25:03.729709 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:25:03.732892 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:03.733599 [debug] [MainThread]: On master: BEGIN
[0m12:25:03.734198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:03.744908 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:25:03.745626 [debug] [MainThread]: On master: COMMIT
[0m12:25:03.746206 [debug] [MainThread]: Using duckdb connection "master"
[0m12:25:03.746764 [debug] [MainThread]: On master: COMMIT
[0m12:25:03.747529 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:25:03.748131 [debug] [MainThread]: On master: Close
[0m12:25:03.750810 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:03.751468 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:25:03.752077 [info ] [MainThread]: 
[0m12:25:03.753069 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:25:03.754457 [debug] [MainThread]: Command end result
[0m12:25:03.769833 [info ] [MainThread]: 
[0m12:25:03.770828 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:03.771642 [info ] [MainThread]: 
[0m12:25:03.772484 [error] [MainThread]:   Runtime Error in model aggregations (models/final/aggregations.sql)
  Catalog Error: Table with name "prior_count" already exists!
[0m12:25:03.773542 [info ] [MainThread]: 
[0m12:25:03.774443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:25:03.777664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9653203, "process_user_time": 3.349916, "process_kernel_time": 0.268181, "process_mem_max_rss": "120266752", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:25:03.779611 [debug] [MainThread]: Command `dbt run` failed at 12:25:03.779199 after 0.97 seconds
[0m12:25:03.781394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f1c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ca050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ca0b0>]}
[0m12:25:03.782397 [debug] [MainThread]: Flushing usage events
[0m12:26:56.924168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105023970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105023b50>]}


============================== 12:26:56.936162 | 1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9 ==============================
[0m12:26:56.936162 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:26:56.937670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:57.721157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105023a30>]}
[0m12:26:57.826627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105231de0>]}
[0m12:26:57.828824 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:26:57.874123 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:26:57.990800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:57.991775 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:26:58.236524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557c0d0>]}
[0m12:26:58.273026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054efaf0>]}
[0m12:26:58.274350 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:26:58.275514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10544c880>]}
[0m12:26:58.278930 [info ] [MainThread]: 
[0m12:26:58.280474 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:26:58.285143 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:26:58.319254 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:26:58.320335 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:26:58.321267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:58.397644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.401414 [debug] [ThreadPool]: On list_dev: Close
[0m12:26:58.406477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:26:58.408417 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:26:58.419612 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:26:58.420392 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:26:58.420954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:58.431940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.434060 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:26:58.434751 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:26:58.435560 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.436094 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:26:58.436616 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:26:58.441593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.444564 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:26:58.445256 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:26:58.445831 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:26:58.446639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.447242 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:26:58.451863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m12:26:58.461210 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:26:58.461913 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:26:58.462447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:58.471399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.472093 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:26:58.472646 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:26:58.551588 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.561122 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:26:58.564413 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:26:58.565260 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:26:58.569436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:26:58.573594 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:26:58.574228 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:26:58.574749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:58.583599 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.584300 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:26:58.584846 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:26:58.620952 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:26:58.627988 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:26:58.628550 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:26:58.628944 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:26:58.633380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051faf80>]}
[0m12:26:58.634068 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:58.634513 [debug] [MainThread]: On master: BEGIN
[0m12:26:58.634943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:58.642347 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:26:58.642966 [debug] [MainThread]: On master: COMMIT
[0m12:26:58.643409 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:58.643845 [debug] [MainThread]: On master: COMMIT
[0m12:26:58.644549 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:26:58.645046 [debug] [MainThread]: On master: Close
[0m12:26:58.647335 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:58.647997 [info ] [MainThread]: 
[0m12:26:58.652373 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:26:58.653335 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:26:58.655497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m12:26:58.656395 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:26:58.676186 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:26:58.679991 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:26:58.656892 => 12:26:58.679053
[0m12:26:58.680909 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:26:58.743190 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:58.744114 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:26:58.745019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:58.754750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:58.755663 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:58.756495 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create table IF NOT EXISTS prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:26:58.767614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:58.783070 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:26:58.785742 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:58.786764 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      


with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:26:59.047670 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:59.058263 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:59.059078 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m12:26:59.063556 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:59.069076 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:59.069791 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:26:59.070855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:59.079489 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:59.080421 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create table post_count as (SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count from "dev"."main_final"."aggregations" WHERE dq_ok ='True' group by 1,2,3,4,5 order by count desc)
      
[0m12:26:59.088803 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:59.114289 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:26:59.115044 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:59.115593 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:26:59.134228 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:59.142198 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:26:59.142917 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:26:59.146136 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:26:59.149131 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:26:58.681396 => 12:26:59.148730
[0m12:26:59.149848 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:26:59.184373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c4f147b-3fb4-4c4d-b08d-af1afdff8dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105597a60>]}
[0m12:26:59.185548 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.53s]
[0m12:26:59.186670 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:26:59.190105 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:59.190802 [debug] [MainThread]: On master: BEGIN
[0m12:26:59.191358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:59.203235 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:26:59.203947 [debug] [MainThread]: On master: COMMIT
[0m12:26:59.204543 [debug] [MainThread]: Using duckdb connection "master"
[0m12:26:59.205102 [debug] [MainThread]: On master: COMMIT
[0m12:26:59.205798 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:26:59.206387 [debug] [MainThread]: On master: Close
[0m12:26:59.208981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:59.209581 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:26:59.210154 [info ] [MainThread]: 
[0m12:26:59.211587 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m12:26:59.217334 [debug] [MainThread]: Command end result
[0m12:26:59.335987 [info ] [MainThread]: 
[0m12:26:59.337331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:59.338413 [info ] [MainThread]: 
[0m12:26:59.339513 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:26:59.344651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5376635, "process_user_time": 5.209154, "process_kernel_time": 0.897562, "process_mem_max_rss": "176308224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:26:59.345931 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:59.345665 after 2.54 seconds
[0m12:26:59.346727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035640d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542d240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542ead0>]}
[0m12:26:59.347496 [debug] [MainThread]: Flushing usage events
[0m12:27:37.321004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b935660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d533910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d533af0>]}


============================== 12:27:37.330754 | a2dd0f21-7d9f-4d57-98de-5cb1604d82ba ==============================
[0m12:27:37.330754 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:27:37.331955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/haidersultan/xeneta/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:27:37.664642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2dd0f21-7d9f-4d57-98de-5cb1604d82ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5339d0>]}
[0m12:27:37.737869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2dd0f21-7d9f-4d57-98de-5cb1604d82ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5b96f0>]}
[0m12:27:37.740089 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:27:37.776785 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:27:37.901784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:27:37.902946 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/final/aggregations.sql
[0m12:27:37.903770 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:27:38.113150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2dd0f21-7d9f-4d57-98de-5cb1604d82ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dab00d0>]}
[0m12:27:38.134084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2dd0f21-7d9f-4d57-98de-5cb1604d82ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da11f00>]}
[0m12:27:38.134962 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:27:38.136201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2dd0f21-7d9f-4d57-98de-5cb1604d82ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d998820>]}
[0m12:27:38.139674 [info ] [MainThread]: 
[0m12:27:38.143113 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:27:38.148714 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:27:38.179386 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:27:38.180558 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:27:38.181600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:38.198749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.201404 [debug] [ThreadPool]: On list_dev: Close
[0m12:27:38.204949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:27:38.206172 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:27:38.217218 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:27:38.217875 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:27:38.218396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:38.229743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.232282 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:27:38.233029 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:27:38.234247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.234862 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:27:38.235383 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:27:38.236134 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.237449 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:27:38.237983 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:27:38.238479 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:27:38.239161 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.239668 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:27:38.244207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:27:38.252612 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:27:38.253248 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:27:38.253718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:38.261865 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.262473 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:27:38.262960 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:27:38.296566 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.303755 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:27:38.307467 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:27:38.308361 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:27:38.312368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:27:38.315693 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:27:38.317856 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:27:38.318351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:38.326392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.327041 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:27:38.327553 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:27:38.360223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:27:38.367149 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:27:38.367736 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:27:38.368117 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:27:38.372401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2dd0f21-7d9f-4d57-98de-5cb1604d82ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad7190>]}
[0m12:27:38.373088 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:38.373530 [debug] [MainThread]: On master: BEGIN
[0m12:27:38.373941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:27:38.381568 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:27:38.382200 [debug] [MainThread]: On master: COMMIT
[0m12:27:38.382670 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:38.383122 [debug] [MainThread]: On master: COMMIT
[0m12:27:38.383694 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:27:38.384171 [debug] [MainThread]: On master: Close
[0m12:27:38.386506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:38.387286 [info ] [MainThread]: 
[0m12:27:38.391977 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:27:38.392972 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:27:38.397969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:27:38.401271 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:27:38.429907 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:27:38.433592 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:27:38.403846 => 12:27:38.432990
[0m12:27:38.434447 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:27:38.490830 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:27:38.491581 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:27:38.492180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:38.500504 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:27:38.501275 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:27:38.501903 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create view prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:27:38.515412 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:27:38.434959 => 12:27:38.514791
[0m12:27:38.516345 [debug] [Thread-1 (]: On model.xeneta.aggregations: ROLLBACK
[0m12:27:38.535741 [debug] [Thread-1 (]: Failed to rollback 'model.xeneta.aggregations'
[0m12:27:38.536593 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:27:38.540708 [debug] [Thread-1 (]: Runtime Error in model aggregations (models/final/aggregations.sql)
  Catalog Error: View with name "prior_count" already exists!
[0m12:27:38.541620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2dd0f21-7d9f-4d57-98de-5cb1604d82ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d98dc90>]}
[0m12:27:38.542706 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_final.aggregations .................. [[31mERROR[0m in 0.14s]
[0m12:27:38.543913 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:27:38.547222 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:38.547966 [debug] [MainThread]: On master: BEGIN
[0m12:27:38.548550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:38.567063 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:27:38.568514 [debug] [MainThread]: On master: COMMIT
[0m12:27:38.569191 [debug] [MainThread]: Using duckdb connection "master"
[0m12:27:38.569811 [debug] [MainThread]: On master: COMMIT
[0m12:27:38.570649 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:27:38.571297 [debug] [MainThread]: On master: Close
[0m12:27:38.574169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:38.574795 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:27:38.575420 [info ] [MainThread]: 
[0m12:27:38.576165 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:27:38.577438 [debug] [MainThread]: Command end result
[0m12:27:38.598188 [info ] [MainThread]: 
[0m12:27:38.599846 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:27:38.606910 [info ] [MainThread]: 
[0m12:27:38.608857 [error] [MainThread]:   Runtime Error in model aggregations (models/final/aggregations.sql)
  Catalog Error: View with name "prior_count" already exists!
[0m12:27:38.617436 [info ] [MainThread]: 
[0m12:27:38.619921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:27:38.639303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4271692, "process_user_time": 4.307735, "process_kernel_time": 0.591306, "process_mem_max_rss": "124563456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:27:38.647221 [debug] [MainThread]: Command `dbt run` failed at 12:27:38.645972 after 1.43 seconds
[0m12:27:38.654434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b935660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5339d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c9030>]}
[0m12:27:38.656296 [debug] [MainThread]: Flushing usage events
[0m12:28:04.736596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aff8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109affac0>]}


============================== 12:28:04.742831 | b31b1546-c3aa-445a-8179-74143f6fd1b8 ==============================
[0m12:28:04.742831 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:28:04.743910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:28:05.060159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b31b1546-c3aa-445a-8179-74143f6fd1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aff9a0>]}
[0m12:28:05.170303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b31b1546-c3aa-445a-8179-74143f6fd1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b85a50>]}
[0m12:28:05.171516 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:28:05.210983 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:28:05.276247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:28:05.277138 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/final/aggregations.sql
[0m12:28:05.277784 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:28:05.459492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b31b1546-c3aa-445a-8179-74143f6fd1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0780d0>]}
[0m12:28:05.477564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b31b1546-c3aa-445a-8179-74143f6fd1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdf0d0>]}
[0m12:28:05.478393 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:28:05.479105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31b1546-c3aa-445a-8179-74143f6fd1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f803a0>]}
[0m12:28:05.481863 [info ] [MainThread]: 
[0m12:28:05.483103 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:28:05.486119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:28:05.517636 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:28:05.518421 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:28:05.519079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:28:05.533748 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.537261 [debug] [ThreadPool]: On list_dev: Close
[0m12:28:05.540967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:28:05.542191 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:28:05.554503 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:28:05.555183 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:28:05.555716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:05.564894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.566839 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:28:05.567388 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:28:05.568005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.568481 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:28:05.568961 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:28:05.569641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.570884 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:28:05.571395 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:28:05.571887 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:28:05.572541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.573046 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:28:05.577306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m12:28:05.585452 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:28:05.586295 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:28:05.586952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:05.594929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.595523 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:28:05.596001 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:28:05.630228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.637288 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:28:05.638141 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:28:05.638549 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:28:05.641837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:28:05.644992 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:28:05.645586 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:28:05.646023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:28:05.653406 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.654004 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:28:05.654489 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:28:05.685939 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:28:05.692891 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:28:05.693444 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:28:05.693823 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:28:05.698034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b31b1546-c3aa-445a-8179-74143f6fd1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed5480>]}
[0m12:28:05.698706 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:05.699129 [debug] [MainThread]: On master: BEGIN
[0m12:28:05.699515 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:28:05.706375 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:28:05.706967 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.707393 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:05.707800 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.708780 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:28:05.710007 [debug] [MainThread]: On master: Close
[0m12:28:05.712365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:28:05.713066 [info ] [MainThread]: 
[0m12:28:05.715686 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:28:05.716454 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:28:05.718154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m12:28:05.719208 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:28:05.740417 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:28:05.742183 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:28:05.719703 => 12:28:05.741457
[0m12:28:05.742942 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:28:05.789781 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:28:05.790492 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:28:05.791033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:28:05.798623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:28:05.799298 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:28:05.799865 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Replace view prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:28:05.803348 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:28:05.743372 => 12:28:05.802760
[0m12:28:05.804222 [debug] [Thread-1 (]: On model.xeneta.aggregations: ROLLBACK
[0m12:28:05.807476 [debug] [Thread-1 (]: Failed to rollback 'model.xeneta.aggregations'
[0m12:28:05.808098 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:28:05.811270 [debug] [Thread-1 (]: Runtime Error in model aggregations (models/final/aggregations.sql)
  Parser Error: syntax error at or near "Replace"
[0m12:28:05.812043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b31b1546-c3aa-445a-8179-74143f6fd1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d3340>]}
[0m12:28:05.812993 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_final.aggregations .................. [[31mERROR[0m in 0.09s]
[0m12:28:05.814026 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:28:05.816678 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:05.817282 [debug] [MainThread]: On master: BEGIN
[0m12:28:05.817770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:28:05.827801 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:28:05.829028 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.831732 [debug] [MainThread]: Using duckdb connection "master"
[0m12:28:05.833145 [debug] [MainThread]: On master: COMMIT
[0m12:28:05.834503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:28:05.835732 [debug] [MainThread]: On master: Close
[0m12:28:05.839061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:28:05.839782 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:28:05.840545 [info ] [MainThread]: 
[0m12:28:05.841586 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m12:28:05.842967 [debug] [MainThread]: Command end result
[0m12:28:05.859705 [info ] [MainThread]: 
[0m12:28:05.860723 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:28:05.862007 [info ] [MainThread]: 
[0m12:28:05.863470 [error] [MainThread]:   Runtime Error in model aggregations (models/final/aggregations.sql)
  Parser Error: syntax error at or near "Replace"
[0m12:28:05.864566 [info ] [MainThread]: 
[0m12:28:05.866284 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:28:05.871901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2130102, "process_user_time": 3.749683, "process_kernel_time": 0.38549, "process_mem_max_rss": "123322368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:28:05.874729 [debug] [MainThread]: Command `dbt run` failed at 12:28:05.874349 after 1.22 seconds
[0m12:28:05.876208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aff9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0bada0>]}
[0m12:28:05.877001 [debug] [MainThread]: Flushing usage events
[0m12:29:48.047467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cef220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781ba30>]}


============================== 12:29:48.057537 | a30ee8ff-6e57-4af6-9ba5-466a13117db9 ==============================
[0m12:29:48.057537 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:29:48.058811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/haidersultan/xeneta/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:29:48.859347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a30ee8ff-6e57-4af6-9ba5-466a13117db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781b910>]}
[0m12:29:48.949568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a30ee8ff-6e57-4af6-9ba5-466a13117db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078adde0>]}
[0m12:29:48.953564 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:29:48.998943 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:29:49.102514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:29:49.103377 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:29:49.332780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a30ee8ff-6e57-4af6-9ba5-466a13117db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d940d0>]}
[0m12:29:49.367668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a30ee8ff-6e57-4af6-9ba5-466a13117db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cef9a0>]}
[0m12:29:49.368892 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:29:49.369919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30ee8ff-6e57-4af6-9ba5-466a13117db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9c6a0>]}
[0m12:29:49.373349 [info ] [MainThread]: 
[0m12:29:49.376416 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:29:49.378972 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:29:49.402682 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:29:49.403761 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:29:49.405139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:29:49.500966 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.506075 [debug] [ThreadPool]: On list_dev: Close
[0m12:29:49.511599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:29:49.512882 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:29:49.524101 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:29:49.524853 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:29:49.525431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:49.537203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.539943 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:29:49.540622 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:29:49.541382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.541942 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:29:49.542500 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:29:49.547052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.548788 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:29:49.549381 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:29:49.550039 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:29:49.550845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.551444 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:29:49.556172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m12:29:49.565558 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:29:49.566266 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:29:49.566805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:49.576840 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.577545 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:29:49.578091 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:29:49.656912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.667702 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:29:49.670897 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:29:49.671795 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:29:49.676113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:29:49.680087 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:29:49.680743 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:29:49.681293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:29:49.690255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.690952 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:29:49.691502 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:29:49.726918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:29:49.734200 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:29:49.734813 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:29:49.735222 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:29:49.740076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a30ee8ff-6e57-4af6-9ba5-466a13117db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107becc10>]}
[0m12:29:49.740843 [debug] [MainThread]: Using duckdb connection "master"
[0m12:29:49.741306 [debug] [MainThread]: On master: BEGIN
[0m12:29:49.741735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:29:49.749169 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:29:49.749780 [debug] [MainThread]: On master: COMMIT
[0m12:29:49.750508 [debug] [MainThread]: Using duckdb connection "master"
[0m12:29:49.750963 [debug] [MainThread]: On master: COMMIT
[0m12:29:49.751593 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:29:49.752061 [debug] [MainThread]: On master: Close
[0m12:29:49.754460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:29:49.755295 [info ] [MainThread]: 
[0m12:29:49.759726 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:29:49.760662 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:29:49.763076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m12:29:49.763986 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:29:49.793518 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:29:49.797357 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:29:49.764716 => 12:29:49.795850
[0m12:29:49.803376 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:29:49.862502 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:29:49.863409 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:29:49.864177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:29:49.873763 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:29:49.874507 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:29:49.875141 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create or Replace view prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:29:49.889282 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:29:49.804901 => 12:29:49.888685
[0m12:29:49.890150 [debug] [Thread-1 (]: On model.xeneta.aggregations: ROLLBACK
[0m12:29:49.909798 [debug] [Thread-1 (]: Failed to rollback 'model.xeneta.aggregations'
[0m12:29:49.910704 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:29:49.914809 [debug] [Thread-1 (]: Runtime Error in model aggregations (models/final/aggregations.sql)
  Catalog Error: Existing object prior_count is of type Table, trying to replace with type View
[0m12:29:49.915726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a30ee8ff-6e57-4af6-9ba5-466a13117db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107deb100>]}
[0m12:29:49.917792 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_final.aggregations .................. [[31mERROR[0m in 0.15s]
[0m12:29:49.919513 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:29:49.923900 [debug] [MainThread]: Using duckdb connection "master"
[0m12:29:49.924685 [debug] [MainThread]: On master: BEGIN
[0m12:29:49.926323 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:29:49.942657 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:29:49.943422 [debug] [MainThread]: On master: COMMIT
[0m12:29:49.944031 [debug] [MainThread]: Using duckdb connection "master"
[0m12:29:49.944609 [debug] [MainThread]: On master: COMMIT
[0m12:29:49.945339 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:29:49.945954 [debug] [MainThread]: On master: Close
[0m12:29:49.951198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:29:49.951926 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:29:49.952590 [info ] [MainThread]: 
[0m12:29:49.953597 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m12:29:49.955312 [debug] [MainThread]: Command end result
[0m12:29:49.974699 [info ] [MainThread]: 
[0m12:29:49.975706 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:29:49.976537 [info ] [MainThread]: 
[0m12:29:49.977697 [error] [MainThread]:   Runtime Error in model aggregations (models/final/aggregations.sql)
  Catalog Error: Existing object prior_count is of type Table, trying to replace with type View
[0m12:29:49.978484 [info ] [MainThread]: 
[0m12:29:49.979221 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:29:49.990189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0579884, "process_user_time": 4.568137, "process_kernel_time": 0.742995, "process_mem_max_rss": "124375040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:29:49.991848 [debug] [MainThread]: Command `dbt run` failed at 12:29:49.991441 after 2.06 seconds
[0m12:29:49.993176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cef220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdbee0>]}
[0m12:29:49.994418 [debug] [MainThread]: Flushing usage events
[0m12:30:27.743695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ed660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1baf0>]}


============================== 12:30:27.753713 | 7b0609fa-c8ab-4e01-8ed8-2f2da3d04b65 ==============================
[0m12:30:27.753713 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:30:27.755134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'profiles_dir': '/Users/haidersultan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:30:28.283131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b0609fa-c8ab-4e01-8ed8-2f2da3d04b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1b9d0>]}
[0m12:30:28.424838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b0609fa-c8ab-4e01-8ed8-2f2da3d04b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d996f0>]}
[0m12:30:28.427016 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:30:28.474856 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:30:28.608599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:28.609365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:28.620577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b0609fa-c8ab-4e01-8ed8-2f2da3d04b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10912c430>]}
[0m12:30:28.645565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b0609fa-c8ab-4e01-8ed8-2f2da3d04b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109049cf0>]}
[0m12:30:28.646543 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:30:28.647396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b0609fa-c8ab-4e01-8ed8-2f2da3d04b65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904aa70>]}
[0m12:30:28.650600 [info ] [MainThread]: 
[0m12:30:28.653491 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:30:28.655830 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:30:28.683992 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:30:28.685500 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:30:28.686299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:28.708523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:28.709222 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:30:28.709857 [info ] [MainThread]: 
[0m12:30:28.710590 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:30:28.711528 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:30:28.715996 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0780832, "process_user_time": 3.826718, "process_kernel_time": 0.706069, "process_mem_max_rss": "112328704", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:28.717327 [debug] [MainThread]: Command `dbt run` failed at 12:30:28.717028 after 1.08 seconds
[0m12:30:28.719992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ed660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109172ad0>]}
[0m12:30:28.720884 [debug] [MainThread]: Flushing usage events
[0m12:30:40.004572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3d4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd3ac0>]}


============================== 12:30:40.010820 | aed3c213-24cc-4699-a58c-1f0c0417a3b5 ==============================
[0m12:30:40.010820 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:30:40.012000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select aggregations.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:30:40.289107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed3c213-24cc-4699-a58c-1f0c0417a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd39a0>]}
[0m12:30:40.366512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed3c213-24cc-4699-a58c-1f0c0417a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111055a50>]}
[0m12:30:40.367632 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:30:40.404904 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:30:40.463529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:30:40.464126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:30:40.472773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed3c213-24cc-4699-a58c-1f0c0417a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113e4400>]}
[0m12:30:40.487763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed3c213-24cc-4699-a58c-1f0c0417a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111311cc0>]}
[0m12:30:40.488485 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:30:40.489095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed3c213-24cc-4699-a58c-1f0c0417a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111312a40>]}
[0m12:30:40.491572 [info ] [MainThread]: 
[0m12:30:40.493286 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:30:40.496111 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:30:40.525632 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:30:40.526392 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:30:40.526993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:40.569489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.574694 [debug] [ThreadPool]: On list_dev: Close
[0m12:30:40.580293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:30:40.581735 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:30:40.593536 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:30:40.594281 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:30:40.594871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:40.605173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.607278 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:30:40.607871 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:30:40.608558 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.609070 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:30:40.609591 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:30:40.611174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.612833 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:30:40.613419 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:30:40.613937 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:30:40.614691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.615253 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:30:40.619775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:30:40.628428 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:30:40.629111 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:30:40.629622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:40.638109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.638788 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:30:40.639315 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:30:40.691218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.700000 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:30:40.702749 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:30:40.703581 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:30:40.707597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:30:40.710835 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:30:40.713022 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:30:40.713534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:30:40.721624 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.722298 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:30:40.722818 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:30:40.756157 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:30:40.763992 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:30:40.764669 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:30:40.765087 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:30:40.768752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed3c213-24cc-4699-a58c-1f0c0417a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142e860>]}
[0m12:30:40.769463 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:40.769918 [debug] [MainThread]: On master: BEGIN
[0m12:30:40.770344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:40.777516 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:30:40.778125 [debug] [MainThread]: On master: COMMIT
[0m12:30:40.778577 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:40.778998 [debug] [MainThread]: On master: COMMIT
[0m12:30:40.779636 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:30:40.780094 [debug] [MainThread]: On master: Close
[0m12:30:40.782382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:30:40.783093 [info ] [MainThread]: 
[0m12:30:40.787754 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:30:40.788711 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:30:40.791858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:30:40.792689 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:30:40.819954 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:30:40.821645 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:30:40.793218 => 12:30:40.821049
[0m12:30:40.822745 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:30:40.873966 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:30:40.874684 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:30:40.875240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:40.883455 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:30:40.884125 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:30:40.884687 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Create or Replace view prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:30:40.887787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:30:40.903347 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:30:40.905658 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:30:40.906430 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      


with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:30:41.126276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:30:41.135779 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:30:41.136539 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m12:30:41.138630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:30:41.145667 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:30:41.146462 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:30:41.147523 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:30:41.155943 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:30:41.156725 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Replace view post_count as (SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count from "dev"."main_final"."aggregations" WHERE dq_ok ='True' group by 1,2,3,4,5 order by count desc)
      
[0m12:30:41.161170 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:30:40.823679 => 12:30:41.160548
[0m12:30:41.162067 [debug] [Thread-1 (]: On model.xeneta.aggregations: ROLLBACK
[0m12:30:41.183570 [debug] [Thread-1 (]: Failed to rollback 'model.xeneta.aggregations'
[0m12:30:41.184501 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:30:41.190327 [debug] [Thread-1 (]: Runtime Error in model aggregations (models/final/aggregations.sql)
  Parser Error: syntax error at or near "Replace"
[0m12:30:41.191358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aed3c213-24cc-4699-a58c-1f0c0417a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114893c0>]}
[0m12:30:41.192600 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_final.aggregations .................. [[31mERROR[0m in 0.40s]
[0m12:30:41.193878 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:30:41.197689 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:41.198467 [debug] [MainThread]: On master: BEGIN
[0m12:30:41.200307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:41.216447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:30:41.217802 [debug] [MainThread]: On master: COMMIT
[0m12:30:41.218617 [debug] [MainThread]: Using duckdb connection "master"
[0m12:30:41.219232 [debug] [MainThread]: On master: COMMIT
[0m12:30:41.220014 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:30:41.220628 [debug] [MainThread]: On master: Close
[0m12:30:41.223445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:41.224061 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:30:41.224679 [info ] [MainThread]: 
[0m12:30:41.225543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m12:30:41.227201 [debug] [MainThread]: Command end result
[0m12:30:41.245460 [info ] [MainThread]: 
[0m12:30:41.247672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:30:41.250410 [info ] [MainThread]: 
[0m12:30:41.253092 [error] [MainThread]:   Runtime Error in model aggregations (models/final/aggregations.sql)
  Parser Error: syntax error at or near "Replace"
[0m12:30:41.256850 [info ] [MainThread]: 
[0m12:30:41.258260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:30:41.263171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3365998, "process_user_time": 4.021459, "process_kernel_time": 0.369387, "process_mem_max_rss": "174514176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:30:41.264805 [debug] [MainThread]: Command `dbt run` failed at 12:30:41.264286 after 1.34 seconds
[0m12:30:41.268227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3d4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111055a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111470d30>]}
[0m12:30:41.269385 [debug] [MainThread]: Flushing usage events
[0m12:31:26.451718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba17220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53ba00>]}


============================== 12:31:26.457995 | 5c624595-9946-40c0-8d1d-7781f82f1ef4 ==============================
[0m12:31:26.457995 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:31:26.459240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select aggregations.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:31:26.744784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c624595-9946-40c0-8d1d-7781f82f1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d53b8e0>]}
[0m12:31:26.820509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c624595-9946-40c0-8d1d-7781f82f1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c85e0>]}
[0m12:31:26.821606 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:31:26.857847 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:31:26.916985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:31:26.917998 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:31:27.132209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c624595-9946-40c0-8d1d-7781f82f1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dab40d0>]}
[0m12:31:27.150310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c624595-9946-40c0-8d1d-7781f82f1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da1bdf0>]}
[0m12:31:27.151146 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:31:27.151888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c624595-9946-40c0-8d1d-7781f82f1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d98c730>]}
[0m12:31:27.154922 [info ] [MainThread]: 
[0m12:31:27.156433 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:31:27.162792 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:31:27.192524 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:31:27.193290 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:31:27.194002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:27.209126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.212143 [debug] [ThreadPool]: On list_dev: Close
[0m12:31:27.217948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:31:27.219622 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:31:27.231071 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:31:27.231786 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:31:27.232427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:27.242827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.244859 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:31:27.245419 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:31:27.246111 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.246629 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:31:27.247142 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:31:27.248101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.249547 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:31:27.250130 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:31:27.250655 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:31:27.251372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.251913 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:31:27.256238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m12:31:27.264570 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:31:27.265257 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:31:27.265739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:27.274097 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.274725 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:31:27.275232 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:31:27.309200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.316530 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:31:27.317518 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:31:27.318258 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:31:27.322275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:31:27.325310 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:31:27.325795 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:31:27.326214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:27.333266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.333818 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:31:27.334277 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:31:27.366798 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:31:27.374108 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:31:27.374751 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:31:27.375125 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:31:27.379636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c624595-9946-40c0-8d1d-7781f82f1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6de650>]}
[0m12:31:27.380331 [debug] [MainThread]: Using duckdb connection "master"
[0m12:31:27.380771 [debug] [MainThread]: On master: BEGIN
[0m12:31:27.381176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:27.388279 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:31:27.388888 [debug] [MainThread]: On master: COMMIT
[0m12:31:27.389325 [debug] [MainThread]: Using duckdb connection "master"
[0m12:31:27.389751 [debug] [MainThread]: On master: COMMIT
[0m12:31:27.390313 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:31:27.390757 [debug] [MainThread]: On master: Close
[0m12:31:27.392989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:27.393628 [info ] [MainThread]: 
[0m12:31:27.396472 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:31:27.397289 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:31:27.398728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m12:31:27.401546 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:31:27.424617 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:31:27.426041 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:31:27.402023 => 12:31:27.425589
[0m12:31:27.426770 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:31:27.481097 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:31:27.481878 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:31:27.482581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:27.491064 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:31:27.491782 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:31:27.492385 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        Replace view prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:31:27.493595 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:31:27.427196 => 12:31:27.493236
[0m12:31:27.494200 [debug] [Thread-1 (]: On model.xeneta.aggregations: ROLLBACK
[0m12:31:27.497398 [debug] [Thread-1 (]: Failed to rollback 'model.xeneta.aggregations'
[0m12:31:27.498006 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:31:27.501324 [debug] [Thread-1 (]: Runtime Error in model aggregations (models/final/aggregations.sql)
  Parser Error: syntax error at or near "Replace"
[0m12:31:27.502119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c624595-9946-40c0-8d1d-7781f82f1ef4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d96cb20>]}
[0m12:31:27.503043 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main_final.aggregations .................. [[31mERROR[0m in 0.10s]
[0m12:31:27.504167 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:31:27.506886 [debug] [MainThread]: Using duckdb connection "master"
[0m12:31:27.507485 [debug] [MainThread]: On master: BEGIN
[0m12:31:27.507971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:27.519797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:31:27.521158 [debug] [MainThread]: On master: COMMIT
[0m12:31:27.522278 [debug] [MainThread]: Using duckdb connection "master"
[0m12:31:27.522967 [debug] [MainThread]: On master: COMMIT
[0m12:31:27.524172 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:31:27.524982 [debug] [MainThread]: On master: Close
[0m12:31:27.527708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:27.528300 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:31:27.528895 [info ] [MainThread]: 
[0m12:31:27.529575 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:31:27.530775 [debug] [MainThread]: Command end result
[0m12:31:27.547221 [info ] [MainThread]: 
[0m12:31:27.548027 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:31:27.551068 [info ] [MainThread]: 
[0m12:31:27.552245 [error] [MainThread]:   Runtime Error in model aggregations (models/final/aggregations.sql)
  Parser Error: syntax error at or near "Replace"
[0m12:31:27.557342 [info ] [MainThread]: 
[0m12:31:27.558972 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:27.562227 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1919551, "process_user_time": 3.690225, "process_kernel_time": 0.303944, "process_mem_max_rss": "122515456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:31:27.563455 [debug] [MainThread]: Command `dbt run` failed at 12:31:27.563196 after 1.19 seconds
[0m12:31:27.564283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba17220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c85e0>]}
[0m12:31:27.570120 [debug] [MainThread]: Flushing usage events
[0m12:34:44.518576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d138b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5fac0>]}


============================== 12:34:44.533300 | c213032f-ad16-4033-8bb3-d49ec542f20b ==============================
[0m12:34:44.533300 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:34:44.534876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'debug': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:45.338170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c213032f-ad16-4033-8bb3-d49ec542f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5f9a0>]}
[0m12:34:45.427002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c213032f-ad16-4033-8bb3-d49ec542f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ece5a50>]}
[0m12:34:45.429340 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:34:45.476175 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:34:45.590441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:34:45.591504 [debug] [MainThread]: Partial parsing: updated file: xeneta://models/final/aggregations.sql
[0m12:34:45.592324 [debug] [MainThread]: Partial parsing: updated file: xeneta://macros/generate_count.sql
[0m12:34:45.828665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c213032f-ad16-4033-8bb3-d49ec542f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1d80d0>]}
[0m12:34:45.863281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c213032f-ad16-4033-8bb3-d49ec542f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f139c30>]}
[0m12:34:45.864339 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:34:45.865111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c213032f-ad16-4033-8bb3-d49ec542f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0c43a0>]}
[0m12:34:45.868117 [info ] [MainThread]: 
[0m12:34:45.869522 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:34:45.872740 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:34:45.899262 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:34:45.900036 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:34:45.901434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:34:45.987722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:45.991978 [debug] [ThreadPool]: On list_dev: Close
[0m12:34:45.997779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:34:45.999648 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:34:46.013873 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:34:46.014670 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:34:46.015401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:46.028339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.032054 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:34:46.033101 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:34:46.034244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.036255 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:34:46.037486 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:34:46.040082 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.041806 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:34:46.042695 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:34:46.043795 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:34:46.045696 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.057426 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:34:46.062558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:34:46.075694 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:34:46.076326 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:34:46.076771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:46.085083 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.085709 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:34:46.086196 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:34:46.164114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.175083 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:34:46.178265 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:34:46.179174 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:34:46.183530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:34:46.188736 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:34:46.189394 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:34:46.189941 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:34:46.199921 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.201318 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:34:46.202052 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:34:46.237684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:34:46.247882 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:34:46.248634 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:34:46.249103 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:34:46.252931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c213032f-ad16-4033-8bb3-d49ec542f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2034f0>]}
[0m12:34:46.253701 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:46.254213 [debug] [MainThread]: On master: BEGIN
[0m12:34:46.254685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:46.262367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:34:46.263033 [debug] [MainThread]: On master: COMMIT
[0m12:34:46.263524 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:46.263992 [debug] [MainThread]: On master: COMMIT
[0m12:34:46.264573 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:34:46.265065 [debug] [MainThread]: On master: Close
[0m12:34:46.267435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:34:46.268133 [info ] [MainThread]: 
[0m12:34:46.272377 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:34:46.273346 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:34:46.275545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:34:46.276593 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:34:46.296784 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:34:46.301050 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:34:46.277103 => 12:34:46.300108
[0m12:34:46.303230 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:34:46.358762 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.359495 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:34:46.360070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:34:46.368095 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.368805 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.369399 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        CREATE OR REPLACE table prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:34:46.418403 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.435142 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:34:46.438105 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.439171 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      


with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:34:46.744371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.754870 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.755682 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m12:34:46.761609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.767302 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.768037 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:34:46.769130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.777666 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.778482 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        CREATE OR REPLACE table post_count as (SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count from "dev"."main_final"."aggregations" WHERE dq_ok ='True' group by 1,2,3,4,5 order by count desc)
      
[0m12:34:46.784944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.815611 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:34:46.816735 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.818655 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:34:46.844923 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.858418 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:34:46.859733 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:34:46.864630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:34:46.871279 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:34:46.303802 => 12:34:46.870757
[0m12:34:46.872320 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:34:46.921653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c213032f-ad16-4033-8bb3-d49ec542f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1eaec0>]}
[0m12:34:46.923171 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.65s]
[0m12:34:46.924633 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:34:46.930091 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:46.930919 [debug] [MainThread]: On master: BEGIN
[0m12:34:46.931552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:34:46.947031 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:34:46.948024 [debug] [MainThread]: On master: COMMIT
[0m12:34:46.952820 [debug] [MainThread]: Using duckdb connection "master"
[0m12:34:46.954545 [debug] [MainThread]: On master: COMMIT
[0m12:34:46.956326 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:34:46.957147 [debug] [MainThread]: On master: Close
[0m12:34:46.960455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:34:46.961177 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:34:46.962447 [info ] [MainThread]: 
[0m12:34:46.963325 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m12:34:46.964619 [debug] [MainThread]: Command end result
[0m12:34:47.086426 [info ] [MainThread]: 
[0m12:34:47.087597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:34:47.088684 [info ] [MainThread]: 
[0m12:34:47.089757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:34:47.095285 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.710781, "process_user_time": 5.086118, "process_kernel_time": 0.910593, "process_mem_max_rss": "180776960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:34:47.096727 [debug] [MainThread]: Command `dbt run` succeeded at 12:34:47.096394 after 2.71 seconds
[0m12:34:47.097645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d138b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4f7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f07df30>]}
[0m12:34:47.098494 [debug] [MainThread]: Flushing usage events
[0m12:35:27.177620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7b9c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113af880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113afa60>]}


============================== 12:35:27.183898 | 479ca0a3-42b5-451c-954e-3aec237d4f31 ==============================
[0m12:35:27.183898 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:35:27.184858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select aggregations.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:35:27.460865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '479ca0a3-42b5-451c-954e-3aec237d4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113af940>]}
[0m12:35:27.533348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '479ca0a3-42b5-451c-954e-3aec237d4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115c4b20>]}
[0m12:35:27.534393 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:35:27.573152 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:35:27.628826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:27.629387 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:27.637531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '479ca0a3-42b5-451c-954e-3aec237d4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117bc3a0>]}
[0m12:35:27.654441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '479ca0a3-42b5-451c-954e-3aec237d4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116edc90>]}
[0m12:35:27.655194 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:35:27.655879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '479ca0a3-42b5-451c-954e-3aec237d4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116eea10>]}
[0m12:35:27.659453 [info ] [MainThread]: 
[0m12:35:27.660713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:35:27.662898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:35:27.690583 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:35:27.691597 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:35:27.692377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:27.718227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:27.718945 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:35:27.719560 [info ] [MainThread]: 
[0m12:35:27.720465 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:35:27.721785 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:35:27.724726 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6287254, "process_user_time": 3.315743, "process_kernel_time": 0.397785, "process_mem_max_rss": "112140288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:27.727021 [debug] [MainThread]: Command `dbt run` failed at 12:35:27.726661 after 0.63 seconds
[0m12:35:27.728528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7b9c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ee9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111806b30>]}
[0m12:35:27.729486 [debug] [MainThread]: Flushing usage events
[0m12:35:39.696650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132df970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132dfb50>]}


============================== 12:35:39.705918 | c7443eea-74b8-40b9-8786-36a358a3244d ==============================
[0m12:35:39.705918 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:35:39.707075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:40.331025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7443eea-74b8-40b9-8786-36a358a3244d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132dfa30>]}
[0m12:35:40.513569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7443eea-74b8-40b9-8786-36a358a3244d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f9de0>]}
[0m12:35:40.515847 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:35:40.560440 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:35:40.688233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:40.689017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:40.699685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7443eea-74b8-40b9-8786-36a358a3244d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f4490>]}
[0m12:35:40.722816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7443eea-74b8-40b9-8786-36a358a3244d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11360dd50>]}
[0m12:35:40.723800 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:35:40.724582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7443eea-74b8-40b9-8786-36a358a3244d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11360ead0>]}
[0m12:35:40.727755 [info ] [MainThread]: 
[0m12:35:40.729247 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:35:40.732665 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:35:40.763358 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:35:40.764114 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:35:40.764711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:40.782366 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.785299 [debug] [ThreadPool]: On list_dev: Close
[0m12:35:40.788999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:35:40.790261 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:35:40.803149 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:35:40.803863 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:35:40.804415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:40.813478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.815424 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:35:40.815957 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:35:40.816590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.817219 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:35:40.817739 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:35:40.818489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.819770 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:35:40.820308 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:35:40.820809 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:35:40.821474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.822000 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:35:40.826294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m12:35:40.834437 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:35:40.835055 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:35:40.835533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:40.843453 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.844055 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:35:40.844553 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:35:40.883011 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.884626 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:35:40.888803 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:35:40.889649 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:35:40.893583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:35:40.896782 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:35:40.897372 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:35:40.897914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:40.906054 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.906713 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:35:40.907263 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:35:40.940591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:35:40.947841 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:35:40.948417 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:35:40.948808 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:35:40.953608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7443eea-74b8-40b9-8786-36a358a3244d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11373a8f0>]}
[0m12:35:40.955530 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:40.956132 [debug] [MainThread]: On master: BEGIN
[0m12:35:40.956595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:40.964237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:35:40.964830 [debug] [MainThread]: On master: COMMIT
[0m12:35:40.965280 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:40.965738 [debug] [MainThread]: On master: COMMIT
[0m12:35:40.966316 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:35:40.966774 [debug] [MainThread]: On master: Close
[0m12:35:40.969326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:40.970049 [info ] [MainThread]: 
[0m12:35:40.974261 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:35:40.975167 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:35:40.977327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m12:35:40.978304 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:35:40.998845 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:35:41.002398 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:35:40.978933 => 12:35:41.000875
[0m12:35:41.003249 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:35:41.061803 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:35:41.062899 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:35:41.063473 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:35:41.063956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:41.071303 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:35:41.071948 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:35:41.072558 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      


with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:35:41.270457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:35:41.281317 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:35:41.282041 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:35:41.283092 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:35:41.291776 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:35:41.292653 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        CREATE OR REPLACE table post_count as (SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count from "dev"."main_final"."aggregations" WHERE dq_ok ='True' group by 1,2,3,4,5 order by count desc)
      
[0m12:35:41.298986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:35:41.320690 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:35:41.321402 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:35:41.321929 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:35:41.336843 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:35:41.344310 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:35:41.345011 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:35:41.345852 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:35:41.348008 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:35:41.003891 => 12:35:41.347690
[0m12:35:41.348598 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:35:41.378263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7443eea-74b8-40b9-8786-36a358a3244d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11378d840>]}
[0m12:35:41.379446 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.40s]
[0m12:35:41.380525 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:35:41.382634 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:41.383235 [debug] [MainThread]: On master: BEGIN
[0m12:35:41.383744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:41.395407 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:35:41.396580 [debug] [MainThread]: On master: COMMIT
[0m12:35:41.397767 [debug] [MainThread]: Using duckdb connection "master"
[0m12:35:41.399045 [debug] [MainThread]: On master: COMMIT
[0m12:35:41.403531 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:35:41.404540 [debug] [MainThread]: On master: Close
[0m12:35:41.407326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:41.407924 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:35:41.408535 [info ] [MainThread]: 
[0m12:35:41.409695 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m12:35:41.410975 [debug] [MainThread]: Command end result
[0m12:35:41.430854 [info ] [MainThread]: 
[0m12:35:41.432611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:41.433919 [info ] [MainThread]: 
[0m12:35:41.435426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:35:41.442234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8475085, "process_user_time": 4.177368, "process_kernel_time": 0.471097, "process_mem_max_rss": "170717184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:41.443506 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:41.443265 after 1.85 seconds
[0m12:35:41.444254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117b00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11378d2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137aa500>]}
[0m12:35:41.444953 [debug] [MainThread]: Flushing usage events
[0m12:36:54.901246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090df8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090dfac0>]}


============================== 12:36:54.908003 | cfc0b25c-b77e-43e1-a841-7dfebe81d543 ==============================
[0m12:36:54.908003 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:36:54.909245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/haidersultan/xeneta/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select aggregations.sql', 'send_anonymous_usage_stats': 'True'}
[0m12:36:55.225002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfc0b25c-b77e-43e1-a841-7dfebe81d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090df9a0>]}
[0m12:36:55.313077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfc0b25c-b77e-43e1-a841-7dfebe81d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109165a50>]}
[0m12:36:55.314275 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:36:55.373076 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:36:55.473940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:55.474939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:36:55.489338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfc0b25c-b77e-43e1-a841-7dfebe81d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f4400>]}
[0m12:36:55.512544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfc0b25c-b77e-43e1-a841-7dfebe81d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940dcc0>]}
[0m12:36:55.514310 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:36:55.516048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfc0b25c-b77e-43e1-a841-7dfebe81d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940ea40>]}
[0m12:36:55.542917 [info ] [MainThread]: 
[0m12:36:55.547935 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:36:55.671634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:36:55.804558 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:36:55.806865 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:36:55.807534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:55.844637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:55.845934 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m12:36:55.846945 [info ] [MainThread]: 
[0m12:36:55.848031 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:36:55.849410 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/haidersultan/xeneta/dev.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2829) by user haidersultan. See also https://duckdb.org/docs/connect/concurrency
[0m12:36:55.853017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0378631, "process_user_time": 3.95537, "process_kernel_time": 0.416684, "process_mem_max_rss": "111747072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:55.855076 [debug] [MainThread]: Command `dbt run` failed at 12:36:55.854633 after 1.04 seconds
[0m12:36:55.857618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10940e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953ab90>]}
[0m12:36:55.858859 [debug] [MainThread]: Flushing usage events
[0m12:37:02.788164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054938e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105493ac0>]}


============================== 12:37:02.794697 | 0ac20c01-7e92-463d-a551-893b30fc3ddc ==============================
[0m12:37:02.794697 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:37:02.795762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/haidersultan/.dbt', 'log_path': '/Users/haidersultan/xeneta/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select aggregations.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:37:03.074164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac20c01-7e92-463d-a551-893b30fc3ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054939a0>]}
[0m12:37:03.146580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac20c01-7e92-463d-a551-893b30fc3ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105519a50>]}
[0m12:37:03.147654 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:37:03.180436 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:37:03.240769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:03.241336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:03.249767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac20c01-7e92-463d-a551-893b30fc3ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a0400>]}
[0m12:37:03.264352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac20c01-7e92-463d-a551-893b30fc3ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c1cc0>]}
[0m12:37:03.265089 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:37:03.265701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac20c01-7e92-463d-a551-893b30fc3ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c2a40>]}
[0m12:37:03.268387 [info ] [MainThread]: 
[0m12:37:03.270461 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:37:03.273386 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:37:03.299222 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:37:03.300009 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:37:03.300586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:03.318081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.320864 [debug] [ThreadPool]: On list_dev: Close
[0m12:37:03.325687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:37:03.327307 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:37:03.339215 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:37:03.339893 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:37:03.340434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:03.351031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.353076 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:37:03.353646 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:37:03.354322 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.354872 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:37:03.355467 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:37:03.356388 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.357997 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:37:03.358692 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:37:03.359343 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:37:03.360145 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.360719 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:37:03.365738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_final)
[0m12:37:03.375298 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:37:03.375967 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:37:03.376480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:03.384530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.385184 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:37:03.385694 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:37:03.423894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.431326 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:37:03.432258 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:37:03.432692 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:37:03.436401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_final, now list_dev_main_staging)
[0m12:37:03.439460 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:37:03.440459 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:37:03.440931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:03.449087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.449833 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:37:03.450526 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:37:03.482967 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:37:03.491330 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:37:03.492012 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:37:03.492419 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:37:03.497142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac20c01-7e92-463d-a551-893b30fc3ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e6860>]}
[0m12:37:03.497883 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:03.498373 [debug] [MainThread]: On master: BEGIN
[0m12:37:03.498803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:03.506890 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:37:03.507558 [debug] [MainThread]: On master: COMMIT
[0m12:37:03.508028 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:03.508473 [debug] [MainThread]: On master: COMMIT
[0m12:37:03.509038 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:37:03.509514 [debug] [MainThread]: On master: Close
[0m12:37:03.512002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:03.512790 [info ] [MainThread]: 
[0m12:37:03.515640 [debug] [Thread-1 (]: Began running node model.xeneta.aggregations
[0m12:37:03.516446 [info ] [Thread-1 (]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:37:03.517487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_staging, now model.xeneta.aggregations)
[0m12:37:03.518123 [debug] [Thread-1 (]: Began compiling node model.xeneta.aggregations
[0m12:37:03.536208 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:37:03.538447 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (compile): 12:37:03.519312 => 12:37:03.537714
[0m12:37:03.539711 [debug] [Thread-1 (]: Began executing node model.xeneta.aggregations
[0m12:37:03.589863 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.590717 [debug] [Thread-1 (]: On model.xeneta.aggregations: BEGIN
[0m12:37:03.591363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:03.599199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.599986 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.600575 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        CREATE OR REPLACE table prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:37:03.607028 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.619433 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:37:03.620523 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.621179 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      


with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:37:03.811367 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.821384 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.822116 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m12:37:03.823150 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.829624 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.830429 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:37:03.831442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.839581 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.840316 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        CREATE OR REPLACE table post_count as (SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count from "dev"."main_final"."aggregations" WHERE dq_ok ='True' group by 1,2,3,4,5 order by count desc)
      
[0m12:37:03.846342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.869824 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:37:03.870526 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.871054 [debug] [Thread-1 (]: On model.xeneta.aggregations: COMMIT
[0m12:37:03.888493 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.896783 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.aggregations"
[0m12:37:03.897606 [debug] [Thread-1 (]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:37:03.899353 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:37:03.902122 [debug] [Thread-1 (]: Timing info for model.xeneta.aggregations (execute): 12:37:03.540187 => 12:37:03.901739
[0m12:37:03.902814 [debug] [Thread-1 (]: On model.xeneta.aggregations: Close
[0m12:37:03.934310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac20c01-7e92-463d-a551-893b30fc3ddc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105941540>]}
[0m12:37:03.935627 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 0.42s]
[0m12:37:03.936856 [debug] [Thread-1 (]: Finished running node model.xeneta.aggregations
[0m12:37:03.939121 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:03.939752 [debug] [MainThread]: On master: BEGIN
[0m12:37:03.940298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:03.954993 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:37:03.955986 [debug] [MainThread]: On master: COMMIT
[0m12:37:03.956787 [debug] [MainThread]: Using duckdb connection "master"
[0m12:37:03.957955 [debug] [MainThread]: On master: COMMIT
[0m12:37:03.959331 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:37:03.960032 [debug] [MainThread]: On master: Close
[0m12:37:03.963760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:03.964795 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:37:03.965750 [info ] [MainThread]: 
[0m12:37:03.966682 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m12:37:03.968726 [debug] [MainThread]: Command end result
[0m12:37:03.992980 [info ] [MainThread]: 
[0m12:37:03.994348 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:03.996117 [info ] [MainThread]: 
[0m12:37:03.998011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:37:04.004997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.291259, "process_user_time": 4.071233, "process_kernel_time": 0.387094, "process_mem_max_rss": "171913216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:37:04.007201 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:04.006718 after 1.30 seconds
[0m12:37:04.008590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038f8b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105932f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105933430>]}
[0m12:37:04.013571 [debug] [MainThread]: Flushing usage events
[0m12:39:00.637953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5a8c0>]}


============================== 12:39:00.654921 | 9eac9223-3358-47c9-822e-039ab712f319 ==============================
[0m12:39:00.654921 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:39:00.656607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:39:01.000016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eac9223-3358-47c9-822e-039ab712f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5abf0>]}
[0m12:39:01.091664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eac9223-3358-47c9-822e-039ab712f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aba020>]}
[0m12:39:01.093963 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:39:01.131622 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:39:01.241276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:01.241862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:01.249013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eac9223-3358-47c9-822e-039ab712f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3d330>]}
[0m12:39:01.268246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eac9223-3358-47c9-822e-039ab712f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e02c50>]}
[0m12:39:01.269626 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:39:01.270690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eac9223-3358-47c9-822e-039ab712f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e10370>]}
[0m12:39:01.273692 [info ] [MainThread]: 
[0m12:39:01.275153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:39:01.277995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:39:01.307502 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:39:01.308521 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:39:01.309382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:01.324625 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.327149 [debug] [ThreadPool]: On list_dev: Close
[0m12:39:01.331005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m12:39:01.332248 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m12:39:01.344199 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:01.344992 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:39:01.345560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:01.355342 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.357367 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:01.357924 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m12:39:01.358585 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.359097 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:01.359621 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m12:39:01.360309 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.361569 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:01.362103 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:01.362602 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:01.363289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.363798 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m12:39:01.368310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m12:39:01.376630 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:01.377272 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:39:01.377770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:01.385633 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.386245 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:01.386798 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:39:01.421564 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.429003 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:39:01.433074 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:39:01.433976 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:39:01.438362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:39:01.442570 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:01.443179 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:39:01.443670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:01.452235 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.452890 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:01.453426 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:39:01.486918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:01.495270 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:39:01.495979 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:39:01.496368 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:39:01.501127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eac9223-3358-47c9-822e-039ab712f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8fa90>]}
[0m12:39:01.501899 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:01.502392 [debug] [MainThread]: On master: BEGIN
[0m12:39:01.502848 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:01.510305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:01.510944 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.511433 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:01.511885 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.512450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:01.512925 [debug] [MainThread]: On master: Close
[0m12:39:01.515365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:01.516163 [info ] [MainThread]: 
[0m12:39:01.522894 [debug] [Thread-1 (]: Began running node model.xeneta.stg_ports
[0m12:39:01.523878 [info ] [Thread-1 (]: 1 of 1 START sql table model main_staging.stg_ports ............................ [RUN]
[0m12:39:01.525449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_ports)
[0m12:39:01.526218 [debug] [Thread-1 (]: Began compiling node model.xeneta.stg_ports
[0m12:39:01.550466 [debug] [Thread-1 (]: Writing injected SQL for node "model.xeneta.stg_ports"
[0m12:39:01.559520 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_ports (compile): 12:39:01.526653 => 12:39:01.552877
[0m12:39:01.560761 [debug] [Thread-1 (]: Began executing node model.xeneta.stg_ports
[0m12:39:01.678689 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.679937 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
DESCRIBE (select * from (
        

with stg_ports as (

    select
        Cast(PID as integer ) as PID,
        Cast(Code as char(5) ) as Code,
        Cast(Slug as varchar ) as Slug,
        Cast(Name as varchar )as Name,
        Cast(Country as varchar ) as Country,
        Cast(Country_Code as char(2) ) as Country_Code,
        ROW_NUMBER() OVER (PARTITION BY PID ORDER BY PID) AS row_num
    from raw.ports
    
)

select
PID,
Code,
Slug,
Name,
Country,
Country_Code
from stg_ports
where row_num = 1
    ) as __dbt_sbq
    where false
    limit 0
)
[0m12:39:01.681095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:01.700174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.717479 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.724713 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
DESCRIBE (select * from (
        select
    
      cast(null as integer) as PID, 
      cast(null as char(5)) as Code, 
      cast(null as varchar) as Slug, 
      cast(null as varchar) as Name, 
      cast(null as varchar) as Country, 
      cast(null as char(2)) as Country_Code
    ) as __dbt_sbq
    where false
    limit 0
)
[0m12:39:01.744708 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.828851 [debug] [Thread-1 (]: Writing runtime sql for node "model.xeneta.stg_ports"
[0m12:39:01.831299 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.832156 [debug] [Thread-1 (]: On model.xeneta.stg_ports: BEGIN
[0m12:39:01.833024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.833684 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.834396 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */

  
    
    
      
    

    create  table
      "dev"."main_staging"."stg_ports__dbt_tmp"
  
  (
    PID integer not null,
    Code char(5),
    Slug varchar,
    Name varchar,
    Country varchar,
    Country_Code char(2),
    
    primary key (PID)
    )
 ;
    insert into "dev"."main_staging"."stg_ports__dbt_tmp" 
  (
    
      
      PID ,
    
      
      Code ,
    
      
      Slug ,
    
      
      Name ,
    
      
      Country ,
    
      
      Country_Code 
    
  )
 (
      
    select PID, Code, Slug, Name, Country, Country_Code
    from (
        

with stg_ports as (

    select
        Cast(PID as integer ) as PID,
        Cast(Code as char(5) ) as Code,
        Cast(Slug as varchar ) as Slug,
        Cast(Name as varchar )as Name,
        Cast(Country as varchar ) as Country,
        Cast(Country_Code as char(2) ) as Country_Code,
        ROW_NUMBER() OVER (PARTITION BY PID ORDER BY PID) AS row_num
    from raw.ports
    
)

select
PID,
Code,
Slug,
Name,
Country,
Country_Code
from stg_ports
where row_num = 1
    ) as model_subq
    );
  
  
[0m12:39:01.866201 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.878552 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.879640 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
alter table "dev"."main_staging"."stg_ports" rename to "stg_ports__dbt_backup"
[0m12:39:01.880957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.889013 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.889843 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
alter table "dev"."main_staging"."stg_ports__dbt_tmp" rename to "stg_ports"
[0m12:39:01.891532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.934033 [debug] [Thread-1 (]: On model.xeneta.stg_ports: COMMIT
[0m12:39:01.934812 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.935606 [debug] [Thread-1 (]: On model.xeneta.stg_ports: COMMIT
[0m12:39:01.939964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.949518 [debug] [Thread-1 (]: Using duckdb connection "model.xeneta.stg_ports"
[0m12:39:01.950321 [debug] [Thread-1 (]: On model.xeneta.stg_ports: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_ports"} */
drop table if exists "dev"."main_staging"."stg_ports__dbt_backup" cascade
[0m12:39:01.951924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:39:01.957040 [debug] [Thread-1 (]: Timing info for model.xeneta.stg_ports (execute): 12:39:01.561411 => 12:39:01.956628
[0m12:39:01.957827 [debug] [Thread-1 (]: On model.xeneta.stg_ports: Close
[0m12:39:01.969565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eac9223-3358-47c9-822e-039ab712f319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2efb0>]}
[0m12:39:01.971887 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_staging.stg_ports ....................... [[32mOK[0m in 0.44s]
[0m12:39:01.973949 [debug] [Thread-1 (]: Finished running node model.xeneta.stg_ports
[0m12:39:01.976267 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:01.976914 [debug] [MainThread]: On master: BEGIN
[0m12:39:01.977691 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:01.989366 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:01.990140 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.990773 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:01.991512 [debug] [MainThread]: On master: COMMIT
[0m12:39:01.992440 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:01.994966 [debug] [MainThread]: On master: Close
[0m12:39:01.999588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:02.000443 [debug] [MainThread]: Connection 'model.xeneta.stg_ports' was properly closed.
[0m12:39:02.001429 [info ] [MainThread]: 
[0m12:39:02.002450 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m12:39:02.010284 [debug] [MainThread]: Command end result
[0m12:39:02.030930 [info ] [MainThread]: 
[0m12:39:02.032854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:02.034267 [info ] [MainThread]: 
[0m12:39:02.035665 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:02.044450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5313731, "process_user_time": 5.456065, "process_kernel_time": 0.727445, "process_mem_max_rss": "127623168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:02.045798 [debug] [MainThread]: Command `cli run` succeeded at 12:39:02.045528 after 1.53 seconds
[0m12:39:02.046584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2efb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e03670>]}
[0m12:39:02.047327 [debug] [MainThread]: Flushing usage events
[0m12:39:02.592821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a19690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eedf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a59ed0>]}


============================== 12:39:02.594251 | bf84d79f-1383-45ea-9e80-d883346c3eaf ==============================
[0m12:39:02.594251 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:39:02.596361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:39:02.707612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf84d79f-1383-45ea-9e80-d883346c3eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aba890>]}
[0m12:39:02.710765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf84d79f-1383-45ea-9e80-d883346c3eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a597e0>]}
[0m12:39:02.711775 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:39:02.728398 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:39:02.810281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:02.811165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:02.897335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf84d79f-1383-45ea-9e80-d883346c3eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e69b40>]}
[0m12:39:02.916454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf84d79f-1383-45ea-9e80-d883346c3eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3cee0>]}
[0m12:39:02.917459 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:39:02.918322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf84d79f-1383-45ea-9e80-d883346c3eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3e860>]}
[0m12:39:02.920003 [info ] [MainThread]: 
[0m12:39:02.921732 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:39:02.923570 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:39:02.929918 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:39:02.931469 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:39:02.933827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:02.951218 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:02.954611 [debug] [ThreadPool]: On list_dev: Close
[0m12:39:02.960435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m12:39:02.961980 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m12:39:02.965889 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:02.966745 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:39:02.967773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:02.979020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:02.981281 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:02.981893 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m12:39:02.982618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:02.983180 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:02.983745 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m12:39:02.984499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:02.985877 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:02.986724 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:02.987321 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:02.988206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:02.988821 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m12:39:02.994559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m12:39:02.998433 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:02.999101 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:39:02.999660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:03.008375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:03.009067 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:03.009654 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:39:03.045575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:03.052758 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:39:03.053572 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:39:03.053976 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:39:03.057505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:39:03.061777 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:03.062457 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:39:03.062948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:03.074275 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:03.074918 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:03.075452 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:39:03.115761 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:03.125228 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:39:03.125945 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:39:03.126464 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:39:03.130181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf84d79f-1383-45ea-9e80-d883346c3eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8d300>]}
[0m12:39:03.130903 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:03.131408 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.131878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:03.140699 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:03.141513 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.142262 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:03.142828 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.143542 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:03.144094 [debug] [MainThread]: On master: Close
[0m12:39:03.146551 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:03.147340 [info ] [MainThread]: 
[0m12:39:03.148895 [debug] [Thread-5 (]: Began running node model.xeneta.stg_regions
[0m12:39:03.149672 [info ] [Thread-5 (]: 1 of 1 START sql table model main_staging.stg_regions .......................... [RUN]
[0m12:39:03.150744 [debug] [Thread-5 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_regions)
[0m12:39:03.151372 [debug] [Thread-5 (]: Began compiling node model.xeneta.stg_regions
[0m12:39:03.158921 [debug] [Thread-5 (]: Writing injected SQL for node "model.xeneta.stg_regions"
[0m12:39:03.160343 [debug] [Thread-5 (]: Timing info for model.xeneta.stg_regions (compile): 12:39:03.151758 => 12:39:03.159918
[0m12:39:03.161021 [debug] [Thread-5 (]: Began executing node model.xeneta.stg_regions
[0m12:39:03.167098 [debug] [Thread-5 (]: Writing runtime sql for node "model.xeneta.stg_regions"
[0m12:39:03.168241 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m12:39:03.168894 [debug] [Thread-5 (]: On model.xeneta.stg_regions: BEGIN
[0m12:39:03.169480 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:39:03.182593 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m12:39:03.183403 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m12:39:03.184096 [debug] [Thread-5 (]: On model.xeneta.stg_regions: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_regions"} */

  
    
    

    create  table
      "dev"."main_staging"."stg_regions__dbt_tmp"
  
    as (
      

with stg_regions as (

    select
        
        Cast(Slug as varchar(80) ) as Slug,
        Cast(Name as varchar(80) ) as Name,
        Cast(Parent as varchar(80) ) as Parent,
        
    from raw.regions
    
)

select *
from stg_regions
    );
  
  
[0m12:39:03.185802 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m12:39:03.194488 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m12:39:03.195552 [debug] [Thread-5 (]: On model.xeneta.stg_regions: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_regions"} */
alter table "dev"."main_staging"."stg_regions" rename to "stg_regions__dbt_backup"
[0m12:39:03.196897 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m12:39:03.202458 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m12:39:03.203240 [debug] [Thread-5 (]: On model.xeneta.stg_regions: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_regions"} */
alter table "dev"."main_staging"."stg_regions__dbt_tmp" rename to "stg_regions"
[0m12:39:03.204622 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m12:39:03.210951 [debug] [Thread-5 (]: On model.xeneta.stg_regions: COMMIT
[0m12:39:03.212077 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m12:39:03.212945 [debug] [Thread-5 (]: On model.xeneta.stg_regions: COMMIT
[0m12:39:03.214916 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m12:39:03.220486 [debug] [Thread-5 (]: Using duckdb connection "model.xeneta.stg_regions"
[0m12:39:03.221559 [debug] [Thread-5 (]: On model.xeneta.stg_regions: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_regions"} */
drop table if exists "dev"."main_staging"."stg_regions__dbt_backup" cascade
[0m12:39:03.223061 [debug] [Thread-5 (]: SQL status: OK in 0.0 seconds
[0m12:39:03.226611 [debug] [Thread-5 (]: Timing info for model.xeneta.stg_regions (execute): 12:39:03.161435 => 12:39:03.226127
[0m12:39:03.227426 [debug] [Thread-5 (]: On model.xeneta.stg_regions: Close
[0m12:39:03.237115 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf84d79f-1383-45ea-9e80-d883346c3eaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f3f0a0>]}
[0m12:39:03.238713 [info ] [Thread-5 (]: 1 of 1 OK created sql table model main_staging.stg_regions ..................... [[32mOK[0m in 0.09s]
[0m12:39:03.240179 [debug] [Thread-5 (]: Finished running node model.xeneta.stg_regions
[0m12:39:03.243122 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:03.243889 [debug] [MainThread]: On master: BEGIN
[0m12:39:03.244474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:03.255309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:03.256068 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.256858 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:03.257495 [debug] [MainThread]: On master: COMMIT
[0m12:39:03.259624 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:03.260556 [debug] [MainThread]: On master: Close
[0m12:39:03.264807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:03.265717 [debug] [MainThread]: Connection 'model.xeneta.stg_regions' was properly closed.
[0m12:39:03.266425 [info ] [MainThread]: 
[0m12:39:03.267225 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m12:39:03.268490 [debug] [MainThread]: Command end result
[0m12:39:03.298122 [info ] [MainThread]: 
[0m12:39:03.300357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:03.302098 [info ] [MainThread]: 
[0m12:39:03.313270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:03.315025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.72832745, "process_user_time": 6.033326, "process_kernel_time": 0.820468, "process_mem_max_rss": "130998272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:03.316502 [debug] [MainThread]: Command `cli run` succeeded at 12:39:03.316214 after 0.73 seconds
[0m12:39:03.317370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a19690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7352a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eeb160>]}
[0m12:39:03.319060 [debug] [MainThread]: Flushing usage events
[0m12:39:03.799701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e69600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e68580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0efb0>]}


============================== 12:39:03.800745 | ec67e0f4-01a1-44a5-933e-d6fabc795826 ==============================
[0m12:39:03.800745 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:39:03.801740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:39:03.842366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec67e0f4-01a1-44a5-933e-d6fabc795826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a59d80>]}
[0m12:39:03.845268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec67e0f4-01a1-44a5-933e-d6fabc795826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0c8b0>]}
[0m12:39:03.846508 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:39:03.862660 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:39:03.930981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:03.931621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:03.940715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec67e0f4-01a1-44a5-933e-d6fabc795826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7380d0>]}
[0m12:39:03.958008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec67e0f4-01a1-44a5-933e-d6fabc795826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db9e10>]}
[0m12:39:03.958855 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:39:03.959558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec67e0f4-01a1-44a5-933e-d6fabc795826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db9c90>]}
[0m12:39:03.960864 [info ] [MainThread]: 
[0m12:39:03.962307 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:39:03.963829 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:39:03.968603 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:39:03.969469 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:39:03.973622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:03.985631 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:03.991114 [debug] [ThreadPool]: On list_dev: Close
[0m12:39:03.995574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m12:39:03.997243 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m12:39:04.001388 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:04.002140 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:39:04.002738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:04.013915 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.016387 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:04.017364 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m12:39:04.018174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.018750 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:04.019317 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m12:39:04.020205 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.021907 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:04.022523 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:04.023083 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:04.024021 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.024742 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m12:39:04.029689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m12:39:04.033620 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:04.034298 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:39:04.034854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:04.043870 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.044567 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:04.045151 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:39:04.084089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.091515 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:39:04.092294 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:39:04.092738 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:39:04.096623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:39:04.100544 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:04.101078 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:39:04.101539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:04.109199 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.109852 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:04.110355 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:39:04.142784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:04.149705 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:39:04.150281 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:39:04.150667 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:39:04.154328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec67e0f4-01a1-44a5-933e-d6fabc795826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da9180>]}
[0m12:39:04.154995 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:04.155452 [debug] [MainThread]: On master: BEGIN
[0m12:39:04.155866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:04.163319 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:04.163957 [debug] [MainThread]: On master: COMMIT
[0m12:39:04.164457 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:04.164911 [debug] [MainThread]: On master: COMMIT
[0m12:39:04.165476 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:04.165956 [debug] [MainThread]: On master: Close
[0m12:39:04.168339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:04.168981 [info ] [MainThread]: 
[0m12:39:04.171457 [debug] [Thread-9 (]: Began running node model.xeneta.stg_exchange_rate
[0m12:39:04.172290 [info ] [Thread-9 (]: 1 of 1 START sql table model main_staging.stg_exchange_rate .................... [RUN]
[0m12:39:04.173370 [debug] [Thread-9 (]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_exchange_rate)
[0m12:39:04.173992 [debug] [Thread-9 (]: Began compiling node model.xeneta.stg_exchange_rate
[0m12:39:04.181735 [debug] [Thread-9 (]: Writing injected SQL for node "model.xeneta.stg_exchange_rate"
[0m12:39:04.183733 [debug] [Thread-9 (]: Timing info for model.xeneta.stg_exchange_rate (compile): 12:39:04.174407 => 12:39:04.183000
[0m12:39:04.184982 [debug] [Thread-9 (]: Began executing node model.xeneta.stg_exchange_rate
[0m12:39:04.195316 [debug] [Thread-9 (]: Writing runtime sql for node "model.xeneta.stg_exchange_rate"
[0m12:39:04.196711 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m12:39:04.198269 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: BEGIN
[0m12:39:04.199045 [debug] [Thread-9 (]: Opening a new connection, currently in state closed
[0m12:39:04.210250 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m12:39:04.211042 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m12:39:04.211750 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_exchange_rate"} */

  
    
    

    create  table
      "dev"."main_staging"."stg_exchange_rate__dbt_tmp"
  
    as (
      

with stg_exchange_rate as (

    select
        Cast(Day as DATE ) as Day,
        Cast(Currency as Char(3) ) as Currency,
        Cast(Rate as decimal(18,10) ) as Rate,
        -- ROW_NUMBER() OVER (PARTITION BY PID ORDER BY PID) AS row_num
    from raw.exchange_rate
    
)

select *
from stg_exchange_rate
    );
  
  
[0m12:39:04.245227 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m12:39:04.249610 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m12:39:04.250253 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_exchange_rate"} */
alter table "dev"."main_staging"."stg_exchange_rate" rename to "stg_exchange_rate__dbt_backup"
[0m12:39:04.251178 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m12:39:04.255611 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m12:39:04.256246 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_exchange_rate"} */
alter table "dev"."main_staging"."stg_exchange_rate__dbt_tmp" rename to "stg_exchange_rate"
[0m12:39:04.257132 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m12:39:04.260189 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: COMMIT
[0m12:39:04.261155 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m12:39:04.261765 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: COMMIT
[0m12:39:04.274398 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m12:39:04.278900 [debug] [Thread-9 (]: Using duckdb connection "model.xeneta.stg_exchange_rate"
[0m12:39:04.279758 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_exchange_rate"} */
drop table if exists "dev"."main_staging"."stg_exchange_rate__dbt_backup" cascade
[0m12:39:04.281474 [debug] [Thread-9 (]: SQL status: OK in 0.0 seconds
[0m12:39:04.283990 [debug] [Thread-9 (]: Timing info for model.xeneta.stg_exchange_rate (execute): 12:39:04.186159 => 12:39:04.283548
[0m12:39:04.285852 [debug] [Thread-9 (]: On model.xeneta.stg_exchange_rate: Close
[0m12:39:04.317272 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec67e0f4-01a1-44a5-933e-d6fabc795826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d96380>]}
[0m12:39:04.318472 [info ] [Thread-9 (]: 1 of 1 OK created sql table model main_staging.stg_exchange_rate ............... [[32mOK[0m in 0.14s]
[0m12:39:04.319736 [debug] [Thread-9 (]: Finished running node model.xeneta.stg_exchange_rate
[0m12:39:04.321986 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:04.322653 [debug] [MainThread]: On master: BEGIN
[0m12:39:04.323213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:04.335093 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:04.337007 [debug] [MainThread]: On master: COMMIT
[0m12:39:04.338250 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:04.341907 [debug] [MainThread]: On master: COMMIT
[0m12:39:04.342932 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:04.343590 [debug] [MainThread]: On master: Close
[0m12:39:04.346341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:04.346973 [debug] [MainThread]: Connection 'model.xeneta.stg_exchange_rate' was properly closed.
[0m12:39:04.347607 [info ] [MainThread]: 
[0m12:39:04.348546 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m12:39:04.349976 [debug] [MainThread]: Command end result
[0m12:39:04.371778 [info ] [MainThread]: 
[0m12:39:04.378835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:04.381654 [info ] [MainThread]: 
[0m12:39:04.382869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:04.384453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5880044, "process_user_time": 6.531578, "process_kernel_time": 0.889392, "process_mem_max_rss": "136916992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:04.385542 [debug] [MainThread]: Command `cli run` succeeded at 12:39:04.385288 after 0.59 seconds
[0m12:39:04.386507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e69600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a19d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73f760>]}
[0m12:39:04.387712 [debug] [MainThread]: Flushing usage events
[0m12:39:04.870442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c340a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db91e0>]}


============================== 12:39:04.871394 | e0995f1e-c728-4c66-bad1-5104399ea3f3 ==============================
[0m12:39:04.871394 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:39:04.872482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:39:04.908459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0995f1e-c728-4c66-bad1-5104399ea3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7352a0>]}
[0m12:39:04.911262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0995f1e-c728-4c66-bad1-5104399ea3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db9e10>]}
[0m12:39:04.912477 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:39:04.924344 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:39:04.986926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:04.987637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:04.997073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0995f1e-c728-4c66-bad1-5104399ea3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c870370>]}
[0m12:39:05.010207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0995f1e-c728-4c66-bad1-5104399ea3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84f430>]}
[0m12:39:05.010986 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:39:05.012205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0995f1e-c728-4c66-bad1-5104399ea3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84f2b0>]}
[0m12:39:05.013810 [info ] [MainThread]: 
[0m12:39:05.015077 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:39:05.016525 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:39:05.024068 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:39:05.026501 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:39:05.027936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:05.041918 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.044203 [debug] [ThreadPool]: On list_dev: Close
[0m12:39:05.049652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m12:39:05.051098 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m12:39:05.056947 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:05.057711 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:39:05.058307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:05.068938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.072515 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:05.073182 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m12:39:05.073951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.074520 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:05.075093 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m12:39:05.075858 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.077275 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:05.077858 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:05.078411 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:05.079168 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.079901 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m12:39:05.085100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m12:39:05.089019 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:05.089699 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:39:05.090253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:05.099519 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.100567 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:05.101173 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:39:05.138694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.148157 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:39:05.148944 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:39:05.149464 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:39:05.153965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:39:05.158518 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:05.159201 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:39:05.159714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:05.169120 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.169817 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:05.170453 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:39:05.208384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:05.215415 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:39:05.216023 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:39:05.216459 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:39:05.220289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0995f1e-c728-4c66-bad1-5104399ea3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c871d20>]}
[0m12:39:05.221525 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:05.222523 [debug] [MainThread]: On master: BEGIN
[0m12:39:05.223036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:05.230579 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:05.231204 [debug] [MainThread]: On master: COMMIT
[0m12:39:05.231695 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:05.232209 [debug] [MainThread]: On master: COMMIT
[0m12:39:05.232790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:05.233279 [debug] [MainThread]: On master: Close
[0m12:39:05.235564 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:05.236185 [info ] [MainThread]: 
[0m12:39:05.237863 [debug] [Thread-13 ]: Began running node model.xeneta.stg_datapoints
[0m12:39:05.238736 [info ] [Thread-13 ]: 1 of 1 START sql incremental model main_staging.stg_datapoints ................. [RUN]
[0m12:39:05.240200 [debug] [Thread-13 ]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_datapoints)
[0m12:39:05.240879 [debug] [Thread-13 ]: Began compiling node model.xeneta.stg_datapoints
[0m12:39:05.249198 [debug] [Thread-13 ]: Writing injected SQL for node "model.xeneta.stg_datapoints"
[0m12:39:05.251122 [debug] [Thread-13 ]: Timing info for model.xeneta.stg_datapoints (compile): 12:39:05.241268 => 12:39:05.250442
[0m12:39:05.252986 [debug] [Thread-13 ]: Began executing node model.xeneta.stg_datapoints
[0m12:39:05.328168 [debug] [Thread-13 ]: Writing runtime sql for node "model.xeneta.stg_datapoints"
[0m12:39:05.329457 [debug] [Thread-13 ]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:39:05.330111 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: BEGIN
[0m12:39:05.330699 [debug] [Thread-13 ]: Opening a new connection, currently in state closed
[0m12:39:05.339004 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
[0m12:39:05.339938 [debug] [Thread-13 ]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:39:05.340641 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_datapoints"} */

  
    
    

    create  table
      "dev"."main_staging"."stg_datapoints"
  
    as (
      

with stg_datapoints as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Created as timestamp ) as Created,
        Cast(Origin_PID as integer ) as Origin_PID,
        Cast(Destination_PID as integer )as Destination_PID,
        Cast(Valid_From as date ) as Valid_From,
        Cast(Valid_To as date ) as Valid_To,
        Cast(Company_ID as integer ) as Company_ID,
        Cast(Supplier_ID as integer ) as Supplier_ID,
        Cast(Equipment_ID as integer ) as Equipment_ID,
        row_number() over (partition by d_id order by created )as row_num
    from raw.datapoints

    
)

select *
from stg_datapoints
where row_num = 1
    );
  
  
  
[0m12:39:05.371606 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
[0m12:39:05.374071 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: COMMIT
[0m12:39:05.374652 [debug] [Thread-13 ]: Using duckdb connection "model.xeneta.stg_datapoints"
[0m12:39:05.375275 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: COMMIT
[0m12:39:05.383916 [debug] [Thread-13 ]: SQL status: OK in 0.0 seconds
[0m12:39:05.385505 [debug] [Thread-13 ]: Timing info for model.xeneta.stg_datapoints (execute): 12:39:05.253859 => 12:39:05.385150
[0m12:39:05.386154 [debug] [Thread-13 ]: On model.xeneta.stg_datapoints: Close
[0m12:39:05.401128 [debug] [Thread-13 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0995f1e-c728-4c66-bad1-5104399ea3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c891ab0>]}
[0m12:39:05.402186 [info ] [Thread-13 ]: 1 of 1 OK created sql incremental model main_staging.stg_datapoints ............ [[32mOK[0m in 0.16s]
[0m12:39:05.403491 [debug] [Thread-13 ]: Finished running node model.xeneta.stg_datapoints
[0m12:39:05.405549 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:05.406185 [debug] [MainThread]: On master: BEGIN
[0m12:39:05.406701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:05.423782 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:05.425054 [debug] [MainThread]: On master: COMMIT
[0m12:39:05.425759 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:05.426635 [debug] [MainThread]: On master: COMMIT
[0m12:39:05.428507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:05.429424 [debug] [MainThread]: On master: Close
[0m12:39:05.433020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:05.433770 [debug] [MainThread]: Connection 'model.xeneta.stg_datapoints' was properly closed.
[0m12:39:05.434465 [info ] [MainThread]: 
[0m12:39:05.435435 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m12:39:05.438535 [debug] [MainThread]: Command end result
[0m12:39:05.454071 [info ] [MainThread]: 
[0m12:39:05.455329 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:05.456354 [info ] [MainThread]: 
[0m12:39:05.457288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:05.459182 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5919808, "process_user_time": 7.107994, "process_kernel_time": 0.965826, "process_mem_max_rss": "147333120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:05.463716 [debug] [MainThread]: Command `cli run` succeeded at 12:39:05.463199 after 0.60 seconds
[0m12:39:05.464701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c889000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db9e10>]}
[0m12:39:05.466000 [debug] [MainThread]: Flushing usage events
[0m12:39:06.070766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c34370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eee530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db9960>]}


============================== 12:39:06.076104 | 50575a86-fd3e-465c-8f8f-d3ae38d8a341 ==============================
[0m12:39:06.076104 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:39:06.078451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:39:06.149169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50575a86-fd3e-465c-8f8f-d3ae38d8a341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c8e80>]}
[0m12:39:06.151862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50575a86-fd3e-465c-8f8f-d3ae38d8a341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c37dc0>]}
[0m12:39:06.152814 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:39:06.169558 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:39:06.239317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:06.239971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:06.248929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50575a86-fd3e-465c-8f8f-d3ae38d8a341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a40d0>]}
[0m12:39:06.268034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50575a86-fd3e-465c-8f8f-d3ae38d8a341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c986170>]}
[0m12:39:06.268940 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:39:06.269895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50575a86-fd3e-465c-8f8f-d3ae38d8a341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c985ff0>]}
[0m12:39:06.271433 [info ] [MainThread]: 
[0m12:39:06.272819 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:39:06.276166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:39:06.283801 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:39:06.284878 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:39:06.285780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:06.300788 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.303437 [debug] [ThreadPool]: On list_dev: Close
[0m12:39:06.308720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_staging)
[0m12:39:06.310448 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_staging"
"
[0m12:39:06.315228 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:06.315995 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:39:06.316590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:06.326960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.329269 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:06.329885 [debug] [ThreadPool]: On create_dev_main_staging: BEGIN
[0m12:39:06.330615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.331172 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:06.331728 [debug] [ThreadPool]: On create_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_staging"} */

    
    
        create schema if not exists "dev"."main_staging"
    
[0m12:39:06.332470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.333847 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:06.334425 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_staging"
[0m12:39:06.335007 [debug] [ThreadPool]: On create_dev_main_staging: COMMIT
[0m12:39:06.335771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.336355 [debug] [ThreadPool]: On create_dev_main_staging: Close
[0m12:39:06.341436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_staging, now list_dev_main_staging)
[0m12:39:06.345291 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:06.345934 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:39:06.346481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:06.355681 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.356351 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:06.356907 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:39:06.391466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.398482 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:39:06.399070 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:39:06.399475 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:39:06.402938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:39:06.407404 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:06.407967 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:39:06.408419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:06.415978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.416598 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:06.417085 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:39:06.449050 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:06.456455 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:39:06.457066 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:39:06.457451 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:39:06.461037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50575a86-fd3e-465c-8f8f-d3ae38d8a341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c99cc70>]}
[0m12:39:06.461719 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:06.462158 [debug] [MainThread]: On master: BEGIN
[0m12:39:06.462587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:06.470009 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:06.470636 [debug] [MainThread]: On master: COMMIT
[0m12:39:06.471096 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:06.471549 [debug] [MainThread]: On master: COMMIT
[0m12:39:06.472108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:06.472583 [debug] [MainThread]: On master: Close
[0m12:39:06.475046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:06.475663 [info ] [MainThread]: 
[0m12:39:06.477199 [debug] [Thread-17 ]: Began running node model.xeneta.stg_charges
[0m12:39:06.477948 [info ] [Thread-17 ]: 1 of 1 START sql incremental model main_staging.stg_charges .................... [RUN]
[0m12:39:06.479108 [debug] [Thread-17 ]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.stg_charges)
[0m12:39:06.483585 [debug] [Thread-17 ]: Began compiling node model.xeneta.stg_charges
[0m12:39:06.494480 [debug] [Thread-17 ]: Writing injected SQL for node "model.xeneta.stg_charges"
[0m12:39:06.498113 [debug] [Thread-17 ]: Timing info for model.xeneta.stg_charges (compile): 12:39:06.484430 => 12:39:06.497407
[0m12:39:06.498887 [debug] [Thread-17 ]: Began executing node model.xeneta.stg_charges
[0m12:39:06.509553 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m12:39:06.510365 [debug] [Thread-17 ]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */
DESCRIBE (select * from (
        

with stg_charges as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Currency as char(3) ) as Currency,
        Cast(Charge_Value as integer ) as Charge_Value,
        row_number() over (partition by d_id, currency order by Charge_Value )as row_num
    from raw.charges
    
    
)

select *
from stg_charges
where row_num = 1
    ) as __dbt_sbq
    where false
    limit 0
)
[0m12:39:06.511037 [debug] [Thread-17 ]: Opening a new connection, currently in state closed
[0m12:39:06.522872 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m12:39:06.525216 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m12:39:06.526041 [debug] [Thread-17 ]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */
DESCRIBE (select * from (
        select
    
      cast(null as integer) as D_ID, 
      cast(null as char(3)) as Currency, 
      cast(null as integer) as Charge_Value, 
      cast(null as BIGINT) as row_num
    ) as __dbt_sbq
    where false
    limit 0
)
[0m12:39:06.527328 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m12:39:06.533185 [debug] [Thread-17 ]: Writing runtime sql for node "model.xeneta.stg_charges"
[0m12:39:06.535245 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m12:39:06.536276 [debug] [Thread-17 ]: On model.xeneta.stg_charges: BEGIN
[0m12:39:06.537617 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m12:39:06.538362 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m12:39:06.539106 [debug] [Thread-17 ]: On model.xeneta.stg_charges: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.stg_charges"} */

  
    
    
      
    

    create  table
      "dev"."main_staging"."stg_charges"
  
  (
    D_ID integer not null,
    Currency char(3),
    Charge_Value integer,
    row_num BIGINT
    
    )
 ;
    insert into "dev"."main_staging"."stg_charges" 
  (
    
      
      D_ID ,
    
      
      Currency ,
    
      
      Charge_Value ,
    
      
      row_num 
    
  )
 (
      
    select D_ID, Currency, Charge_Value, row_num
    from (
        

with stg_charges as (

    select
        Cast(D_ID as integer ) as D_ID,
        Cast(Currency as char(3) ) as Currency,
        Cast(Charge_Value as integer ) as Charge_Value,
        row_number() over (partition by d_id, currency order by Charge_Value )as row_num
    from raw.charges
    
    
)

select *
from stg_charges
where row_num = 1
    ) as model_subq
    );
  
  
  
[0m12:39:06.595939 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m12:39:06.598470 [debug] [Thread-17 ]: On model.xeneta.stg_charges: COMMIT
[0m12:39:06.599161 [debug] [Thread-17 ]: Using duckdb connection "model.xeneta.stg_charges"
[0m12:39:06.599707 [debug] [Thread-17 ]: On model.xeneta.stg_charges: COMMIT
[0m12:39:06.605700 [debug] [Thread-17 ]: SQL status: OK in 0.0 seconds
[0m12:39:06.607367 [debug] [Thread-17 ]: Timing info for model.xeneta.stg_charges (execute): 12:39:06.499320 => 12:39:06.606944
[0m12:39:06.608070 [debug] [Thread-17 ]: On model.xeneta.stg_charges: Close
[0m12:39:06.623242 [debug] [Thread-17 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50575a86-fd3e-465c-8f8f-d3ae38d8a341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9b7670>]}
[0m12:39:06.624314 [info ] [Thread-17 ]: 1 of 1 OK created sql incremental model main_staging.stg_charges ............... [[32mOK[0m in 0.14s]
[0m12:39:06.625324 [debug] [Thread-17 ]: Finished running node model.xeneta.stg_charges
[0m12:39:06.627336 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:06.627948 [debug] [MainThread]: On master: BEGIN
[0m12:39:06.628462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:06.642563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:06.643752 [debug] [MainThread]: On master: COMMIT
[0m12:39:06.644520 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:06.645776 [debug] [MainThread]: On master: COMMIT
[0m12:39:06.646658 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:06.647308 [debug] [MainThread]: On master: Close
[0m12:39:06.650154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:06.650947 [debug] [MainThread]: Connection 'model.xeneta.stg_charges' was properly closed.
[0m12:39:06.651759 [info ] [MainThread]: 
[0m12:39:06.657122 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m12:39:06.660263 [debug] [MainThread]: Command end result
[0m12:39:06.692141 [info ] [MainThread]: 
[0m12:39:06.695615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:06.697122 [info ] [MainThread]: 
[0m12:39:06.698276 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:06.700102 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6334471, "process_user_time": 7.710345, "process_kernel_time": 1.053994, "process_mem_max_rss": "162316288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:06.701304 [debug] [MainThread]: Command `cli run` succeeded at 12:39:06.701012 after 0.63 seconds
[0m12:39:06.702170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eee530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9c8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ca2f0>]}
[0m12:39:06.702955 [debug] [MainThread]: Flushing usage events
[0m12:39:07.188198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c86ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c86ecb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c86e5f0>]}


============================== 12:39:07.191436 | 050eb306-c385-4079-a2ea-2c1039ec4989 ==============================
[0m12:39:07.191436 [info ] [MainThread]: Running with dbt=1.7.17
[0m12:39:07.195531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/haidersultan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/haidersultan/xeneta/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m12:39:07.231062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '050eb306-c385-4079-a2ea-2c1039ec4989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c86f9d0>]}
[0m12:39:07.233614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '050eb306-c385-4079-a2ea-2c1039ec4989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c86fb50>]}
[0m12:39:07.234466 [info ] [MainThread]: Registered adapter: duckdb=1.7.4
[0m12:39:07.249561 [debug] [MainThread]: checksum: df69a17a5cb23fb99a7422df02bc7a63a38fc52c957542963e77e6cc79b17fab, vars: {}, profile: , target: , version: 1.7.17
[0m12:39:07.399186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:07.399865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:07.408627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '050eb306-c385-4079-a2ea-2c1039ec4989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e87d00>]}
[0m12:39:07.422419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '050eb306-c385-4079-a2ea-2c1039ec4989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84dc60>]}
[0m12:39:07.423260 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 396 macros, 0 groups, 0 semantic models
[0m12:39:07.423958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050eb306-c385-4079-a2ea-2c1039ec4989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84d720>]}
[0m12:39:07.425301 [info ] [MainThread]: 
[0m12:39:07.426572 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:39:07.428150 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:39:07.433399 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:39:07.434235 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:39:07.434816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:07.449682 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.451945 [debug] [ThreadPool]: On list_dev: Close
[0m12:39:07.457428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main_final)
[0m12:39:07.458628 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main_final"
"
[0m12:39:07.462882 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:39:07.463821 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:39:07.464550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:07.475644 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.477819 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:39:07.478528 [debug] [ThreadPool]: On create_dev_main_final: BEGIN
[0m12:39:07.479539 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.480445 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:39:07.481108 [debug] [ThreadPool]: On create_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "create_dev_main_final"} */

    
    
        create schema if not exists "dev"."main_final"
    
[0m12:39:07.482778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.484454 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:39:07.485359 [debug] [ThreadPool]: Using duckdb connection "create_dev_main_final"
[0m12:39:07.485944 [debug] [ThreadPool]: On create_dev_main_final: COMMIT
[0m12:39:07.486961 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.487717 [debug] [ThreadPool]: On create_dev_main_final: Close
[0m12:39:07.492517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main_final, now list_dev_main_staging)
[0m12:39:07.497074 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:07.497758 [debug] [ThreadPool]: On list_dev_main_staging: BEGIN
[0m12:39:07.498427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:07.507899 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.508571 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_staging"
[0m12:39:07.509130 [debug] [ThreadPool]: On list_dev_main_staging: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_staging"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_staging'
    and table_catalog = 'dev'
  
[0m12:39:07.544603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.551645 [debug] [ThreadPool]: On list_dev_main_staging: ROLLBACK
[0m12:39:07.552258 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_staging'
[0m12:39:07.552661 [debug] [ThreadPool]: On list_dev_main_staging: Close
[0m12:39:07.556488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_main_staging, now list_dev_main_final)
[0m12:39:07.560770 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:07.561290 [debug] [ThreadPool]: On list_dev_main_final: BEGIN
[0m12:39:07.561727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:07.568987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.569587 [debug] [ThreadPool]: Using duckdb connection "list_dev_main_final"
[0m12:39:07.570187 [debug] [ThreadPool]: On list_dev_main_final: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "connection_name": "list_dev_main_final"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_final'
    and table_catalog = 'dev'
  
[0m12:39:07.601094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:39:07.608189 [debug] [ThreadPool]: On list_dev_main_final: ROLLBACK
[0m12:39:07.608798 [debug] [ThreadPool]: Failed to rollback 'list_dev_main_final'
[0m12:39:07.609181 [debug] [ThreadPool]: On list_dev_main_final: Close
[0m12:39:07.612758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '050eb306-c385-4079-a2ea-2c1039ec4989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a73ccd0>]}
[0m12:39:07.613410 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:07.613833 [debug] [MainThread]: On master: BEGIN
[0m12:39:07.614225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:07.621259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:07.621847 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.622290 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:07.622715 [debug] [MainThread]: On master: COMMIT
[0m12:39:07.623298 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:07.623729 [debug] [MainThread]: On master: Close
[0m12:39:07.625998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:39:07.626697 [info ] [MainThread]: 
[0m12:39:07.628558 [debug] [Thread-21 ]: Began running node model.xeneta.aggregations
[0m12:39:07.629281 [info ] [Thread-21 ]: 1 of 1 START sql table model main_final.aggregations ........................... [RUN]
[0m12:39:07.630282 [debug] [Thread-21 ]: Re-using an available connection from the pool (formerly list_dev_main_final, now model.xeneta.aggregations)
[0m12:39:07.630862 [debug] [Thread-21 ]: Began compiling node model.xeneta.aggregations
[0m12:39:07.642284 [debug] [Thread-21 ]: Writing injected SQL for node "model.xeneta.aggregations"
[0m12:39:07.646279 [debug] [Thread-21 ]: Timing info for model.xeneta.aggregations (compile): 12:39:07.631208 => 12:39:07.645541
[0m12:39:07.647142 [debug] [Thread-21 ]: Began executing node model.xeneta.aggregations
[0m12:39:07.662297 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:07.663088 [debug] [Thread-21 ]: On model.xeneta.aggregations: BEGIN
[0m12:39:07.663722 [debug] [Thread-21 ]: Opening a new connection, currently in state closed
[0m12:39:07.675223 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m12:39:07.676034 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:07.676720 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        CREATE OR REPLACE table prior_count as
    ( SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count 
        from "dev"."main_final"."aggregations"             
        WHERE dq_ok ='True'
        group by 1,2,3,4,5
        order by count desc )
      
[0m12:39:07.685007 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m12:39:07.688023 [debug] [Thread-21 ]: Writing runtime sql for node "model.xeneta.aggregations"
[0m12:39:07.690565 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:07.691678 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

  
    
    

    create  table
      "dev"."main_final"."aggregations__dbt_tmp"
  
    as (
      


with datapoints as (
    select * from "dev"."main_staging"."stg_datapoints"
),
charges as (
    select * from "dev"."main_staging"."stg_charges"
),
exchange_rates as (
    select * from "dev"."main_staging"."stg_exchange_rate"
),

datapoint_charges as (
    select 
        dp.d_id,
        dp.valid_from,
        dp.valid_to,
        dp.equipment_id,
        dp.Origin_PID,
        dp.Destination_PID,
        dp.company_id,
        dp.supplier_id,
        c.currency,
        c.Charge_Value,
        er.rate,
        (c.Charge_Value / er.rate) as usd_value
    from datapoints dp
    join charges c on dp.d_id = c.d_id
    join exchange_rates er on er.currency = c.currency
    where er.day = dp.valid_from
),

daily_prices as (
    select 
        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,
        dpc.equipment_id,
        dpc.Origin_PID,
        dpc.Destination_PID,
        sum(dpc.usd_value) as daily_price,
        dpc.company_id,
        dpc.supplier_id
    from datapoint_charges dpc
    join (select row_number() over() as seqnum from range(10000)) seq
    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)
    group by 1, 2, 3, 4, 6, 7
),

lane_prices as (
    select 
        day,
        equipment_id,
        Origin_PID,
        Destination_PID,
        avg(daily_price) as avg_daily_price,
        median(daily_price) as median_daily_price,
        count(distinct company_id) as company_count,
        count(distinct supplier_id) as supplier_count,
        case 
            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'
            else 'False'
        end as dq_ok
    from daily_prices
    group by 1, 2, 3, 4
)

select *
from lane_prices
    );
  
  
[0m12:39:08.870895 [debug] [Thread-21 ]: SQL status: OK in 1.0 seconds
[0m12:39:08.876904 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:08.877613 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations" rename to "aggregations__dbt_backup"
[0m12:39:08.878621 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m12:39:08.883385 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:08.884041 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
alter table "dev"."main_final"."aggregations__dbt_tmp" rename to "aggregations"
[0m12:39:08.885052 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m12:39:08.888361 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:08.889083 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */

        CREATE OR REPLACE table post_count as (SELECT day, Equipment_ID, Origin_PID,Destination_PID,dq_ok, count(*) as count from "dev"."main_final"."aggregations" WHERE dq_ok ='True' group by 1,2,3,4,5 order by count desc)
      
[0m12:39:08.916472 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m12:39:08.920039 [debug] [Thread-21 ]: On model.xeneta.aggregations: COMMIT
[0m12:39:08.921050 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:08.921981 [debug] [Thread-21 ]: On model.xeneta.aggregations: COMMIT
[0m12:39:09.040668 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m12:39:09.058387 [debug] [Thread-21 ]: Using duckdb connection "model.xeneta.aggregations"
[0m12:39:09.072262 [debug] [Thread-21 ]: On model.xeneta.aggregations: /* {"app": "dbt", "dbt_version": "1.7.17", "profile_name": "xeneta", "target_name": "dev", "node_id": "model.xeneta.aggregations"} */
drop table if exists "dev"."main_final"."aggregations__dbt_backup" cascade
[0m12:39:09.076125 [debug] [Thread-21 ]: SQL status: OK in 0.0 seconds
[0m12:39:09.079183 [debug] [Thread-21 ]: Timing info for model.xeneta.aggregations (execute): 12:39:07.648122 => 12:39:09.078819
[0m12:39:09.079859 [debug] [Thread-21 ]: On model.xeneta.aggregations: Close
[0m12:39:09.183613 [debug] [Thread-21 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '050eb306-c385-4079-a2ea-2c1039ec4989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c9810>]}
[0m12:39:09.184564 [info ] [Thread-21 ]: 1 of 1 OK created sql table model main_final.aggregations ...................... [[32mOK[0m in 1.55s]
[0m12:39:09.185775 [debug] [Thread-21 ]: Finished running node model.xeneta.aggregations
[0m12:39:09.187604 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:09.188149 [debug] [MainThread]: On master: BEGIN
[0m12:39:09.188619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:09.206826 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:09.208474 [debug] [MainThread]: On master: COMMIT
[0m12:39:09.209684 [debug] [MainThread]: Using duckdb connection "master"
[0m12:39:09.210798 [debug] [MainThread]: On master: COMMIT
[0m12:39:09.212491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:39:09.214010 [debug] [MainThread]: On master: Close
[0m12:39:09.218998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:09.220019 [debug] [MainThread]: Connection 'model.xeneta.aggregations' was properly closed.
[0m12:39:09.221390 [info ] [MainThread]: 
[0m12:39:09.224521 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m12:39:09.227508 [debug] [MainThread]: Command end result
[0m12:39:09.268147 [info ] [MainThread]: 
[0m12:39:09.270246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:09.273110 [info ] [MainThread]: 
[0m12:39:09.275541 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:39:09.276985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0958464, "process_user_time": 10.8357, "process_kernel_time": 1.561781, "process_mem_max_rss": "356098048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:39:09.278422 [debug] [MainThread]: Command `cli run` succeeded at 12:39:09.278077 after 2.10 seconds
[0m12:39:09.279397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5fe1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5fc970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5fe5c0>]}
[0m12:39:09.281411 [debug] [MainThread]: Flushing usage events
