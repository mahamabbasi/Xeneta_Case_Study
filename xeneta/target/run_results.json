{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.17", "generated_at": "2024-07-01T10:39:09.226047Z", "invocation_id": "050eb306-c385-4079-a2ea-2c1039ec4989", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-01T10:39:07.631208Z", "completed_at": "2024-07-01T10:39:07.645541Z"}, {"name": "execute", "started_at": "2024-07-01T10:39:07.648122Z", "completed_at": "2024-07-01T10:39:09.078819Z"}], "thread_id": "Thread-21 (worker)", "execution_time": 1.5536513328552246, "adapter_response": {"_message": "OK"}, "message": "OK", "failures": null, "unique_id": "model.xeneta.aggregations", "compiled": true, "compiled_code": "\n\n\nwith datapoints as (\n    select * from \"dev\".\"main_staging\".\"stg_datapoints\"\n),\ncharges as (\n    select * from \"dev\".\"main_staging\".\"stg_charges\"\n),\nexchange_rates as (\n    select * from \"dev\".\"main_staging\".\"stg_exchange_rate\"\n),\n\ndatapoint_charges as (\n    select \n        dp.d_id,\n        dp.valid_from,\n        dp.valid_to,\n        dp.equipment_id,\n        dp.Origin_PID,\n        dp.Destination_PID,\n        dp.company_id,\n        dp.supplier_id,\n        c.currency,\n        c.Charge_Value,\n        er.rate,\n        (c.Charge_Value / er.rate) as usd_value\n    from datapoints dp\n    join charges c on dp.d_id = c.d_id\n    join exchange_rates er on er.currency = c.currency\n    where er.day = dp.valid_from\n),\n\ndaily_prices as (\n    select \n        dpc.valid_from + (cast(seq.seqnum as integer) - 1) as day,\n        dpc.equipment_id,\n        dpc.Origin_PID,\n        dpc.Destination_PID,\n        sum(dpc.usd_value) as daily_price,\n        dpc.company_id,\n        dpc.supplier_id\n    from datapoint_charges dpc\n    join (select row_number() over() as seqnum from range(10000)) seq\n    on seq.seqnum <= (dpc.valid_to - dpc.valid_from)\n    group by 1, 2, 3, 4, 6, 7\n),\n\nlane_prices as (\n    select \n        day,\n        equipment_id,\n        Origin_PID,\n        Destination_PID,\n        avg(daily_price) as avg_daily_price,\n        median(daily_price) as median_daily_price,\n        count(distinct company_id) as company_count,\n        count(distinct supplier_id) as supplier_count,\n        case \n            when count(distinct company_id) >= 5 and count(distinct supplier_id) >= 2 then 'True'\n            else 'False'\n        end as dq_ok\n    from daily_prices\n    group by 1, 2, 3, 4\n)\n\nselect *\nfrom lane_prices", "relation_name": "\"dev\".\"main_final\".\"aggregations\""}], "elapsed_time": 1.7952442169189453, "args": {"defer": false, "use_colors_file": true, "use_colors": true, "quiet": false, "project_dir": "/Users/haidersultan/xeneta", "invocation_command": "dbt ", "log_file_max_bytes": 10485760, "populate_cache": true, "select": ["aggregations"], "exclude": [], "static_parser": true, "introspect": true, "partial_parse": true, "favor_state": false, "log_level_file": "debug", "print": true, "strict_mode": false, "show_resource_report": false, "log_path": "/Users/haidersultan/xeneta/logs", "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "partial_parse_file_diff": true, "log_format_file": "debug", "version_check": true, "enable_legacy_logger": false, "vars": {}, "log_format": "default", "cache_selected_only": false, "require_explicit_package_overrides_for_builtin_materializations": false, "write_json": true, "send_anonymous_usage_stats": true, "log_level": "info", "profiles_dir": "/Users/haidersultan/.dbt", "printer_width": 80, "which": "run"}}